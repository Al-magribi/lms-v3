import{a as e,am as a,an as s,j as l,d as n,ao as t,ap as i}from"./index-CNbAajcm.js";import{b as c,u as d}from"./vendor-BYWiIb5-.js";import{S as r}from"./react-select.esm-4h58l94a.js";import{T as o}from"./Table-BSwODE4h.js";const m=({detail:t,setDetail:i})=>{var d;const{user:o}=e((e=>e.auth)),[m,u]=c.useState({id:"",teacher:(null==o?void 0:o.id)||null,subject:null,btype:"",name:""}),{data:h}=a(),[b,{isSuccess:j,isLoading:x,isError:p,reset:g}]=s(),v=null==h?void 0:h.map((e=>({value:e.id,label:e.name,subjects:e.subjects}))),N=null==h?void 0:h.find((e=>e.id===m.teacher)),f=(null==(d=null==N?void 0:N.subjects)?void 0:d.map((e=>({value:e.id,label:e.name}))))||[],k=e=>{const{name:a,value:s}=e.target;u((e=>({...e,[a]:s})))};return c.useEffect((()=>{(j||p)&&(u({id:"",teacher:(null==o?void 0:o.id)||null,btype:"",subject:null,name:""}),g())}),[j,p,o]),c.useEffect((()=>{t&&u({id:t.id,teacher:t.teacher||(null==o?void 0:o.id)||null,subject:t.subject,name:t.name,btype:t.btype})}),[t,o]),l.jsxs("form",{onSubmit:e=>{e.preventDefault(),n.promise(b(m).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message})},className:"bg-white p-2 rounded d-flex flex-column gap-2 border",children:[l.jsx("p",{className:"m-0 h6",children:"Bank Soal"}),l.jsx(r,{isClearable:!0,isSearchable:!0,placeholder:"Cari Guru",value:(null==v?void 0:v.find((e=>e.value===m.teacher)))||null,options:v,onChange:e=>{u((a=>({...a,teacher:(null==e?void 0:e.value)||null,subject:null})))}}),l.jsx(r,{isClearable:!0,isSearchable:!0,placeholder:"Pilih Mata Pelajaran",value:(null==f?void 0:f.find((e=>e.value===m.subject)))||null,options:f,onChange:e=>{u((a=>({...a,subject:(null==e?void 0:e.value)||null})))},isDisabled:!m.teacher}),l.jsxs("select",{name:"btype",id:"btype",className:"form-select",value:m.btype,onChange:k,children:[l.jsx("option",{value:"",hidden:!0,children:"Jenis Bank Soal"}),l.jsx("option",{value:"bank",children:"Bank"}),l.jsx("option",{value:"paket",children:"Paket"})]}),l.jsx("input",{name:"name",className:"form-control",placeholder:"Nama Bank Soal",value:m.name,onChange:k}),l.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-sm btn-warning",onClick:()=>{i({}),u({id:"",teacher:(null==o?void 0:o.id)||null,subject:null,btype:"",name:""})},children:"Batal"}),l.jsx("button",{type:"submit",className:"btn btn-sm btn-success",children:"Simpan"})]})]})},u=({setDetail:e})=>{const a=d(),[s,r]=c.useState(1),[m,u]=c.useState(10),[h,b]=c.useState(""),{data:j={},isLoading:x}=t({page:s,limit:m,search:h}),{banks:p=[],totalData:g,totalPages:v}=j,[N,{isLoading:f}]=i();return l.jsx(o,{page:s,setPage:r,setLimit:u,setSearch:b,totalData:g,totalPages:v,isLoading:x,children:l.jsxs("table",{className:"table table-bordered table-striped table-hover m-0",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-center",children:"No"}),l.jsx("th",{className:"text-center",children:"Guru"}),l.jsx("th",{className:"text-center",children:"Mata Pelajaran"}),l.jsx("th",{className:"text-center",children:"Bank Soal"}),l.jsx("th",{className:"text-center",children:"Jenis"}),l.jsx("th",{className:"text-center",children:"Soal"}),l.jsx("th",{style:{width:250},className:"text-center",children:"Aksi"})]})}),l.jsx("tbody",{children:(null==p?void 0:p.length)>0?null==p?void 0:p.map(((t,i)=>l.jsxs("tr",{children:[l.jsx("td",{className:"text-center align-middle",children:(s-1)*m+i+1}),l.jsx("td",{className:"align-middle",children:t.teacher_name}),l.jsx("td",{className:"align-middle",children:t.subject_name}),l.jsx("td",{className:"align-middle",children:t.name}),l.jsx("td",{className:"text-center align-middle",children:l.jsx("p",{className:"m-0 badge bg-success",children:t.btype.toUpperCase()})}),l.jsx("td",{className:"text-center align-middle",children:l.jsx("p",{className:"m-0 badge bg-secondary",children:`${t.question_count} Soal`})}),l.jsx("td",{className:"text-center align-middle",children:l.jsxs("div",{className:"d-flex justify-content-center gap-1",children:[l.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>((e,s,l)=>{const n=s.replace(/[\s/]/g,"-"),t=e.replace(/[\s/]/g,"-");a(`/admin-cbt-bank/${t}/${n}/${l}`)})(t.subject_name,t.name,t.id),children:[l.jsx("i",{className:"bi bi-folder-fill"}),l.jsx("span",{className:"ms-2",children:"Lihat"})]}),l.jsxs("button",{className:"btn btn-sm btn-warning",onClick:()=>e(t),children:[l.jsx("i",{className:"bi bi-pencil-square"}),l.jsx("span",{className:"ms-2",children:"Edit "})]}),l.jsxs("button",{className:"btn btn-sm btn-danger",disabled:f,onClick:()=>{return e=t.id,void(window.confirm("Apakah anda yakin ingin menghapus bank soal ini dan semua data yang terkait dengan bank soal ini?")&&n.promise(N(e).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message}));var e},children:[l.jsx("i",{className:"bi bi-folder-minus"}),l.jsx("span",{className:"ms-2",children:"Hapus"})]})]})})]},i))):l.jsx("tr",{children:l.jsx("td",{colSpan:7,children:"Data belum tersedia"})})})]})})},h=()=>{const[e,a]=c.useState("");return l.jsxs("div",{className:"row g-2",children:[l.jsx("div",{className:"col-lg-3 col-12",children:l.jsx(m,{detail:e,setDetail:a})}),l.jsx("div",{className:"col-lg-9 col-12",children:l.jsx(u,{setDetail:a})})]})};export{h as C};
//# sourceMappingURL=CbtBank-x_PB54ac.js.map
