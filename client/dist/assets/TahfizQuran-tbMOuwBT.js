import{l as e,d4 as a,s,j as t,m as i,I as n,d5 as r,d6 as l,F as d,E as o,d7 as u,d8 as m,d9 as c,da as h,a as j,t as x,a5 as p,am as y,r as g,h as f,A as k}from"./index-nhDkMP-P.js";import{c as S}from"./vendor-DnNJsrFE.js";import{A as b}from"./Add-C7azaqz4.js";import{F as A,D as T}from"./Table-CRspL_aq.js";import{S as C}from"./index-B0CqKd_A.js";import{P as w}from"./index-NHAze4Cv.js";import{T as z}from"./index-Dv9QbTqC.js";import{S as I}from"./Pagination-Dm7015ZA.js";import{s as v}from"./index-C_l6sdMZ.js";import{A as J}from"./index-BSdFFtZO.js";import{R as F}from"./BookOutlined-RnCFvVUi.js";import{R as E}from"./ClusterOutlined-DaWRqgUT.js";import{R as L}from"./ContainerOutlined-M0XSSgR_.js";import{R as B}from"./DeleteOutlined-oJH3Hzd-.js";const N=({title:r,open:l,onClose:d,surah:o})=>{const[u]=e.useForm(),[m,{data:c,error:h,isLoading:j,isSuccess:x}]=a();return S.useEffect(()=>{x&&(s.success(c.message),d(),u.resetFields()),h&&s.error(h.data.message)},[x,h,c]),S.useEffect(()=>{l&&(u.resetFields(),o&&u.setFieldsValue({name:o.name,ayat:o.ayat,lines:o.lines}))},[l,o]),t.jsx(i,{title:r,open:l,onCancel:d,okText:"Simpan",cancelText:"Tutup",onOk:()=>u.submit(),confirmLoading:j,loading:j,children:t.jsxs(e,{layout:"vertical",form:u,onFinish:e=>{if(o){const a={id:o.id,name:e.name,ayat:Number(e.ayat),lines:Number(e.lines)};m(a)}else{const a={name:e.name,ayat:Number(e.ayat),lines:Number(e.lines)};m(a)}},children:[t.jsx(e.Item,{name:"name",label:"Nama Surah",rules:[{required:!0,message:"Nama Surah harus diisi"}],children:t.jsx(n,{placeholder:"Nama Surah"})}),t.jsx(e.Item,{name:"ayat",label:"Jumlah Ayat",rules:[{required:!0,message:"Jumlah Ayat harus diisi"}],children:t.jsx(n,{placeholder:"Jumlah Ayat"})}),t.jsx(e.Item,{name:"lines",label:"Jumlah Baris",rules:[{required:!0,message:"Jumlah Baris harus diisi"}],children:t.jsx(n,{placeholder:"Jumlah Baris"})})]})})},O=()=>{const[e,a]=S.useState(1),[i,u]=S.useState(10),[m,c]=S.useState(""),[h,j]=S.useState(""),[x,p]=S.useState(!1),[y,g]=S.useState(null),{data:f,isLoading:k}=r({page:e,limit:i,search:h}),[T,{data:z,error:I,isLoading:v,isSuccess:J}]=l();S.useEffect(()=>{const e=setTimeout(()=>{j(m),a(1)},500);return()=>{clearTimeout(e)}},[m]),S.useEffect(()=>{J&&s.success(z.message),I&&s.error(I.data.message)},[J,I,z]);const F=[{title:"No",key:"no",render:(a,s,t)=>(e-1)*i+t+1},{title:"Nama Surah",dataIndex:"name",key:"name"},{title:"Jumlah Ayat",dataIndex:"ayat",key:"ayat"},{title:"Jumlah Baris",dataIndex:"lines",key:"lines"},{title:"Aksi",key:"action",render:(e,a)=>t.jsxs(C,{size:"middle",children:[t.jsx(o,{type:"primary",onClick:()=>(g(a),void p(!0)),children:"Edit"}),t.jsx(w,{title:"Apakah Anda yakin ingin menghapus surah ini?",onConfirm:()=>{return e=a.id,void T(e);var e},okText:"Ya",cancelText:"Tidak",children:t.jsx(o,{type:"primary",danger:!0,children:"Delete"})})]})}];return t.jsxs(d,{vertical:!0,gap:"middle",children:[t.jsxs(d,{justify:"space-between",align:"center",children:[t.jsx(n.Search,{placeholder:"Cari Surah ...",allowClear:!0,value:m,onChange:e=>c(e.target.value),style:{width:300}}),t.jsx(b,{onClick:()=>{g(null),p(!0)}})]}),t.jsx(A,{columns:F,dataSource:f?.result,loading:k||v,rowKey:"id",pagination:{current:e,pageSize:i,total:f?.totalData,onChange:(e,s)=>{a(e),u(s)}}}),t.jsx(N,{title:y?"Edit Surah":"Simpan Surah",open:x,onClose:()=>p(!1),surah:y})]})},_=({title:a,open:r,onClose:l,juz:d})=>{const[o]=e.useForm(),[m,{data:c,error:h,isLoading:j,isSuccess:x}]=u();return S.useEffect(()=>{r&&(o.resetFields(),d&&o.setFieldsValue({name:d.name}))},[r,d]),S.useEffect(()=>{x&&(s.success(c.message),l(),o.resetFields()),h&&s.error(h.data.message)},[c,h,x]),t.jsx(i,{title:a,open:r,onCancel:l,okText:"Simpan",cancelText:"Tutup",confirmLoading:j,loading:j,onOk:()=>o.submit(),destroyOnHidden:!0,children:t.jsx(e,{layout:"vertical",form:o,onFinish:e=>{if(d){const a={id:d.id,...e};m(a)}else m(e)},children:t.jsx(e.Item,{name:"name",label:"Nama Juz",rules:[{required:!0,message:"Nama Juz wajiib diisi"}],children:t.jsx(n,{placeholder:"Nama Juz"})})})})},q=({title:a,open:n,onClose:l,juz:d,detail:o})=>{const[u]=e.useForm(),[c,h]=S.useState(null),{data:j}=r({page:"",limit:"",search:""}),[x,{isLoading:p}]=m(),y=j?.map(e=>({label:e.name,value:e.id})),g=e=>{if(!e||!j)return[];const a=j.find(a=>a.id===parseInt(e));return a?Array.from({length:a.ayat},(e,a)=>({label:`Ayat ${a+1}`,value:a+1})):[]};S.useEffect(()=>{n&&(o&&d?(u.setFieldsValue({id:o.id,juzId:d.id,surahId:o.surah_id,fromAyat:o.from_ayat,toAyat:o.to_ayat,lines:o.lines}),h(o.surah_id)):d&&(u.resetFields(),u.setFieldsValue({juzId:d.id}),h(null)))},[n,o,d,u]);return t.jsx(i,{title:a,open:n,onCancel:l,okText:"Simpan",cancelText:"Tutup",destroyOnHidden:!0,confirmLoading:p,onOk:()=>u.submit(),children:t.jsxs(e,{form:u,onFinish:async e=>{try{const a=await x(e).unwrap();s.success(a.message),l()}catch(a){v.error({message:"Gagal Menyimpan",description:a.data?.message||"Terjadi kesalahan"})}},layout:"vertical",children:[t.jsx(e.Item,{name:"id",hidden:!0,children:t.jsx(z,{})}),t.jsx(e.Item,{name:"juzId",hidden:!0,children:t.jsx(z,{})}),t.jsx(e.Item,{name:"surahId",label:"Surah",rules:[{required:!0,message:"Silakan pilih surah!"}],children:t.jsx(I,{showSearch:!0,options:y,placeholder:"Pilih Surah",onChange:e=>h(e),filterOption:(e,a)=>(a?.label??"").toLowerCase().includes(e.toLowerCase()),virtual:!1})}),t.jsx(e.Item,{name:"fromAyat",label:"Dari Ayat",rules:[{required:!0,message:"Silakan pilih ayat awal!"}],children:t.jsx(I,{showSearch:!0,options:g(c),placeholder:"Pilih Ayat Awal",disabled:!c,virtual:!c})}),t.jsx(e.Item,{name:"toAyat",label:"Sampai Ayat",rules:[{required:!0,message:"Silakan pilih ayat akhir!"}],children:t.jsx(I,{showSearch:!0,options:g(c),placeholder:"Pilih Ayat Akhir",disabled:!c,virtual:!c})}),t.jsx(e.Item,{name:"lines",label:"Jumlah Baris",children:t.jsx(z,{placeholder:"Masukkan jumlah baris",style:{width:"100%"},disabled:!c})})]})})},{Text:D}=x,{Search:P}=n,{confirm:R}=i,H=()=>{const[e,a]=S.useState(!1),[i,n]=S.useState(null),[r,l]=S.useState(!1),[u,m]=S.useState(null),[x,{data:f,error:k,isLoading:b,isSuccess:w}]=c(),[z,I]=S.useState(1),[v,N]=S.useState(10),[O,H]=S.useState(""),[M,V]=S.useState(""),{data:$,error:K,isLoading:G,refetch:Q}=h({page:z,limit:v,search:M});S.useEffect(()=>{const e=setTimeout(()=>{V(O),I(1)},500);return()=>clearTimeout(e)},[O]);const Y=(e,{key:s})=>{switch(s){case"add":n(e),m(null),l(!0);break;case"edit":n(e),a(!0);break;case"delete":R({title:`Anda yakin ingin menghapus ${e.name}?`,content:"Tindakan ini tidak dapat dibatalkan.",okText:"Ya, Hapus",okType:"danger",cancelText:"Batal",onOk:()=>x(e.id)})}};S.useEffect(()=>{w&&(s.success(f.message),Q(),I(1)),k&&s.error(k.data.message)},[f,k,w]);const U=[{title:"Juz",dataIndex:"name",key:"name",width:150,render:e=>t.jsx(D,{strong:!0,children:e})},{title:"Surah yang Terkandung",dataIndex:"surah",key:"surah",render:(e,a)=>t.jsx(C,{wrap:!0,children:e.map(e=>t.jsxs(p,{style:{display:"flex",alignItems:"center",padding:"4px 8px",margin:"2px"},children:[e.surah," (",e.from_ayat,"-",e.to_ayat,")",t.jsx(y,{title:"Edit Surah",children:t.jsx(g,{style:{marginLeft:8,cursor:"pointer",color:"#1890ff"},onClick:()=>{return s=e,n(a),m(s),void l(!0);var s}})})]},e.id))})},{title:"Total Ayat",dataIndex:"total_ayat",key:"total_ayat",align:"center",width:100},{title:"Total Baris",dataIndex:"total_line",key:"total_line",align:"center",width:100},{title:"Aksi",key:"action",width:120,align:"center",render:(e,a)=>t.jsx(T.Button,{menu:{items:[{key:"add",label:"Tambah Surah",icon:t.jsx(L,{})},{key:"edit",label:"Edit Juz",icon:t.jsx(g,{})},{key:"delete",label:"Hapus Juz",icon:t.jsx(B,{}),danger:!0}],onClick:({key:e})=>Y(a,{key:e})},children:"Pilihan Aksi"})}];return K?t.jsx(J,{message:"Error",description:"Gagal memuat data juz.",type:"error",showIcon:!0}):t.jsxs(t.Fragment,{children:[t.jsxs(j,{title:t.jsxs(d,{align:"center",justify:"space-between",children:[t.jsxs(C,{children:[t.jsx(F,{}),t.jsx(D,{children:"Daftar Juz Al-Qur'an"})]}),t.jsx(o,{color:"primary",variant:"outlined",icon:t.jsx(E,{}),onClick:()=>{n(null),a(!0)},children:"Tambah Juz"})]}),children:[t.jsx(P,{placeholder:"Cari berdasarkan nama juz...",value:O,onChange:e=>H(e.target.value),style:{marginBottom:16},allowClear:!0,enterButton:!0}),t.jsx(A,{columns:U,dataSource:$?.juz,rowKey:"id",loading:G||b,pagination:{current:z,pageSize:v,total:$?.totalData,onChange:(e,a)=>{I(e),N(a)},showSizeChanger:!0,position:["bottomRight"]},bordered:!0})]}),t.jsx(_,{title:i?"Edit Juz":"Simpan Juz",open:e,onClose:()=>{n(null),a(!1)},juz:i}),t.jsx(q,{title:u?`Edit Surah di ${i?.name}`:`Tambahkan surah di ${i?.name}`,open:r,onClose:()=>{n(null),m(null),l(!1)},juz:i,detail:u})]})},M=()=>{const e=[{label:"Surah",key:"1",children:t.jsx(O,{})},{label:"Juz",key:"2",children:t.jsx(H,{})}];return t.jsx(f,{title:"Management Al Qur'an",levels:["tahfiz"],children:t.jsxs(d,{vertical:!0,gap:"middle",children:[t.jsx(x.Title,{style:{margin:0},level:5,children:"Managemen Alqur'an"}),t.jsx(k,{defaultActiveKey:"1",centered:!0,items:e})]})})};export{M as default};
