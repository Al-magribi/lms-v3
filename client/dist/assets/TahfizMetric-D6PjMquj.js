import{r as a,b5 as w,j as e,V as k,b6 as S,b7 as L,b8 as M,b9 as E}from"./index-Bkq01jzn.js";import{L as P}from"./Layout-uGiKgFPI.js";import{T as D}from"./Table-BJdfPgdp.js";const q=({category:s,setCategory:m})=>{const[r,n]=a.useState(""),[c,d]=a.useState(""),[x,{isLoading:h,isSuccess:u,isError:f,reset:b}]=w(),v=j=>{j.preventDefault();const y={id:r,name:c};k.promise(x(y).unwrap().then(i=>i.message),{loading:"Memuat data...",success:i=>i,error:i=>i.data.message})},g=()=>{m({}),n(""),d("")};return a.useEffect(()=>{(u||f)&&(g(),b())},[u,f]),a.useEffect(()=>{s&&(n(s.id),d(s.name))},[s]),e.jsxs("form",{onSubmit:v,className:"rounded border bg-white p-2 d-flex flex-column gap-2 mb-2",children:[e.jsx("p",{className:"m-0 h6",children:"Kategori Penilaian"}),e.jsx("input",{type:"text",name:"name",id:"name",className:"form-control",placeholder:"Penilaian",value:c||"",onChange:j=>d(j.target.value)}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-warning",onClick:g,children:"Batal"}),e.jsx("button",{type:"submit",className:"btn btn-sm btn-success",disabled:h,children:"Simpan"})]})]})},T=({indicator:s,setIndicator:m})=>{const[r,n]=a.useState(""),[c,d]=a.useState(""),[x,h]=a.useState(""),{data:u}=S({page:"",limit:"",search:""}),[f,{isLoading:b,isSuccess:v,isError:g,reset:j}]=L(),y=l=>{l.preventDefault();const C={id:r,categoryId:c,name:x};k.promise(f(C).unwrap().then(p=>p.message),{loading:"Menambahkan indikator...",success:p=>p,error:p=>p.data.message})},i=()=>{m({}),n(""),d(""),h("")};return a.useEffect(()=>{(v||g)&&(i(),j())},[v,g]),a.useEffect(()=>{s&&(n(s.id),h(s.name),d(s.category_id))},[s]),e.jsxs("form",{onSubmit:y,className:"rounded border bg-white p-2 d-flex flex-column gap-2",children:[e.jsx("p",{className:"m-0 h6",children:"Indikator Penilaian"}),e.jsxs("select",{name:"cetegory",id:"1",className:"form-select",required:!0,value:c||"",onChange:l=>d(l.target.value),children:[e.jsx("option",{value:"",hidden:!0,children:"Pilih Kategori"}),u==null?void 0:u.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Nama Indikator",required:!0,value:x||"",onChange:l=>h(l.target.value)}),e.jsxs("div",{className:"text-end",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-warning me-2",onClick:i,children:"Batal"}),e.jsx("button",{type:"submit",className:"btn btn-sm btn-success",disabled:b,children:"Simpan"})]})]})},A=({setCategory:s,setIndicator:m})=>{const[r,n]=a.useState(1),[c,d]=a.useState(10),[x,h]=a.useState(""),{data:u={},isLoading:f}=S({page:r,limit:c,search:x}),{categories:b=[],totalData:v,totalPage:g}=u,[j,{isLoading:y}]=M(),[i,{isLoading:l}]=E(),C=o=>{k.promise(j(o).unwrap().then(t=>t.message),{loading:"Menghapus kategori...",success:t=>t,error:t=>t.data.message})},p=o=>{k.promise(i(o).unwrap().then(t=>t.message),{loading:"Menghapus indikator...",success:t=>t,error:t=>t.data.message})};return e.jsx(D,{isLoading:f,page:r,setPage:n,totalPage:g,totalData:v,limit:c,setLimit:d,search:x,setSearch:h,children:e.jsxs("table",{className:"mb-0 table table-bordered table-hover table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center",children:"No"}),e.jsx("th",{className:"text-center",children:"Kategori"}),e.jsx("th",{className:"text-center",children:"Indikator"}),e.jsx("th",{className:"text-center",children:"Aksi"})]})}),e.jsx("tbody",{children:b==null?void 0:b.map((o,t)=>e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"text-center align-middle",children:(r-1)*c+t+1}),e.jsx("td",{className:"align-middle",children:o.name}),e.jsx("td",{className:"align-middle",children:e.jsx("div",{className:"d-flex flex-column gap-2",children:o.indicators.filter(N=>N!==null).length>0?o.indicators.filter(N=>N!==null).map((N,I)=>e.jsxs("div",{className:"d-flex align-items-center justify-content-between p-2 rounded border border-2 pointer",children:[e.jsx("p",{className:"m-0",children:N.name}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>m(N),children:e.jsx("i",{className:"bi bi-pencil-square"})}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>p(N.id),children:e.jsx("i",{className:"bi bi-x text-white"})})]})]},I)):e.jsx("p",{className:"m-0 text-muted",children:"Belum ada indikator untuk kategori ini"})})}),e.jsx("td",{className:"align-middle",children:e.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[e.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>s(o),children:e.jsx("i",{className:"bi bi-pencil-square"})}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>C(o.id),children:e.jsx("i",{className:"bi bi-trash"})})]})})]},t))})]})})},F=()=>{const[s,m]=a.useState({}),[r,n]=a.useState({});return e.jsx(P,{title:"Metrik Penilaian",levels:["tahfiz"],children:e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-lg-3 col-12",children:[e.jsx(q,{category:s,setCategory:m}),e.jsx(T,{indicator:r,setIndicator:n})]}),e.jsx("div",{className:"col-lg-9 col-12",children:e.jsx(A,{setCategory:m,setIndicator:n})})]})})};export{F as default};
