import{q as e,r as a,t as s,d as t,j as i}from"./index-CNbAajcm.js";import{b as l}from"./vendor-BYWiIb5-.js";import{L as n}from"./Layout-IeQs0p8A.js";import{t as r}from"./index-C-OX0RB-.js";import{C as d}from"./CmsModal-mC8bpiPz.js";import{C as c}from"./CmsForm-C080LkQ1.js";import{T as o}from"./Table-BSwODE4h.js";import{m}from"./proxy-B0Xu6tIC.js";const u=()=>{const[u,x]=l.useState(!1),[g,h]=l.useState("add"),[j,b]=l.useState(null),[p,y]=l.useState(1),[N,f]=l.useState(10),[v,C]=l.useState(""),[w,S]=l.useState(0),{data:L,isLoading:k,refetch:T}=e({page:p,limit:N,search:v}),{result:A=[],totalData:q,totalPage:F}=L||{},[K,{isLoading:P,isSuccess:B,error:D,data:E,reset:M}]=a(),[O,{isLoading:U}]=s();l.useEffect((()=>{var e;B&&(t.success((null==E?void 0:E.message)||"Category saved successfully"),x(!1),T(),b(null),S((e=>e+1)),M()),D&&(t.error(null==(e=D.data)?void 0:e.message),M())}),[B,D,E,M,T]);return i.jsxs(n,{title:"Kategori",levels:["cms"],children:[i.jsx("div",{className:"container-fluid py-3 py-md-4",children:i.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[i.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx("div",{className:"bg-primary bg-opacity-10 p-3 rounded me-3",children:i.jsx(r,{className:"text-primary fs-4"})}),i.jsx("h4",{className:"mb-0",children:"Kategori"})]}),i.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>{h("add"),b(null),x(!0)},children:[i.jsx("span",{className:"bi bi-plus-circle"}),i.jsx("span",{className:"ms-2",children:"Tambah Kategori"})]})]}),i.jsx("div",{className:"card border-0 shadow-sm",children:i.jsx("div",{className:"card-body",children:i.jsx(o,{isLoading:k,page:p,setPage:y,totalPages:F,limit:N,setLimit:f,setSearch:C,totalData:q,children:i.jsxs("table",{className:"mb-0 table table-bordered table-striped table-hover",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-center align-middle",children:"No"}),i.jsx("th",{className:"text-center align-middle",children:"Name"}),i.jsx("th",{className:"text-center align-middle",children:"Actions"})]})}),i.jsx("tbody",{children:null==A?void 0:A.map(((e,a)=>i.jsxs("tr",{children:[i.jsx("td",{className:"text-center align-middle",children:(p-1)*N+a+1}),i.jsx("td",{className:"align-middle",children:e.name}),i.jsx("td",{className:"text-center align-middle",children:i.jsxs("div",{className:"d-flex align-items-center justify-content-center gap-2",children:[i.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>(e=>{h("edit"),b(e),x(!0)})(e),children:i.jsx("i",{className:"bi bi-pencil-square"})}),i.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>(async e=>{var a,s,i;if(window.confirm("Apakah anda yakin ingin menghapus kategori ini?"))try{const i=await O(e).unwrap();console.log(i),200===i.status?(t.success(i.message),T()):t.error(null==(s=null==(a=i.error)?void 0:a.data)?void 0:s.message)}catch(l){t.error((null==(i=l.data)?void 0:i.message)||"Failed to delete category")}})(e.id),disabled:U,children:i.jsx("i",{className:"bi bi-trash"})})]})})]},e.id)))})]})})})})]})}),i.jsx(d,{isOpen:u,onClose:()=>{x(!1),b(null),S((e=>e+1))},title:"add"===g?"Add New Category":"Edit Category",children:i.jsx(c,{fields:[{name:"name",label:"Name",type:"text",required:!0}],initialValues:j||{name:"",description:"",slug:""},onSubmit:async e=>{var a;try{await K(e).unwrap()}catch(s){t.error((null==(a=s.data)?void 0:a.message)||"Failed to save category")}},onCancel:()=>{b(null),x(!1),S((e=>e+1))},submitButtonText:"add"===g?"Add Category":"Update Category",cancelButtonText:"Cancel",isLoading:P},w)})]})};export{u as default};
//# sourceMappingURL=CategoriesPage-CrcF5OKV.js.map
