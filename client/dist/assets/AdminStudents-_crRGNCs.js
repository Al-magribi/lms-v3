import{a8 as e,ac as s,aj as a,j as t,e as n,ab as i,ak as d,al as l,am as r,V as c}from"./index-mQl5svQ-.js";import{b as o}from"./vendor-DfXzdC0j.js";import{L as m}from"./Layout-CMxW7Kh2.js";import{T as x}from"./Table-D4ODITAU.js";import"./index-CGMX7dKw.js";import"./index-hpZ4eOv6.js";import"./index-DyuEXp_a.js";const h=[{id:"nis",name:"nis",placeholder:"NIS"},{id:"name",name:"name",placeholder:"Name"}],u=({detail:i,setDetail:d})=>{const[l,r]=o.useState({id:"",entry:"",classid:"",nis:"",name:"",gender:""}),{data:c}=e({page:"",limit:"",search:""}),{data:m}=s({page:"",limit:"",search:""}),[x,{isSuccess:u,isLoading:p,isError:b,reset:g}]=a(),j=e=>{const{name:s,value:a}=e.target;r((e=>({...e,[s]:a})))},N=()=>{d({}),r({id:"",entry:"",classid:"",nis:"",name:"",gender:""})};return o.useEffect((()=>{if(u){g(),d({}),r({id:"",entry:"",classid:"",nis:"",name:"",gender:""});document.querySelector("[data-bs-dismiss='modal']").click()}b&&g()}),[u,b]),o.useEffect((()=>{i&&r({id:i.id||"",entry:i.entry_id||"",classid:i.classid||"",name:i.name||"",nis:i.nis||"",gender:i.gender||""})}),[i]),o.useEffect((()=>{const e=document.getElementById("addstudent");if(!e)return;const s=()=>{r({id:"",entry:"",classid:"",nis:"",name:"",gender:""}),document.activeElement&&document.activeElement.blur()};return e.addEventListener("hidden.bs.modal",s),()=>e.removeEventListener("hidden.bs.modal",s)}),[]),t.jsx("div",{className:"modal fade",id:"addstudent","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"studentModalLabel","aria-hidden":"true",children:t.jsx("div",{className:"modal-dialog ",children:t.jsxs("form",{onSubmit:e=>{e.preventDefault(),n.promise(x(l).unwrap().then((e=>e.message)),{loading:"Menyimpan Data...",success:e=>e,error:e=>e.data.message})},className:"modal-content p-3",children:[t.jsxs("div",{className:"modal-header",children:[t.jsx("h5",{className:"modal-title",id:"studentModalLabel",children:l.id?"Edit Siswa":"Tambah Siswa"}),t.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:N})]}),t.jsxs("div",{className:"modal-body d-flex flex-column gap-3",children:[t.jsxs("select",{name:"entry",id:"entry",className:"form-select",value:l.entry,onChange:j,required:!0,children:[t.jsx("option",{value:"",hidden:!0,children:"Tahun Masuk"}),null==c?void 0:c.map((e=>t.jsx("option",{value:e.id,children:e.name},e.id)))]}),t.jsxs("select",{name:"classid",id:"classid",className:"form-select",value:l.classid,onChange:j,required:!0,children:[t.jsx("option",{value:"",hidden:!0,children:"Kelas"}),null==m?void 0:m.map((e=>t.jsx("option",{value:e.id,children:e.name},e.id)))]}),null==h?void 0:h.map(((e,s)=>t.jsx("input",{type:"text",className:"form-control",placeholder:e.placeholder,name:e.name,id:e.name,value:l[e.name]||"",onChange:j,required:!0},s))),t.jsxs("select",{name:"gender",id:"gender",className:"form-select",value:l.gender,onChange:j,required:!0,children:[t.jsx("option",{value:"",hidden:!0,children:"Jenis Kelamin"}),t.jsx("option",{value:"L",children:"Laki Laki"}),t.jsx("option",{value:"P",children:"Perempuan"})]})]}),t.jsxs("div",{className:"modal-footer",children:[t.jsxs("button",{type:"button",className:"btn  btn-warning","data-bs-dismiss":"modal",onClick:N,children:[t.jsx("i",{className:"bi bi-x-lg me-1"}),"Batal"]}),t.jsxs("button",{type:"submit",className:"btn btn-success",disabled:p,children:[t.jsx("i",{className:"bi bi-save me-1"}),"Simpan"]})]})]})})})},p=({setDetail:e})=>{const[s,a]=o.useState(1),[n,m]=o.useState(10),[h,u]=o.useState("");o.useState("");const{data:p={},isLoading:b,refetch:g}=i({page:s,limit:n,search:h}),{students:j=[],totalData:N,totalPages:y}=p;d();const[f,{isSuccess:v,isLoading:w,isError:S,reset:k}]=l(),[L,{isLoading:E}]=r();return o.useEffect((()=>{v&&k(),S&&k()}),[v,S]),t.jsx(x,{page:s,setPage:a,setLimit:m,setSearch:u,totalData:N,totalPages:y,isLoading:b,downloadButton:{onClick:()=>{c.promise(L().unwrap().then((e=>e.message)),{loading:"Mengunduh data siswa...",success:e=>e,error:e=>{var s;return(null==(s=e.data)?void 0:s.message)||"Gagal mengunduh file"}})},isLoading:E},children:t.jsx("div",{className:"table-responsive",children:t.jsxs("table",{className:"table table-hover align-middle",style:{fontSize:"0.9rem"},children:[t.jsx("thead",{className:"table-light",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-center",style:{width:"60px"},children:"No"}),t.jsx("th",{className:"text-start",children:"Nama Siswa"}),t.jsx("th",{className:"text-center",style:{width:"80px"},children:"Gender"}),t.jsx("th",{className:"text-center",style:{width:"120px"},children:"NIS"}),t.jsx("th",{className:"text-center",style:{width:"100px"},children:"Kelas"}),t.jsx("th",{className:"text-center",style:{width:"100px"},children:"Status"}),t.jsx("th",{className:"text-center",style:{width:"120px"},children:"Aksi"})]})}),t.jsx("tbody",{children:(null==j?void 0:j.length)>0?j.map(((a,i)=>t.jsxs("tr",{className:"border-bottom",children:[t.jsx("td",{className:"text-center text-muted fw-medium",children:(s-1)*n+i+1}),t.jsx("td",{children:t.jsxs("div",{className:"d-flex flex-column",children:[t.jsx("span",{className:"fw-semibold text-dark",style:{fontSize:"0.95rem"},children:a.name}),t.jsxs("small",{className:"text-muted",children:[a.homebase," â€¢ ",a.periode_name]})]})}),t.jsx("td",{className:"text-center",children:t.jsx("span",{className:"badge rounded-pill text-dark "+("L"===a.gender?"bg-primary bg-opacity-10":"bg-pink bg-opacity-10"),style:{fontSize:"0.75rem"},children:"L"===a.gender?"L":"P"})}),t.jsx("td",{className:"text-center",children:t.jsx("code",{className:"bg-light px-2 py-1 rounded",style:{fontSize:"0.8rem"},children:a.nis})}),t.jsx("td",{className:"text-center",children:t.jsx("span",{className:"badge bg-secondary bg-opacity-10 text-secondary rounded-pill",children:a.classname})}),t.jsx("td",{className:"text-center",children:t.jsx("span",{className:"badge rounded-pill "+(a.isactive?"bg-success bg-opacity-10 text-success":"bg-danger bg-opacity-10 text-danger"),style:{fontSize:"0.75rem"},children:a.isactive?"Aktif":"Nonaktif"})}),t.jsx("td",{className:"text-center",children:t.jsxs("div",{className:"dropdown",children:[t.jsx("button",{className:"btn btn-sm btn-outline-secondary border-0",type:"button",id:`dropdownMenuButton${a.id}`,"data-bs-toggle":"dropdown","aria-expanded":"false",style:{fontSize:"0.8rem"},children:t.jsx("i",{className:"bi bi-three-dots-vertical"})}),t.jsxs("ul",{className:"dropdown-menu dropdown-menu-end shadow-sm border-0","aria-labelledby":`dropdownMenuButton${a.id}`,style:{fontSize:"0.85rem"},children:[t.jsx("li",{children:t.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2 py-2","data-bs-target":"#addstudent","data-bs-toggle":"modal",onClick:()=>e(a),children:[t.jsx("i",{className:"bi bi-pencil-square text-primary"}),t.jsx("span",{children:"Edit Data"})]})}),t.jsx("li",{children:t.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2 py-2 text-danger",disabled:w,onClick:()=>{return e=a.id,void(window.confirm("Apakah anda yakin ingin menghapus siswa ini dan semua data yang terkait dengan siswa ini?")&&c.promise(f(e).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message}));var e},children:[t.jsx("i",{className:"bi bi-trash3"}),t.jsx("span",{children:"Hapus"})]})})]})]})})]},i))):t.jsx("tr",{children:t.jsx("td",{colSpan:"7",className:"text-center py-5",children:t.jsxs("div",{className:"d-flex flex-column align-items-center text-muted",children:[t.jsx("i",{className:"bi bi-inbox fs-1 mb-3"}),t.jsx("span",{className:"fw-medium",children:"Data siswa belum tersedia"}),t.jsx("small",{children:"Silakan tambahkan data siswa baru"})]})})})})]})})})},b=()=>{const[e,s]=o.useState("");return t.jsxs(m,{title:"Management Siswa",levels:["admin"],children:[t.jsx(u,{detail:e,setDetail:s}),t.jsx(p,{setDetail:s})]})};export{b as default};
//# sourceMappingURL=AdminStudents-_crRGNCs.js.map
