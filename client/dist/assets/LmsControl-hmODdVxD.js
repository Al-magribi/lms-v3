import{a1 as e,a2 as a,aq as t,j as s,F as i,r as n,R as r,C as l,a as d,l as c,b9 as o,s as u,m as h,I as m,ba as p,bb as x,bc as g,an as j,B as f,n as b,bd as k,be as y,bf as w,bg as v,h as S,aH as C,x as _,$ as T,V as N,bh as P,bi as L,bj as M,bk as F,bl as z,ar as I,aj as A,b as E,bm as B,bn as D,bo as R,D as O,bp as H,bq as K,br as Y,bs as V,bt as $,bu as U,bv as G,bw as q,bx as J,by as W}from"./index-uqXiPZaM.js";import{c as Z,k as X,u as Q}from"./vendor-DTs43g_X.js";import{A as ee}from"./Add-ClBUWLqP.js";import{M as ae}from"./index-DzGsxoGF.js";import{U as te,R as se,b as ie,a as ne}from"./InboxOutlined-DhcWKAB8.js";import{E as re,S as le}from"./Pagination-CcDshGE9.js";import{R as de}from"./FileAddOutlined-CdXuWoHa.js";import{L as ce}from"./index-BG1UhwPk.js";import{P as oe}from"./index-yWlD8c-I.js";import{R as ue}from"./DeleteOutlined-C5VyeaFb.js";import{S as he}from"./index-DimbDAWW.js";import{C as me}from"./Collapse-COadr64i.js";import{E as pe}from"./Editor-Bw8O7CXI.js";import{R as xe}from"./ReadOutlined-B2SKpySL.js";import{R as ge}from"./FileTextOutlined-CfU_-iR4.js";import{d as je}from"./dayjs.min-Cd2uXBeR.js";import"./id-Ck3wpXja.js";import{R as fe}from"./CalendarOutlined-Chrjrg9V.js";import{D as be}from"./index-Dg5vie8D.js";import{R as ke}from"./CheckCircleOutlined-Cjmvrnll.js";import{R as ye}from"./CloseCircleOutlined-DUu7cAUq.js";import{F as we,a as ve}from"./Table-Cvq4F04g.js";import{R as Se}from"./FileExcelOutlined-DwAYiB5B.js";import{T as Ce}from"./index-BAm9WSKq.js";import{R as _e}from"./BookOutlined-CNrhxhO_.js";import{A as Te}from"./index-7mhCT5El.js";import{r as Ne,u as Pe,w as Le}from"./xlsx-Dmkey_AY.js";import"./progress-BWpqLqt3.js";import"./ClockCircleOutlined-QE2gWT7q.js";var Me={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M923 283.6a260.04 260.04 0 00-56.9-82.8 264.4 264.4 0 00-84-55.5A265.34 265.34 0 00679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 00-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9zM512 814.8S156 586.7 156 385.5C156 283.6 240.3 201 344.3 201c73.1 0 136.5 40.8 167.7 100.4C543.2 241.8 606.6 201 679.7 201c104 0 188.3 82.6 188.3 184.5 0 201.2-356 429.3-356 429.3z"}}]},name:"heart",theme:"outlined"},Fe=function(t,s){return Z.createElement(e,a({},t,{ref:s,icon:Me}))},ze=Z.forwardRef(Fe),Ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"}}]},name:"history",theme:"outlined"},Ae=function(t,s){return Z.createElement(e,a({},t,{ref:s,icon:Ie}))},Ee=Z.forwardRef(Ae),Be={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M855.7 210.8l-42.4-42.4a8.03 8.03 0 00-11.3 0L168.3 801.9a8.03 8.03 0 000 11.3l42.4 42.4c3.1 3.1 8.2 3.1 11.3 0L855.6 222c3.2-3 3.2-8.1.1-11.2zM304 448c79.4 0 144-64.6 144-144s-64.6-144-144-144-144 64.6-144 144 64.6 144 144 144zm0-216c39.7 0 72 32.3 72 72s-32.3 72-72 72-72-32.3-72-72 32.3-72 72-72zm416 344c-79.4 0-144 64.6-144 144s64.6 144 144 144 144-64.6 144-144-64.6-144-144-144zm0 216c-39.7 0-72-32.3-72-72s32.3-72 72-72 72 32.3 72 72-32.3 72-72 72z"}}]},name:"percentage",theme:"outlined"},De=function(t,s){return Z.createElement(e,a({},t,{ref:s,icon:Be}))},Re=Z.forwardRef(De),Oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"},He=function(t,s){return Z.createElement(e,a({},t,{ref:s,icon:Oe}))},Ke=Z.forwardRef(He),Ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM664 533h-48.1c-4.2 0-7.8 3.2-8.1 7.4C604 589.9 562.5 629 512 629s-92.1-39.1-95.8-88.6c-.3-4.2-3.9-7.4-8.1-7.4H360a8 8 0 00-8 8.4c4.4 84.3 74.5 151.6 160 151.6s155.6-67.3 160-151.6a8 8 0 00-8-8.4z"}}]},name:"smile",theme:"outlined"},Ve=function(t,s){return Z.createElement(e,a({},t,{ref:s,icon:Ye}))},$e=Z.forwardRef(Ve),Ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"},Ge=function(t,s){return Z.createElement(e,a({},t,{ref:s,icon:Ue}))},qe=Z.forwardRef(Ge),Je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},We=function(t,s){return Z.createElement(e,a({},t,{ref:s,icon:Je}))},Ze=Z.forwardRef(We),Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M368 724H252V608c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v116H72c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h116v116c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V788h116c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M912 302.3L784 376V224c0-35.3-28.7-64-64-64H128c-35.3 0-64 28.7-64 64v352h72V232h576v560H448v72h272c35.3 0 64-28.7 64-64V648l128 73.7c21.3 12.3 48-3.1 48-27.6V330c0-24.6-26.7-40-48-27.7zM888 625l-104-59.8V458.9L888 399v226z"}},{tag:"path",attrs:{d:"M320 360c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H208c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h112z"}}]},name:"video-camera-add",theme:"outlined"},Qe=function(t,s){return Z.createElement(e,a({},t,{ref:s,icon:Xe}))},ea=Z.forwardRef(Qe),aa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M960 509.2c0-2.2 0-4.7-.1-7.6-.1-8.1-.3-17.2-.5-26.9-.8-27.9-2.2-55.7-4.4-81.9-3-36.1-7.4-66.2-13.4-88.8a139.52 139.52 0 00-98.3-98.5c-28.3-7.6-83.7-12.3-161.7-15.2-37.1-1.4-76.8-2.3-116.5-2.8-13.9-.2-26.8-.3-38.4-.4h-29.4c-11.6.1-24.5.2-38.4.4-39.7.5-79.4 1.4-116.5 2.8-78 3-133.5 7.7-161.7 15.2A139.35 139.35 0 0082.4 304C76.3 326.6 72 356.7 69 392.8c-2.2 26.2-3.6 54-4.4 81.9-.3 9.7-.4 18.8-.5 26.9 0 2.9-.1 5.4-.1 7.6v5.6c0 2.2 0 4.7.1 7.6.1 8.1.3 17.2.5 26.9.8 27.9 2.2 55.7 4.4 81.9 3 36.1 7.4 66.2 13.4 88.8 12.8 47.9 50.4 85.7 98.3 98.5 28.2 7.6 83.7 12.3 161.7 15.2 37.1 1.4 76.8 2.3 116.5 2.8 13.9.2 26.8.3 38.4.4h29.4c11.6-.1 24.5-.2 38.4-.4 39.7-.5 79.4-1.4 116.5-2.8 78-3 133.5-7.7 161.7-15.2 47.9-12.8 85.5-50.5 98.3-98.5 6.1-22.6 10.4-52.7 13.4-88.8 2.2-26.2 3.6-54 4.4-81.9.3-9.7.4-18.8.5-26.9 0-2.9.1-5.4.1-7.6v-5.6zm-72 5.2c0 2.1 0 4.4-.1 7.1-.1 7.8-.3 16.4-.5 25.7-.7 26.6-2.1 53.2-4.2 77.9-2.7 32.2-6.5 58.6-11.2 76.3-6.2 23.1-24.4 41.4-47.4 47.5-21 5.6-73.9 10.1-145.8 12.8-36.4 1.4-75.6 2.3-114.7 2.8-13.7.2-26.4.3-37.8.3h-28.6l-37.8-.3c-39.1-.5-78.2-1.4-114.7-2.8-71.9-2.8-124.9-7.2-145.8-12.8-23-6.2-41.2-24.4-47.4-47.5-4.7-17.7-8.5-44.1-11.2-76.3-2.1-24.7-3.4-51.3-4.2-77.9-.3-9.3-.4-18-.5-25.7 0-2.7-.1-5.1-.1-7.1v-4.8c0-2.1 0-4.4.1-7.1.1-7.8.3-16.4.5-25.7.7-26.6 2.1-53.2 4.2-77.9 2.7-32.2 6.5-58.6 11.2-76.3 6.2-23.1 24.4-41.4 47.4-47.5 21-5.6 73.9-10.1 145.8-12.8 36.4-1.4 75.6-2.3 114.7-2.8 13.7-.2 26.4-.3 37.8-.3h28.6l37.8.3c39.1.5 78.2 1.4 114.7 2.8 71.9 2.8 124.9 7.2 145.8 12.8 23 6.2 41.2 24.4 47.4 47.5 4.7 17.7 8.5 44.1 11.2 76.3 2.1 24.7 3.4 51.3 4.2 77.9.3 9.3.4 18 .5 25.7 0 2.7.1 5.1.1 7.1v4.8zM423 646l232-135-232-133z"}}]},name:"youtube",theme:"outlined"},ta=function(t,s){return Z.createElement(e,a({},t,{ref:s,icon:aa}))},sa=Z.forwardRef(ta);const{Meta:ia}=d,na=()=>{const[e,a]=X(),{user:c}=t(e=>e.auth),o=c?.subjects;return s.jsxs(i,{vertical:!0,gap:"middle",children:[s.jsx(n.Title,{level:5,children:"Daftar Mata Pelajaran"}),s.jsx(r,{gutter:[16,16],children:o?.map(e=>s.jsx(l,{sm:24,md:12,lg:6,children:s.jsx(d,{hoverable:!0,cover:s.jsx("img",{src:e.cover?e.cover:"/logo.png",alt:e.name}),onClick:()=>(e=>{a({mode:"lms",name:e.name?.replace(/\s+/g,"-"),subjectid:e.id})})(e),children:s.jsx(ia,{title:e.name})})},e.id))})]})},{TextArea:ra}=m,la=({title:e,open:a,onClose:t,chapterid:i,content:n})=>{const[r]=c.useForm(),[l,{isLoading:d,isSuccess:p,error:x,data:g,reset:j}]=o();return Z.useEffect(()=>{p&&(u.success(g.message),r.resetFields(),t(),j()),x&&(u.error(x.data.message),j())},[g,p,x]),Z.useEffect(()=>{a&&(r.resetFields(),n&&r.setFieldsValue({title:n.content_title,content:n.content_target}))},[n]),s.jsx(ae,{title:e,open:a,onCancel:t,okText:"Simpan",cancelText:"Tutup",onOk:()=>r.submit(),children:s.jsx(h,{tip:"Memproses Data",spinning:d,children:s.jsxs(c,{layout:"vertical",form:r,onFinish:e=>{if(n){const a={chapterid:i,contentid:n.content_id,...e};l(a)}else{const a={chapterid:i,...e};l(a)}},children:[s.jsx(c.Item,{name:"title",label:"Judul Materi",rules:[{required:!0,message:"Judul Materi Wajib diisi!"}],children:s.jsx(m,{placeholder:"Judul Materi"})}),s.jsx(c.Item,{name:"content",label:"Capaian Pembelajaran",rules:[{required:!0,message:"Capaian Wajib diisi!"}],children:s.jsx(ra,{rows:4,placeholder:"Capaian Pembelajaran"})})]})})})},{Dragger:da}=te,ca=({title:e,open:a,onClose:t,contentid:i})=>{const[n]=c.useForm(),[r,{isLoading:l,isSuccess:d,error:o,data:x,reset:g}]=p();Z.useEffect(()=>{a&&n.resetFields(),d&&(u.success(x?.message||"File berhasil diunggah!"),g(),t(),n.resetFields()),o&&(u.error(o.data?.message||"Terjadi kesalahan saat mengunggah."),g())},[x,d,o,t,g,a]);return s.jsx(ae,{title:e,open:a,onCancel:t,okText:"Simpan",cancelText:"Tutup",onOk:()=>n.submit(),confirmLoading:l,destroyOnHidden:!0,maskClosable:!1,children:s.jsx(h,{tip:"Mengunggah File...",spinning:l,children:s.jsxs(c,{form:n,layout:"vertical",onFinish:e=>{const a=new FormData;a.append("contentId",i),a.append("title",e.title),e.files.forEach(e=>{a.append("files",e.originFileObj)}),r(a)},children:[s.jsx(c.Item,{name:"title",label:"Nama File",rules:[{required:!0,message:"Nama file tidak boleh kosong!"}],children:s.jsx(m,{placeholder:"Nama File"})}),s.jsx(c.Item,{label:"Pilih File",name:"files",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e?.fileList,rules:[{required:!0,message:"Silakan pilih minimal satu file!"}],children:s.jsxs(da,{name:"files",multiple:!0,accept:".pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.txt,.zip,.rar",beforeUpload:()=>!1,children:[s.jsx("p",{className:"ant-upload-drag-icon",children:s.jsx(se,{})}),s.jsx("p",{className:"ant-upload-text",children:"Klik atau seret file ke area ini untuk mengunggah"}),s.jsx("p",{className:"ant-upload-hint",children:"Mendukung unggahan tunggal atau massal. Format yang diizinkan: PDF, DOC, PPT, XLS, TXT, ZIP, RAR."})]})})]})})})},oa=({title:e,open:a,onClose:t,contentid:i})=>{const[n]=c.useForm(),[r,{data:l,error:d,isLoading:o,isSuccess:h,reset:x}]=p();return Z.useEffect(()=>{a&&n.resetFields(),h&&(u.success(l.message),n.resetFields(),t(),x()),d&&(u.error(d.data.message),x())},[a,l,h,d]),s.jsx(ae,{title:e,open:a,onCancel:t,okText:"Simpan",cancelText:"Tutup",onOk:()=>n.submit(),destroyOnHidden:!0,loading:o,children:s.jsxs(c,{layout:"vertical",form:n,onFinish:e=>{if(!/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+/.test(e.video))return void u.error("URL tidak valid. Pastikan URL dari YouTube");const a=new FormData;a.append("contentId",i),a.append("title",e.title),a.append("video",e.video),r(a)},children:[s.jsx(c.Item,{name:"title",label:"Judul Video",rules:[{required:!0,message:"Judul Wajib diisi"}],children:s.jsx(m,{placeholder:"Judul Video"})}),s.jsx(c.Item,{name:"video",label:"YouTube URL",rules:[{required:!0,message:"YouTube URL harus diisi"}],children:s.jsx(m,{placeholder:"YouTube URL"})})]})})},ua=({open:e,onClose:a,video:t})=>{if(!t||!t.video)return null;const i=(e=>{let a="";const t=e.match(/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);return t&&(a=t[1]),a})(t.video),n=`https://www.youtube.com/embed/${i}?autoplay=1`;return s.jsx(ae,{title:t.title?`Playing Video: ${t.title}`:"Play Video",open:e,onCancel:a,destroyOnHidden:!0,width:800,footer:null,children:i?s.jsx("div",{className:"video-responsive",style:{position:"relative",paddingBottom:"56.25%",height:0,overflow:"hidden",borderRadius:"15px"},children:s.jsx("iframe",{width:"100%",height:"100%",src:n,title:t.title||"YouTube video player",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})}):s.jsx("p",{children:"Invalid YouTube URL provided."})})},{Panel:ha}=me,{Text:ma,Paragraph:pa,Title:xa}=n,ga=({contents:e,chapterId:a})=>{const[t,{isSuccess:n,isLoading:r,data:l,error:d,reset:c}]=x(),[o]=g(),[h,m]=Z.useState(!1),[p,k]=Z.useState(""),[y,w]=Z.useState(""),[v,S]=Z.useState(!1),[C,_]=Z.useState(!1),[T,N]=Z.useState(!1),[P,L]=Z.useState(""),M=e=>{t(e)};if(Z.useEffect(()=>{n&&(u.success(l.message),c()),d&&(u.error(d.data.message),c())},[l,n,d]),console.log(e),!e||0===e.length)return s.jsx(re,{image:re.PRESENTED_IMAGE_SIMPLE,description:"Belum ada materi untuk bab ini."});const F=e.map((e,a)=>({key:e.content_id,label:s.jsx(xa,{level:5,style:{margin:0},children:e.content_title}),extra:s.jsxs(he,{onClick:e=>e.stopPropagation(),children:[s.jsx(j,{title:"Edit Materi",children:s.jsx(f,{shape:"circle",icon:s.jsx(b,{}),onClick:()=>(e=>{k(e),m(!0)})(e)})}),s.jsx(oe,{title:"Hapus materi ini?",description:"Semua file dan video di dalamnya akan ikut terhapus.",onConfirm:()=>{return a=e.content_id,void o(a);var a},okText:"Ya, Hapus",cancelText:"Batal",children:s.jsx(j,{title:"Hapus Materi",children:s.jsx(f,{danger:!0,shape:"circle",icon:s.jsx(ue,{})})})})]}),children:s.jsxs(i,{vertical:!0,gap:"large",children:[s.jsxs("div",{children:[s.jsx(ma,{strong:!0,children:"Tujuan Pembelajaran:"}),s.jsx(pa,{children:s.jsx(ma,{type:"secondary",style:{whiteSpace:"pre-wrap"},children:e.content_target||"-"})})]}),s.jsxs("div",{children:[s.jsxs(i,{justify:"space-between",align:"center",wrap:"wrap",gap:8,children:[s.jsx(ma,{strong:!0,children:"File Materi:"}),s.jsx(j,{title:"Tambah File Baru",children:s.jsx(f,{icon:s.jsx(de,{}),onClick:()=>{return a=e.content_id,w(a),void S(!0);var a},children:"Tambah File"})})]}),s.jsx(ce,{itemLayout:"horizontal",dataSource:e.files,renderItem:e=>s.jsx(ce.Item,{actions:[s.jsx(oe,{title:"Hapus file ini?",onConfirm:()=>M(e.id),okText:"Ya",cancelText:"Tidak",children:s.jsx(j,{title:"Hapus File",children:s.jsx(f,{type:"text",danger:!0,shape:"circle",icon:s.jsx(ue,{})})})},`delete-${e.id}`)],children:s.jsx(ce.Item.Meta,{avatar:s.jsx(ie,{}),title:s.jsx("a",{href:e.file,target:"_blank",rel:"noopener noreferrer",children:e.title})})})})]}),s.jsxs("div",{children:[s.jsxs(i,{justify:"space-between",align:"center",wrap:"wrap",gap:8,children:[s.jsx(ma,{strong:!0,children:"Video Materi:"}),s.jsx(j,{title:"Tambah Video Baru",children:s.jsx(f,{icon:s.jsx(ea,{}),onClick:()=>{return a=e.content_id,w(a),void _(!0);var a},children:"Tambah Video"})})]}),s.jsx(ce,{dataSource:e.videos,renderItem:e=>s.jsx(ce.Item,{actions:[s.jsx(f,{shape:"circle",icon:s.jsx(ea,{}),onClick:()=>(e=>{L(e),N(!0)})(e)},`Play-${e.id}`),s.jsx(oe,{title:"Hapus file ini?",onConfirm:()=>M(e.id),okText:"Ya",cancelText:"Tidak",children:s.jsx(j,{title:"Hapus File",children:s.jsx(f,{type:"text",danger:!0,shape:"circle",icon:s.jsx(ue,{})})})},`delete-${e.id}`)],children:s.jsx(ce.Item.Meta,{avatar:s.jsx(sa,{style:{color:"#CD201F"}}),title:s.jsx(ma,{children:e.title})})})})]})]})}));return s.jsxs(s.Fragment,{children:[s.jsx(me,{accordion:!0,items:F}),s.jsx(la,{title:`Edit Materi ${p.content_title}`,open:h,content:p,onClose:()=>{k(""),m(!1)}}),s.jsx(ca,{title:"Simpan File Baru",open:v,onClose:()=>{w(""),S(!1)},contentid:y}),s.jsx(oa,{title:"Simpan YouTube Video",open:C,onClose:()=>{w(""),_(!1)},contentid:y}),s.jsx(ua,{open:T,onClose:()=>{L(""),N(!1)},video:P})]})},ja=({title:e,open:a,onClose:t,chapter:i})=>{console.log(i);const[n]=c.useForm(),[r]=X(),[l,d]=Z.useState(""),{data:o}=k(),[p,{isLoading:x,isSuccess:g,data:j,error:f}]=y(),b=r.get("subjectid"),w=o?.map(e=>({value:e.id,label:e.name}));return Z.useEffect(()=>{g&&(u.success(j.message),n.resetFields(),d(""),t()),f&&u.error(f.data.message)},[j,g,f]),Z.useEffect(()=>{a&&(n.resetFields(),d(""),i&&(d(i.chapter_id),n.setFieldsValue({title:i.chapter_name,target:i.target,classes:i.class?.map(e=>e.id)})))},[i,a]),s.jsx(ae,{title:e,open:a,onCancel:t,okText:"Simpan",cancelText:"Tutup",destroyOnHidden:!0,onOk:()=>n.submit(),children:s.jsx(h,{tip:"Memproses data",spinning:x,children:s.jsxs(c,{form:n,layout:"vertical",onFinish:e=>{if(l){const a={subjectid:b,chapterid:l,...e};p(a)}else{const a={subjectid:b,...e};p(a)}},children:[s.jsx(c.Item,{name:"title",label:"Nama Bab",rules:[{required:!0,message:"Nama bab wajib diisi"}],children:s.jsx(m,{placeholder:"Nama Bab"})}),s.jsx(c.Item,{name:"target",label:"Capaian Pembelajaran",children:s.jsx(pe,{placeholder:"Tuliskan Capaian Pembelajaran",height:250})}),s.jsx(c.Item,{name:"classes",label:"Pilih Kelas",rules:[{required:!0,message:"Kelas wajib dipilih"}],children:s.jsx(le,{mode:"multiple",placeholder:"Pilih Kelas",options:w,allowClear:!0,showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})})]})})})},{confirm:fa}=ae,ba=({name:e,id:a})=>{const t=Q(),[c,o]=Z.useState(!1),[h,m]=Z.useState(!1),[p,x]=Z.useState(!1),[g,k]=Z.useState(""),{data:y,isLoading:N}=w(a,{skip:!a}),[P,{isLoading:L,isSuccess:M,error:F,data:z}]=v();return Z.useEffect(()=>{M&&u.success(z.message),F&&u.error(F.data.message)},[z,M,F]),s.jsxs(S,{title:e.replace(/-/g," "),levels:["teacher"],children:[s.jsxs(i,{vertical:!0,gap:"middle",children:[s.jsxs(i,{align:"center",justify:"space-between",children:[s.jsxs(he,{children:[s.jsx(f,{shape:"circle",icon:s.jsx(C,{}),onClick:()=>{t("/learning-management-system")}}),s.jsxs("div",{children:[s.jsx(n.Title,{style:{margin:0},level:5,children:`Pelajaran: ${e.replace(/-/g," ")}`}),s.jsx(n.Text,{type:"secondary",children:"Daftar Bab"})]})]}),s.jsx(ee,{onClick:()=>m(!0)})]}),s.jsx(r,{gutter:[16,16],children:y?.length>0?y?.map((e,a)=>{return s.jsx(l,{sm:24,children:s.jsx(d,{hoverable:!0,loading:N||L,title:s.jsx(T,{color:"green",children:e.chapter_name}),actions:[s.jsx(j,{title:"Edit Bab",children:s.jsx(b,{onClick:()=>(e=>{k(e),x(!0),m(!0)})(e)},"edit")}),s.jsx(j,{title:"Hapus Bab",children:s.jsx(ue,{onClick:()=>{return a=e.chapter_id,void fa({title:"Apakah anda yakin akan menghapus bab ini?",content:"Semua file akan ikut terhapus permanen",okText:"Ya, Hapus",cancelText:"Batal",okType:"danger",onOk(){P(a)}});var a}},"add_content")})],extra:s.jsx(f,{icon:s.jsx(de,{}),onClick:()=>(k(e),void o(!0)),children:"Tambah Materi"}),children:s.jsxs(i,{vertical:!0,gap:"small",children:[s.jsx(_,{defaultActiveKey:"1",items:[{label:"Capaian",key:"1",children:s.jsx("article",{dangerouslySetInnerHTML:(t=e.target,{__html:t})})},{label:"Materi",key:"2",children:s.jsx(ga,{contents:e.contents,chapterId:e.chapter_id})}]}),s.jsxs(n.Text,{children:[s.jsx("strong",{children:"Pengajar:"})," ",e.teacher_name]}),s.jsxs(he,{size:[0,8],wrap:!0,children:[s.jsx("strong",{style:{marginRight:5},children:"Kelas: "}),e.class?.map(e=>s.jsx(T,{color:"blue",children:e.name},e.id))]}),s.jsxs(he,{size:"middle",wrap:!0,style:{marginTop:16},children:[s.jsxs(n.Text,{type:"secondary",children:[s.jsx(xe,{})," ",e.content," Konten"]}),s.jsxs(n.Text,{type:"secondary",children:[s.jsx(ge,{})," ",e.file," File"]}),s.jsxs(n.Text,{type:"secondary",children:[s.jsx(sa,{})," ",e.video," Video"]})]})]})})},e.chapter_id);var t}):s.jsx(l,{span:24,style:{textAlign:"center",marginTop:"2rem"},children:s.jsx(re,{description:s.jsx(n.Text,{type:"secondary",children:`Bab untuk pelajaran ${e.replace(/-/g," ")} belum tersedia`})})})})]}),s.jsx(ja,{title:p?"Perbaiki Bab":"Tambah Bab baru",open:h,onClose:()=>{k(""),x(!1),m(!1)},chapter:g}),s.jsx(la,{title:`Tambah Materi ${g.chapter_name}`,open:c,onClose:()=>{k(""),o(!1)},chapterid:g.chapter_id})]})};je.locale("id");const{Text:ka}=n,ya={Hadir:"#52c41a",Telat:"#faad14",Sakit:"#1677ff",Izin:"#722ed1",Alpa:"#f5222d"},wa=({classid:e,subjectid:a})=>{const[t,i]=Z.useState({current:1,pageSize:10}),[n,c]=Z.useState(""),[o,h]=Z.useState(je()),[m,p]=Z.useState([]),x=o.format("YYYY-MM-DD"),{data:g,isLoading:j,isFetching:b}=N({page:t.current,limit:t.pageSize,search:n,classid:e},{skip:!e}),{data:k}=P({classid:e,subjectid:a,date:x},{skip:!e||!a});console.log(k);const[y]=L(),[w]=M(),[v]=F(),[S]=z(),{students:C,totalData:_}=g||{},T=m.length>0;Z.useEffect(()=>{p([])},[o,e,a]);const B=async(e,a,t,s)=>{const i="apiCall";u.loading({content:a,key:i});try{const a=await e.unwrap();return u.success({content:a.message||t,key:i}),!0}catch(n){return u.error({content:n.data?.message||s,key:i}),!1}},D=t=>{if(!T)return void u.warning("Pilih siswa terlebih dahulu.");B(w({classid:e,subjectid:a,studentids:m,note:t,date:x}),`Memproses ${t} untuk ${m.length} siswa...`,"Presensi massal berhasil","Gagal memproses presensi massal").then(e=>{e&&p([])})},R=[{title:"No",key:"no",width:"5%",render:(e,a,s)=>(t.current-1)*t.pageSize+s+1},{title:"Siswa",dataIndex:"student_name",key:"student",render:(e,a)=>s.jsxs(he,{children:[s.jsx(A,{icon:s.jsx(E,{})}),s.jsxs("div",{children:[s.jsx(ka,{strong:!0,children:e}),s.jsx("br",{}),s.jsxs(ka,{type:"secondary",children:["NIS: ",a.nis," | ",a.class_name]})]})]})},{title:"Status Presensi",key:"attendance",width:"40%",render:(t,i)=>{const n=k?.find(e=>e.studentid===i.student),r=n?.note,l=e=>r===e?{backgroundColor:ya[e],borderColor:ya[e],color:"#fff"}:{};return s.jsxs(ve.Group,{value:r,onChange:t=>{return s=i.student,n=t.target.value,void B(y({classid:e,subjectid:a,studentid:s,note:n,date:x}),"Menyimpan presensi...","Presensi berhasil disimpan","Gagal menyimpan presensi");var s,n},buttonStyle:"solid",size:"small",block:!0,children:[s.jsx(ve.Button,{value:"Hadir",style:l("Hadir"),children:"Hadir"}),s.jsx(ve.Button,{value:"Telat",style:l("Telat"),children:"Telat"}),s.jsx(ve.Button,{value:"Sakit",style:l("Sakit"),children:"Sakit"}),s.jsx(ve.Button,{value:"Izin",style:l("Izin"),children:"Izin"}),s.jsx(ve.Button,{value:"Alpa",style:l("Alpa"),children:"Alpa"})]})}},{title:"Aksi",key:"action",align:"center",render:(t,i)=>s.jsx(oe,{title:"Hapus Presensi?",description:"Anda yakin ingin menghapus presensi siswa ini?",onConfirm:()=>{return t=i.student,void B(v({classid:e,subjectid:a,studentid:t,date:x}),"Menghapus presensi...","Presensi berhasil dihapus","Gagal menghapus presensi");var t},okText:"Ya",cancelText:"Tidak",children:s.jsx(f,{icon:s.jsx(ue,{}),type:"text",danger:!0})})}],O={selectedRowKeys:m,onChange:e=>p(e)};return e&&a?s.jsxs(d,{variant:"bordered",children:[s.jsxs(r,{gutter:[16,16],justify:"space-between",align:"middle",children:[s.jsx(l,{xs:24,md:8,children:s.jsxs(he,{direction:"vertical",children:[s.jsxs(ka,{strong:!0,children:[s.jsx(fe,{style:{marginRight:8}}),"Tanggal Presensi"]}),s.jsx(be,{value:o,onChange:e=>h(e||je()),format:"dddd, D MMMM YYYY",disabledDate:e=>e&&e>je().endOf("day"),style:{width:"100%"}})]})}),s.jsx(l,{xs:24,md:16,children:s.jsxs(he,{wrap:!0,style:{float:"right"},children:[s.jsxs(f,{onClick:()=>D("Hadir"),disabled:!T,icon:s.jsx(ke,{}),type:"primary",children:["Hadir (",m.length,")"]}),s.jsxs(f,{onClick:()=>D("Sakit"),disabled:!T,icon:s.jsx(ze,{}),children:["Sakit (",m.length,")"]}),s.jsxs(f,{onClick:()=>D("Izin"),disabled:!T,icon:s.jsx(I,{}),children:["Izin (",m.length,")"]}),s.jsxs(f,{onClick:()=>D("Alpa"),disabled:!T,icon:s.jsx(ye,{}),danger:!0,children:["Alpa (",m.length,")"]}),s.jsxs(f,{onClick:()=>{T?ae.confirm({title:`Hapus Presensi ${m.length} Siswa?`,content:"Apakah Anda yakin ingin menghapus data presensi untuk semua siswa yang dipilih pada tanggal ini?",okText:"Ya, Hapus",okType:"danger",cancelText:"Batal",onOk:()=>{B(S({classid:e,subjectid:a,studentids:m,date:x}),"Menghapus presensi massal...","Presensi massal berhasil dihapus","Gagal menghapus presensi massal").then(e=>{e&&p([])})}}):u.warning("Pilih siswa terlebih dahulu.")},disabled:!T,icon:s.jsx(ue,{}),danger:!0,type:"primary",children:["Hapus (",m.length,")"]})]})})]}),s.jsx(we,{style:{marginTop:24},rowSelection:O,columns:R,dataSource:C,rowKey:"student",loading:j||b,pagination:{...t,total:_,showSizeChanger:!0},onChange:e=>{i(e)},scroll:{x:!0}})]}):s.jsx(d,{children:s.jsx(re,{image:re.PRESENTED_IMAGE_SIMPLE,description:"Silakan pilih kelas dan mata pelajaran terlebih dahulu."})})};je.locale("id");const{Text:va,Title:Sa}=n,Ca=({classid:e,subjectid:a})=>{const[t,i]=Z.useState(je()),{data:n,isLoading:c,isError:o,error:u}=B({classid:e,subjectid:a,month:t?.format("YYYY-MM")},{skip:!e||!a||!t}),m=e=>{switch(e?.toLowerCase()){case"hadir":return"success";case"sakit":return"processing";case"izin":return"warning";case"alpa":return"error";default:return"default"}},p=(()=>{const e=[{title:"No",key:"index",width:60,fixed:"left",align:"center",render:(e,a,t)=>t+1},{title:"NIS",dataIndex:"nis",key:"nis",width:120,fixed:"left"},{title:"Nama Siswa",dataIndex:"student_name",key:"student_name",width:250,fixed:"left",render:e=>s.jsx(va,{strong:!0,children:e})}];if(!n?.dates||0===n.dates.length)return e;const a=n.dates.map(e=>{return{title:(a=e,a?je(a).format("D-MMM-YY"):"-"),dataIndex:e,key:e,align:"center",width:110,render:e=>s.jsx(T,{color:m(e),style:{minWidth:"70px",textAlign:"center"},children:e||"-"})};var a}),t={title:"Presentase %",dataIndex:"presentase",key:"presentase",width:120,fixed:"right",align:"center",render:e=>s.jsx(va,{strong:!0,children:null!=e?`${e}%`:"-"})};return[...e,...a,t]})();return o?s.jsx(re,{description:u?.data?.message||"Gagal memuat data."}):s.jsx(h,{spinning:c,tip:"Memuat data riwayat...",children:s.jsxs(d,{title:s.jsxs(he,{children:[s.jsx(Ee,{}),s.jsx(Sa,{level:5,style:{margin:0},children:"Riwayat Presensi"})]}),children:[s.jsx(r,{style:{marginBottom:24},children:s.jsx(l,{children:s.jsxs(he,{direction:"vertical",children:[s.jsxs(va,{strong:!0,children:[s.jsx(fe,{})," Filter Berdasarkan Bulan"]}),s.jsx(be,{picker:"month",value:t,onChange:e=>i(e),style:{width:250},allowClear:!1})]})})}),s.jsx(we,{columns:p,dataSource:n?.students,rowKey:"studentid",bordered:!0,pagination:{pageSize:10,showSizeChanger:!0},scroll:{x:"max-content"},locale:{emptyText:s.jsx(re,{image:s.jsx(Se,{style:{fontSize:48,color:"#bfbfbf"}}),description:!c&&n?.students?.length>0?`Tidak ada data presensi pada bulan ${t.format("MMMM YYYY")}`:"Belum ada siswa di kelas ini untuk periode aktif."})}})]})})},_a=()=>{const{user:e}=t(e=>e.auth),{data:a,isLoading:c}=k(),[o,u]=Z.useState(""),[h,m]=Z.useState(""),p=e?.subjects?.map(e=>({label:e.name,value:e.id})),x=a?.map(e=>({label:e.name,value:e.id})),g=[{label:"Presensi Harian",key:"1",children:s.jsx(wa,{classid:o,subjectid:h})},{label:"Riwayat Presensi",key:"2",children:s.jsx(Ca,{classid:o,subjectid:h})}];return s.jsxs(i,{vertical:!0,gap:"middle",children:[s.jsx(d,{hoverable:!0,title:"Managemen Kehadiran Siswa",children:s.jsxs(r,{gutter:[16,16],children:[s.jsx(l,{sm:24,md:12,children:s.jsx(le,{style:{width:"100%"},placeholder:"Pilih Mata Pelajran",allowClear:!0,options:p,onChange:e=>{m(e)},showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),s.jsx(l,{sm:24,md:12,children:s.jsx(le,{style:{width:"100%"},placeholder:"Pilih Kelas",allowClear:!0,options:x,onChange:e=>{u(e)},showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})})]})}),o&&h?s.jsx(_,{centered:!0,items:g}):s.jsx(re,{description:s.jsx(n.Text,{type:"secondary",children:"Silakan pilih mata pelajaran dan kelas terlebih dahulu untuk melihat data presensi"})})]})},{Text:Ta}=n,Na=({title:e,open:a,onClose:t,subject:i})=>{const[n]=c.useForm(),d=c.useWatch([],n),{data:o,isLoading:h}=D({subjectid:i.id},{skip:!i.id}),[m,{data:p,isLoading:x,isSuccess:g,error:j}]=R(),f=Z.useMemo(()=>{const{presensi:e=0,attitude:a=0,daily:t=0}=d||{};return e+a+t},[d]);return Z.useEffect(()=>{a&&n.resetFields()},[a]),Z.useEffect(()=>{o&&(n.setFieldsValue({presensi:o.presensi,attitude:o.attitude,daily:o.daily}),console.log(o))},[o]),Z.useEffect(()=>{g&&(u.success(p.message),t(),n.resetFields()),j&&u.error(j.data.message)},[p,g,j]),s.jsx(ae,{title:e,open:a,onCancel:t,destroyOnHidden:!0,okText:"Simpan",cancelText:"Tutup",onOk:()=>n.submit(),okButtonProps:{disabled:100!==f},loading:x||h,confirmLoading:x||h,children:s.jsxs(c,{form:n,layout:"vertical",onFinish:e=>{if(100!==f)return void ae.error({title:"Input Tidak Valid",content:"Total bobot nilai harus tepat 100%."});const a={subjectid:i.id,...e};m(a)},children:[s.jsx(Ta,{type:"secondary",children:"Pastikan total bobot dari semua komponen penilaian adalah 100%."}),s.jsx(O,{style:{marginTop:"12px"}}),s.jsxs(r,{gutter:16,children:[s.jsx(l,{span:12,children:s.jsx(c.Item,{name:"presensi",label:s.jsxs(he,{children:[s.jsx(Re,{}),"Bobot Nilai Kehadiran"]}),rules:[{required:!0,message:"Wajib diisi"}],children:s.jsx(Ce,{style:{width:"100%"},min:0,max:100,addonAfter:"%",placeholder:"e.g., 10"})})}),s.jsx(l,{span:12,children:s.jsx(c.Item,{name:"attitude",label:s.jsxs(he,{children:[s.jsx($e,{}),"Bobot Nilai Sikap"]}),rules:[{required:!0,message:"Wajib diisi"}],children:s.jsx(Ce,{style:{width:"100%"},min:0,max:100,addonAfter:"%",placeholder:"e.g., 20"})})})]}),s.jsx(r,{gutter:16,children:s.jsx(l,{span:12,children:s.jsx(c.Item,{name:"daily",label:s.jsxs(he,{children:[s.jsx(_e,{}),"Bobot Nilai Harian"]}),tooltip:"Nilai rerata dari sumatif dan formatif",rules:[{required:!0,message:"Wajib diisi"}],children:s.jsx(Ce,{style:{width:"100%"},min:0,max:100,addonAfter:"%",placeholder:"e.g., 40"})})})}),s.jsx(O,{}),100===f?s.jsx(Te,{message:s.jsxs(Ta,{strong:!0,children:["Total Bobot: ",f,"%"]}),description:"Total bobot sudah sesuai.",type:"success",showIcon:!0}):s.jsx(Te,{message:s.jsxs(Ta,{strong:!0,children:["Total Bobot: ",f,"%"]}),description:"Total bobot harus tepat 100% untuk dapat menyimpan.",type:"warning",showIcon:!0})]})})},{Meta:Pa}=d,La=()=>{const[e,a]=Z.useState(!1),[c,o]=Z.useState(""),[u,h]=X(),{user:m}=t(e=>e.auth),p=m?.subjects;return s.jsxs(i,{vertical:!0,gap:"middle",children:[s.jsx(n.Title,{level:5,children:"Pilih Mata Pelajaran Untuk Penilaian"}),s.jsx(r,{gutter:[16,16],children:p?.map(e=>s.jsx(l,{sm:24,md:12,lg:6,children:s.jsx(d,{hoverable:!0,cover:s.jsx("img",{src:e.cover?e.cover:"/logo.png",alt:e.name}),actions:[s.jsx(j,{title:"Penilaian",children:s.jsx(ge,{onClick:()=>(e=>{h({mode:"scoring",name:e.name?.replace(/\s+/g,"-"),subjectid:e.id})})(e)})},"scoring"),s.jsx(j,{title:"Pembobotan",children:s.jsx(Ke,{onClick:()=>(e=>{o(e),a(!0)})(e)})},"setting")],children:s.jsx(Pa,{title:e.name})})},e.id))}),s.jsx(Na,{title:`Pembobotan Nilai ${c?.name}`,open:e,onClose:()=>{o(""),a(!1)},subject:c})]})},{Dragger:Ma}=te,Fa=({title:e,open:a,onCancel:t,onUpload:i,isLoading:n})=>{const[r,l]=Z.useState(null),[d,c]=Z.useState([]),[o,h]=Z.useState([]),[m,p]=Z.useState([]);Z.useEffect(()=>{a||(l(null),c([]),h([]),p([]))},[a]);const x={name:"file",multiple:!1,accept:".xlsx, .xls",fileList:r?[r]:[],beforeUpload:e=>{l(e);const a=new FileReader;return a.onload=e=>{try{const a=new Uint8Array(e.target.result),t=Ne(a,{type:"array"}),s=t.SheetNames[0],i=t.Sheets[s],n=Pe.sheet_to_json(i,{header:1});if(n.length>1){const e=n[0],a=n.slice(1).filter(e=>null!==e[0]&&void 0!==e[0]&&""!==String(e[0]).trim());c(a);const t=e.map((e,a)=>({title:e,dataIndex:a,key:a,width:1===a?250:120}));h(t);const s=a.map((e,a)=>{const t={key:a};return e.forEach((e,a)=>{t[a]=e}),t});p(s),u.success(`Berhasil membaca ${a.length} baris data dari file.`)}else u.warn("File excel tidak memiliki data untuk ditampilkan."),c([]),h([]),p([])}catch(a){u.error("Terjadi kesalahan saat membaca file."),console.error("File read error:",a)}},a.readAsArrayBuffer(e),!1},onRemove:()=>{l(null),c([]),h([]),p([])}};return s.jsxs(ae,{title:e,open:a,onCancel:t,width:1e3,confirmLoading:n,footer:[s.jsx(f,{onClick:t,children:"Batal"},"back"),s.jsx(f,{type:"primary",loading:n,onClick:()=>{d.length>0?i(d):u.error("Tidak ada data untuk diunggah. Silakan pilih file yang valid.")},disabled:0===d.length,icon:s.jsx(Ze,{}),children:"Upload Data"},"submit")],children:[s.jsxs(Ma,{...x,style:{marginBottom:20},children:[s.jsx("p",{className:"ant-upload-drag-icon",children:s.jsx(se,{})}),s.jsx("p",{className:"ant-upload-text",children:"Klik atau seret file ke area ini untuk mengunggah"}),s.jsx("p",{className:"ant-upload-hint",children:"Gunakan template yang disediakan dan pastikan file dalam format .xlsx"})]}),m.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(Te,{message:`Pratinjau Data: Ditemukan ${m.length} baris data yang akan diunggah.`,type:"info",showIcon:!0,style:{marginBottom:16}}),s.jsx(we,{columns:o,dataSource:m,bordered:!0,size:"small",pagination:{pageSize:5},scroll:{y:240,x:"max-content"}})]})]})},za=({students:e,totalData:a,page:i,limit:n,setPage:r,setLimit:l,isLoading:c})=>{const[o,h]=Z.useState({}),[p,x]=Z.useState(!1),{user:g}=t(e=>e.auth),j=g?.id,[b]=X(),k=b.get("subjectid"),y=b.get("chapter"),w=b.get("class"),v=b.get("month"),S=b.get("semester"),{data:C,refetch:_}=H({classid:w,subjectid:k,chapterid:y,month:v,semester:S},{skip:!(w&&k&&y&&v&&S),refetchOnMountOrArgChange:!0}),[T,{isLoading:N}]=K(),[P,{isLoading:L,data:M,error:F,isSuccess:z,reset:I}]=Y();Z.useEffect(()=>{h({})},[w,k,y,v,S]),Z.useEffect(()=>{if(C&&Array.isArray(C)){const e=C.reduce((e,a)=>(e[a.student_id]={kinerja:a.kinerja??"",kedisiplinan:a.kedisiplinan??"",keaktifan:a.keaktifan??"",percayaDiri:a.percaya_diri??"",catatan:a.catatan_guru??""},e),{});Object.keys(e).length>0&&h(e)}},[C]),Z.useEffect(()=>{z&&(u.success(M.message),I(),x(!1)),F&&(u.error(F.data.message),I())},[M,F,z]);const A=(e,a,t)=>{h(s=>({...s,[e]:{...s[e],[a]:t}}))},E=e=>{const a=o[e];if(!a)return 0;const t=[a.kinerja,a.kedisiplinan,a.keaktifan,a.percayaDiri].filter(e=>""!==e&&null!=e);return 0===t.length?0:(t.reduce((e,a)=>e+Number(a),0)/t.length).toFixed(1)},B=[{title:"No",key:"index",render:(e,a,t)=>(i-1)*n+t+1,width:60,fixed:"left"},{title:"NIS",dataIndex:"nis",key:"nis",width:120,fixed:"left"},{title:"Nama Siswa",dataIndex:"student_name",key:"student_name",width:200,fixed:"left"},{title:"Kinerja",key:"kinerja",width:120,render:(e,a)=>s.jsx(m,{type:"number",min:0,max:100,value:o[a.student]?.kinerja??"",onChange:e=>A(a.student,"kinerja",e.target.value),placeholder:"0-100"})},{title:"Kedisiplinan",key:"kedisiplinan",width:120,render:(e,a)=>s.jsx(m,{type:"number",min:0,max:100,value:o[a.student]?.kedisiplinan??"",onChange:e=>A(a.student,"kedisiplinan",e.target.value),placeholder:"0-100"})},{title:"Keaktifan",key:"keaktifan",width:120,render:(e,a)=>s.jsx(m,{type:"number",min:0,max:100,value:o[a.student]?.keaktifan??"",onChange:e=>A(a.student,"keaktifan",e.target.value),placeholder:"0-100"})},{title:"Percaya Diri",key:"percayaDiri",width:120,render:(e,a)=>s.jsx(m,{type:"number",min:0,max:100,value:o[a.student]?.percayaDiri??"",onChange:e=>A(a.student,"percayaDiri",e.target.value),placeholder:"0-100"})},{title:"Catatan Guru",key:"catatan",width:250,render:(e,a)=>s.jsx(m.TextArea,{rows:3,value:o[a.student]?.catatan||"",onChange:e=>A(a.student,"catatan",e.target.value),placeholder:"Catatan..."})},{title:"Rerata",key:"average",width:100,render:(e,a)=>s.jsx("strong",{children:E(a.student)})},{title:"Aksi",key:"action",width:100,fixed:"right",render:(e,a)=>s.jsx(f,{type:"primary",size:"small",onClick:()=>(async e=>{const a=e.student,t=o[a]||{},s={student_id:a,subject_id:Number(k),class_id:Number(w),chapter_id:Number(y),teacher_id:j,month:v,semester:S,kinerja:t.kinerja?Number(t.kinerja):null,kedisiplinan:t.kedisiplinan?Number(t.kedisiplinan):null,keaktifan:t.keaktifan?Number(t.keaktifan):null,percaya_diri:t.percayaDiri?Number(t.percayaDiri):null,catatan_guru:t.catatan||null};try{const e=await T(s).unwrap();u.success(e.message||"Nilai berhasil disimpan!"),_()}catch(i){u.error(i.data?.message||"Gagal menyimpan nilai.")}})(a),loading:N,children:"Simpan"})}];return s.jsxs(d,{title:"Penilaian Sikap",extra:s.jsxs(he,{children:[s.jsx(f,{icon:s.jsx(Ze,{}),onClick:()=>x(!0),children:"Upload Nilai"}),s.jsx(f,{icon:s.jsx(ne,{}),onClick:()=>{const a=[["NIS","Nama Siswa","Kinerja","Kedisiplinan","Keaktifan","Percaya Diri","Catatan","Rerata"]];e&&e.forEach(e=>{a.push([e.nis||"",e.student_name||"","","","","","",""])});const t=Pe.book_new(),s=Pe.aoa_to_sheet(a);s["!cols"]=[{wch:15},{wch:30},{wch:12},{wch:15},{wch:12},{wch:15},{wch:40},{wch:12}],Pe.book_append_sheet(t,s,"Penilaian Sikap");Le(t,"template_penilaian_sikap.xlsx"),u.success("Template berhasil diunduh!")},type:"primary",children:"Download Template"})]}),children:[s.jsx(we,{columns:B,dataSource:e,rowKey:"id",bordered:!0,loading:c,pagination:{current:i,pageSize:n,total:a,showSizeChanger:!0},onChange:e=>{r(e.current),l(e.pageSize)},scroll:{x:1500}}),s.jsx(Fa,{title:"Upload Nilai Sikap (Bulk)",open:p,onCancel:()=>x(!1),onUpload:async e=>{if(!e||0===e.length)return void u.error("Tidak ada data untuk diunggah.");const a={classid:Number(w),subjectid:Number(k),chapterid:Number(y),month:v,semester:S,data:e};try{await P(a).unwrap(),u.success("Data nilai berhasil di-upload!"),x(!1),_()}catch(t){u.error(t.data?.message||"Gagal mengupload file.")}},isLoading:L})]})},Ia=({students:e,totalData:a,page:i,limit:n,setPage:r,setLimit:l,isLoading:c})=>{const[o,h]=Z.useState({}),[p,x]=Z.useState(!1),{user:g}=t(e=>e.auth),j=g?.id,[b]=X(),k=b.get("subjectid"),y=b.get("chapter"),w=b.get("class"),v=b.get("month"),S=b.get("semester"),{data:C,refetch:_}=V({classid:w,subjectid:k,chapterid:y,month:v,semester:S},{skip:!(w&&k&&y&&v&&S),refetchOnMountOrArgChange:!0}),[T,{isLoading:N}]=$(),[P,{isLoading:L,data:M,error:F,isSuccess:z,reset:I}]=U();Z.useEffect(()=>{if(C&&Array.isArray(C)){const e=C.reduce((e,a)=>(e[a.student_id]={f_1:a.f_1??"",f_2:a.f_2??"",f_3:a.f_3??"",f_4:a.f_4??"",f_5:a.f_5??"",f_6:a.f_6??"",f_7:a.f_7??"",f_8:a.f_8??""},e),{});h(e)}},[C]),Z.useEffect(()=>{z&&(u.success(M.message),I(),x(!1)),F&&(u.error(F.data.message),I())},[M,F,z]);const A=e=>{const a=o[e];if(!a)return 0;const t=Object.values(a).filter(e=>""!==e&&null!=e);return 0===t.length?0:(t.reduce((e,a)=>e+Number(a),0)/t.length).toFixed(1)},E=[...[{title:"No",key:"index",render:(e,a,t)=>(i-1)*n+t+1,width:60,fixed:"left"},{title:"NIS",dataIndex:"nis",key:"nis",width:120,fixed:"left"},{title:"Nama Siswa",dataIndex:"student_name",key:"student_name",width:200,fixed:"left"}],...Array.from({length:8},(e,a)=>{const t=a+1;return{title:`f_${t}`,key:`f_${t}`,width:100,render:(e,a)=>s.jsx(m,{type:"number",min:0,max:100,style:{textAlign:"center"},placeholder:"0-100",value:o[a.student]?.[`f_${t}`]??"",onChange:e=>((e,a,t)=>{h(s=>({...s,[e]:{...s[e],[`f_${a}`]:t}}))})(a.student,t,e.target.value)})}}),...[{title:"Rerata",key:"average",width:80,fixed:"right",render:(e,a)=>s.jsx("strong",{children:A(a.student)})},{title:"Aksi",key:"action",width:100,fixed:"right",render:(e,a)=>s.jsx(f,{type:"primary",size:"small",onClick:()=>(async e=>{const a=e.student,t=o[a]||{},s={student_id:a,subject_id:Number(k),class_id:Number(w),chapter_id:Number(y),teacher_id:j,month:v,semester:S,F_1:t.f_1?Number(t.f_1):null,F_2:t.f_2?Number(t.f_2):null,F_3:t.f_3?Number(t.f_3):null,F_4:t.f_4?Number(t.f_4):null,F_5:t.f_5?Number(t.f_5):null,F_6:t.f_6?Number(t.f_6):null,F_7:t.f_7?Number(t.f_7):null,F_8:t.f_8?Number(t.f_8):null};T(s)})(a),loading:N,children:"Simpan"})}]];return s.jsxs(d,{title:"Penilaian Formatif",extra:s.jsxs(he,{children:[s.jsx(f,{icon:s.jsx(Ze,{}),onClick:()=>x(!0),children:"Upload Nilai"}),s.jsx(f,{icon:s.jsx(ne,{}),onClick:()=>{const a=["NIS","Nama Siswa"];for(let e=1;e<=8;e++)a.push(`F_${e}`);a.push("Rerata");const t=[a];e&&e.forEach(e=>{const a=[e.nis||"",e.student_name||""];for(let t=1;t<=10;t++)a.push("");t.push(a)});const s=Pe.book_new(),i=Pe.aoa_to_sheet(t);i["!cols"]=[{wch:15},{wch:30},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:10}],Pe.book_append_sheet(s,i,"Penilaian Formatif"),Le(s,"template_penilaian_formatif.xlsx"),u.success("Template berhasil diunduh!")},type:"primary",children:"Download Template"})]}),children:[s.jsx(we,{columns:E,dataSource:e,rowKey:"id",bordered:!0,loading:c,pagination:{current:i,pageSize:n,total:a,showSizeChanger:!0},onChange:e=>{r(e.current),l(e.pageSize)},scroll:{x:1500}}),s.jsx(Fa,{title:"Upload Nilai Formatif (Bulk)",open:p,onCancel:()=>x(!1),onUpload:async e=>{const a={classid:Number(w),subjectid:Number(k),chapterid:Number(y),month:v,semester:S,data:e};P(a)},isLoading:L})]})},Aa=({students:e,totalData:a,page:i,limit:n,setPage:r,setLimit:l,isLoading:c})=>{const[o,h]=Z.useState({}),[p,x]=Z.useState(!1),{user:g}=t(e=>e.auth),j=g?.id,[b]=X(),k=b.get("subjectid"),y=b.get("chapter"),w=b.get("class"),v=b.get("month"),S=b.get("semester"),{data:C,refetch:_}=G({classid:w,subjectid:k,chapterid:y,month:v,semester:S},{skip:!(w&&k&&y&&v&&S),refetchOnMountOrArgChange:!0}),[T,{isLoading:N}]=q(),[P,{isLoading:L,isSuccess:M,data:F,error:z,reset:I}]=J(),A=e=>{const a=o[e];if(!a)return 0;const t=Object.values(a).filter(e=>""!==e&&null!=e);return 0===t.length?0:(t.reduce((e,a)=>e+Number(a),0)/t.length).toFixed(1)};Z.useEffect(()=>{if(C&&Array.isArray(C)){const e=C.reduce((e,a)=>(e[a.student_id]={oral:a.oral??"",written:a.written??"",project:a.project??"",performance:a.performance??""},e),{});h(e)}},[C]);Z.useEffect(()=>{M&&(u.success(F.message),I(),x(!1)),z&&(u.error(z.data.message),I())},[F,z,M]);const E=[{title:"No",key:"index",render:(e,a,t)=>(i-1)*n+t+1,width:60,fixed:"left"},{title:"NIS",dataIndex:"nis",key:"nis",width:120,fixed:"left"},{title:"Nama Siswa",dataIndex:"student_name",key:"student_name",width:250,fixed:"left"},...[{title:"Lisan",key:"oral"},{title:"Tulis",key:"written"},{title:"Proyek",key:"project"},{title:"Keterampilan",key:"performance"}].map(e=>({title:e.title,key:e.key,width:120,render:(a,t)=>s.jsx(m,{type:"number",min:0,max:100,placeholder:"0-100",value:o[t.student]?.[e.key]??"",onChange:a=>{return s=t.student,i=e.key,n=a.target.value,void h(e=>({...e,[s]:{...e[s],[i]:n}}));var s,i,n}})})),{title:"Rata2",key:"average",width:100,render:(e,a)=>s.jsx("strong",{children:A(a.student)})},{title:"Aksi",key:"action",width:100,fixed:"right",render:(e,a)=>s.jsx(f,{type:"primary",size:"small",onClick:()=>(async e=>{const a=e.student,t=o[a]||{},s={student_id:a,subject_id:Number(k),class_id:Number(w),chapter_id:Number(y),teacher_id:j,month:v,semester:S,oral:t.oral?Number(t.oral):null,written:t.written?Number(t.written):null,project:t.project?Number(t.project):null,performance:t.performance?Number(t.performance):null};try{const e=await T(s).unwrap();u.success(e.message||"Nilai berhasil disimpan!"),_()}catch(i){u.error(i.data?.message||"Gagal menyimpan nilai.")}})(a),loading:N,children:"Simpan"})}];return s.jsxs(d,{title:"Penilaian Sumatif",extra:s.jsxs(he,{children:[s.jsx(f,{icon:s.jsx(Ze,{}),onClick:()=>x(!0),children:"Upload Nilai"}),s.jsx(f,{icon:s.jsx(ne,{}),onClick:()=>{const a=[["NIS","Nama Siswa","Lisan","Tulis","Proyek","Keterampilan","Rata2"]];e&&e.forEach(e=>{a.push([e.nis||"",e.student_name||"","","","","",""])});const t=Pe.book_new(),s=Pe.aoa_to_sheet(a);s["!cols"]=[{wch:15},{wch:30},{wch:12},{wch:12},{wch:12},{wch:12},{wch:12}],Pe.book_append_sheet(t,s,"Penilaian Sumatif"),Le(t,"template_penilaian_sumatif.xlsx"),u.success("Template berhasil diunduh!")},type:"primary",children:"Download Template"})]}),children:[s.jsx(we,{columns:E,dataSource:e,rowKey:"id",bordered:!0,loading:c,pagination:{current:i,pageSize:n,total:a,showSizeChanger:!0},onChange:e=>{r(e.current),l(e.pageSize)},scroll:{x:1200}}),s.jsx(Fa,{title:"Upload Nilai Sumatif (Bulk)",open:p,onCancel:()=>x(!1),onUpload:async e=>{const a={classid:Number(w),subjectid:Number(k),chapterid:Number(y),month:v,semester:S,data:e};P(a)},isLoading:L})]})},{Title:Ea,Text:Ba}=n,{Search:Da}=m,Ra=({data:e})=>{if(!e?.results?.[0])return null;const a=e.results[0];return s.jsx(d,{size:"small",children:s.jsxs(i,{justify:"space-between",wrap:"wrap",children:[s.jsxs(i,{vertical:!0,children:[s.jsx(Ba,{strong:!0,children:"Mata Pelajaran"}),s.jsx(Ba,{children:a.subject_name})]}),s.jsxs(i,{vertical:!0,children:[s.jsx(Ba,{strong:!0,children:"Chapter"}),s.jsx(Ba,{children:a.chapter_name})]}),s.jsxs(i,{vertical:!0,children:[s.jsx(Ba,{strong:!0,children:"Kelas"}),s.jsx(Ba,{children:a.class_name})]}),s.jsxs(i,{vertical:!0,children:[s.jsx(Ba,{strong:!0,children:"Guru Pengampu"}),s.jsx(Ba,{children:a.teacher_name})]})]})})},Oa=()=>{const[e,a]=Z.useState(1),[t,n]=Z.useState(10),[r,l]=Z.useState(""),[c,o]=Z.useState(r),[u]=X(),m=u.get("month"),p=u.get("chapter"),x=u.get("class"),{data:g,isLoading:j,isError:b,refetch:k}=W({page:e,limit:t,search:c,month:m,chapterid:p,classid:x});Z.useEffect(()=>{const e=setTimeout(()=>{o(r),a(1)},500);return()=>{clearTimeout(e)}},[r]);const y=[{title:"No",key:"no",render:(a,s,i)=>(e-1)*t+i+1,width:50},{title:"Nama Siswa",dataIndex:"student_name",key:"student_name",sorter:(e,a)=>e.student_name.localeCompare(a.student_name)},{title:"Kehadiran",dataIndex:"attendance",key:"attendance",align:"center",sorter:(e,a)=>e.attendance-a.attendance},{title:"Sikap",dataIndex:"attitude",key:"attitude",align:"center",sorter:(e,a)=>e.attitude-a.attitude},{title:"Harian",dataIndex:"daily",key:"daily",align:"center",sorter:(e,a)=>e.daily-a.daily},{title:"Nilai Akhir",dataIndex:"final_score",key:"final_score",align:"center",sorter:(e,a)=>e.final_score-a.final_score,render:e=>s.jsx(Ba,{strong:!0,children:e})}];return m&&p&&x?s.jsxs(i,{vertical:!0,gap:"large",children:[s.jsx(Te,{showIcon:!0,type:"info",message:"Informasi Rekapitulasi",description:"Data yang ditampilkan adalah nilai yang sudah dibobotkan berdasarkan pengaturan yang telah ditentukan sebelumnya."}),s.jsx(d,{children:s.jsxs(i,{vertical:!0,gap:"middle",children:[s.jsx(Ra,{data:g}),s.jsxs(i,{justify:"space-between",children:[s.jsx(Da,{placeholder:"Cari nama siswa...",value:r,onChange:e=>l(e.target.value),style:{maxWidth:300},allowClear:!0}),s.jsx(f,{icon:s.jsx(qe,{}),onClick:k,color:"cyan",variant:"solid",children:"Sinkron Data"})]}),s.jsx(h,{spinning:j,children:s.jsx(we,{columns:y,dataSource:g?.results,rowKey:"student_id",pagination:{current:e,pageSize:t,total:g?.totalData,showSizeChanger:!0,pageSizeOptions:["10","20","50"]},onChange:e=>{a(e.current),n(e.pageSize)},bordered:!0,scroll:{x:"max-content"}})})]})})]}):s.jsx(Te,{message:"Parameter Tidak Lengkap",description:"Harap pilih Bulan, Chapter, dan Kelas terlebih dahulu untuk melihat rekapitulasi nilai.",type:"warning",showIcon:!0})},{Search:Ha}=m,Ka=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],Ya=[{label:"Semester 1",value:1},{label:"Semester 2",value:2}],Va=({name:e,id:a})=>{const t=Q(),[d,c]=X(),{data:o,isLoading:u}=w(a),[h,m]=Z.useState(1),[p,x]=Z.useState(10),[g,j]=Z.useState(""),b=d.get("semester"),k=d.get("month"),y=d.get("chapter"),v=d.get("class"),T=d.get("subjectid"),{data:P,isLoading:L}=N({page:h,limit:p,search:g,classid:v},{skip:!v}),M=Z.useMemo(()=>Ka.map(e=>({value:e,label:e})),[]),F=Z.useMemo(()=>Ya.map(e=>({value:e.value,label:e.label})),[]),z=Z.useMemo(()=>o?.map(e=>({value:e.chapter_id,label:e.chapter_name}))||[],[o]),I=Z.useMemo(()=>{if(!y)return[];const e=o?.find(e=>String(e.chapter_id)===String(y));return e?.class?.map(e=>({value:e.id,label:e.name}))||[]},[o,y]),A=(e,a)=>{const t=new URLSearchParams(d);a?t.set(e,a):t.delete(e),"chapter"===e&&t.delete("class"),m(1),c(t)},E=[{label:"Kehadiran",key:"1",children:s.jsx(Ca,{classid:v,subjectid:T})},{label:"Sikap",key:"2",children:s.jsx(za,{students:P?.students,totalData:P?.totalData,page:h,limit:p,search:g,setPage:m,setLimit:x,setSearch:j,isLoading:L})},{label:"Formatif",key:"3",children:s.jsx(Ia,{students:P?.students,totalData:P?.totalData,page:h,limit:p,search:g,setPage:m,setLimit:x,setSearch:j,isLoading:L})},{label:"Sumatif",key:"4",children:s.jsx(Aa,{students:P?.students,totalData:P?.totalData,page:h,limit:p,search:g,setPage:m,setLimit:x,setSearch:j,isLoading:L})},{label:"Rekap",key:"5",children:s.jsx(Oa,{})}],B=b&&k&&y&&v;return s.jsx(S,{title:`Pelajaran ${e.replace(/-/g," ")}`,levels:["teacher"],children:s.jsxs(i,{vertical:!0,gap:"middle",children:[s.jsxs(he,{children:[s.jsx(f,{shape:"circle",icon:s.jsx(C,{}),onClick:()=>t("/learning-management-system")}),s.jsx(n.Title,{style:{margin:0},level:5,children:`Penilaian ${e.replace(/-/g," ")}`})]}),s.jsxs(r,{gutter:[10,10],children:[s.jsx(l,{sm:24,md:6,children:s.jsx(le,{style:{width:"100%"},placeholder:"Pilih Semester",options:F,allowClear:!0,value:b?Number(b):null,onChange:e=>A("semester",e),showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),s.jsx(l,{sm:24,md:6,children:s.jsx(le,{style:{width:"100%"},placeholder:"Pilih Bulan",options:M,allowClear:!0,value:k,onChange:e=>A("month",e),showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),s.jsx(l,{sm:24,md:6,children:s.jsx(le,{style:{width:"100%"},placeholder:"Pilih Chapter",options:z,allowClear:!0,loading:u,value:y?Number(y):null,onChange:e=>A("chapter",e),showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),s.jsx(l,{sm:24,md:6,children:s.jsx(le,{style:{width:"100%"},placeholder:"Pilih Kelas",options:I,allowClear:!0,disabled:!y,value:v?Number(v):null,onChange:e=>A("class",e),showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})})]}),B?s.jsxs(s.Fragment,{children:[s.jsx(Ha,{placeholder:"Cari nama siswa...",onSearch:e=>{j(e),m(1)},enterButton:!0,allowClear:!0}),s.jsx(_,{centered:!0,items:E})]}):s.jsx(re,{description:"Pilih Semester, bulan, chapter dan kelas terlebih dahulu"})]})})},$a=()=>{const[e]=X(),a=e.get("name"),t=e.get("subjectid"),i=e.get("mode"),n=[{label:"Absen",key:"1",children:s.jsx(_a,{})},{label:"Mata Pelajaran",key:"2",children:s.jsx(na,{})},{label:"Penilaian",key:"3",children:s.jsx(La,{})}];return"lms"===i?s.jsx(ba,{name:a,id:t}):"scoring"===i?s.jsx(Va,{name:a,id:t}):s.jsx(S,{title:"Learning Management System",levels:["teacher"],children:s.jsx(_,{defaultActiveKey:"1",items:n,centered:!0})})};export{$a as default};
//# sourceMappingURL=LmsControl-hmODdVxD.js.map
