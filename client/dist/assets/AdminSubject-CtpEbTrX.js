import{S as e,j as a,c as s,H as t,T as l}from"./index-Dm8HVZNu.js";import{b as n,u as r}from"./vendor-BB4zGQ0b.js";import{L as i}from"./Layout-CwD1TcOu.js";import{T as c}from"./Table-P-or3_xw.js";const d=({detail:t,setDetail:l})=>{const[r,i]=n.useState(""),[c,d]=n.useState(""),[o,m]=n.useState(null),u=n.useRef(null),[x,{isSuccess:h,isLoading:j,isError:p,reset:g}]=e();return n.useEffect((()=>{t&&(i(t.id),d(t.name))}),[t]),n.useEffect((()=>{(h||p)&&(g(),l({}),i(""),d(""),u.current&&(u.current.value=null))}),[h,p]),a.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!c)return s.error("Lengkapi data");const a=new FormData;a.append("id",r||""),a.append("name",c),a.append("cover",o),s.promise(x(a).unwrap().then((e=>e.message)),{loading:"Meyimpan data...",success:e=>e,error:e=>e.data.message})},className:"rounded border p-2 bg-white d-flex flex-column gap-2",children:[a.jsx("p",{className:"m-0 h6",children:"Mata Pelajaran"}),a.jsx("input",{type:"text",name:"name",id:"name",className:"form-control",placeholder:"Nama Mata Pelajaran",value:c||"",onChange:e=>d(e.target.value)}),a.jsxs("div",{className:"input-group",children:[a.jsx("input",{type:"file",className:"form-control",id:"inputGroupFile02",ref:u,onChange:e=>m(e.target.files[0])}),a.jsx("label",{className:"input-group-text",htmlFor:"inputGroupFile02",children:"Cover"})]}),a.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-sm btn-warning",onClick:()=>{l({}),i(""),d(""),u.current&&(u.current.value=null)},children:"Batal"}),a.jsx("button",{type:"submit",className:"btn btn-sm btn-success",disabled:j,children:"Simpan"})]})]})},o=({setDetail:e})=>{const i=r(),[d,o]=n.useState(1),[m,u]=n.useState(10),[x,h]=n.useState(""),{data:j={},isLoading:p}=t({page:d,limit:m,search:x}),{totalData:g,totalPages:b,subjects:N=[]}=j,[f,{isSuccess:v,isLoading:S,isError:y,reset:w}]=l();return n.useEffect((()=>{(v||y)&&w()}),[v,y]),a.jsx(c,{page:d,setPage:o,setLimit:u,setSearch:h,totalData:g,totalPages:b,isLoading:p,children:a.jsxs("table",{className:"table table-bordered table-hover",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-center",children:"No"}),a.jsx("th",{className:"text-center",children:"Cover"}),a.jsx("th",{className:"text-center",children:"Mata Pelajaran"}),a.jsx("th",{className:"text-center",children:"Guru Pengampu"}),a.jsx("th",{className:"text-center",children:"Aksi"})]})}),a.jsx("tbody",{children:(null==N?void 0:N.length)>0?null==N?void 0:N.map(((t,l)=>a.jsxs("tr",{children:[a.jsx("td",{className:"text-center align-middle",children:(d-1)*m+l+1}),a.jsx("td",{className:"text-center align-middle",children:a.jsx("img",{src:t.cover?`${window.location.origin}${t.cover}`:"/logo.png",alt:`cover-${t.name}`,width:65,height:80,className:"overflow-hidden rounded",style:{objectFit:"cover"}})}),a.jsx("td",{className:"align-middle",children:t.name}),a.jsx("td",{className:"align-middle d-flex flex-column gap-2",children:t.teachers.map(((e,s)=>{var t,l;return a.jsxs("div",{className:"d-flex flex-column",children:[a.jsxs("p",{className:"m-0",children:[e.name," ",a.jsx("span",{className:"text-secondary",children:`(${(null==(t=e.class)?void 0:t.length)>0?null==(l=e.class)?void 0:l.map((e=>e.name)).join(", "):"Data belum tersedia"})`})]}),a.jsxs("div",{className:"d-flex gap-2 text-secondary",children:[a.jsxs("p",{className:"m-0",children:[e.chapters," Chapter"]}),a.jsxs("p",{className:"m-0",children:[e.contents," Materi"]})]})]},s)}))}),a.jsx("td",{className:"text-cente align-middle",children:a.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>((e,a)=>{const s=e.replace(/\s+/g,"-");i(`/pelajaran/${s}/${a}`)})(t.name,t.id),children:a.jsx("i",{className:"bi bi-three-dots-vertical"})}),a.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>e(t),children:a.jsx("i",{className:"bi bi-pencil-square"})}),a.jsx("button",{className:"btn btn-sm btn-danger",disabled:S,onClick:()=>{return e=t.id,void s.promise(f(e).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message});var e},children:a.jsx("i",{className:"bi bi-folder-minus"})})]})})]},l))):a.jsx("tr",{children:a.jsx("td",{colSpan:5,children:"Data tidak tersedia"})})})]})})},m=()=>{const[e,s]=n.useState({});return a.jsx(i,{title:"Mata Pelajaran",levels:["admin"],children:a.jsxs("div",{className:"row g-2",children:[a.jsx("div",{className:"col-lg-3 col-12",children:a.jsx(d,{detail:e,setDetail:s})}),a.jsx("div",{className:"col-lg-9 col-12",children:a.jsx(o,{setDetail:s})})]})})};export{m as default};
//# sourceMappingURL=AdminSubject-CtpEbTrX.js.map
