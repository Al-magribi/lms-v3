import{bH as e,j as s,V as a,bI as t,bJ as n,bK as i,bL as r}from"./index-DFhdulld.js";import{b as l}from"./vendor-CnnDPxwB.js";import{L as c}from"./Layout-GZnRoUIy.js";import{T as d}from"./Table-CpyGbvYh.js";import"./index-B8CuzAwO.js";import"./index-g0LoU_Ie.js";const o=({category:t,setCategory:n})=>{const[i,r]=l.useState(""),[c,d]=l.useState(""),[o,{isLoading:m,isSuccess:u,isError:x,reset:h}]=e(),b=()=>{n({}),r(""),d("")};return l.useEffect((()=>{(u||x)&&(b(),h())}),[u,x]),l.useEffect((()=>{t&&(r(t.id),d(t.name))}),[t]),s.jsxs("form",{onSubmit:e=>{e.preventDefault();const s={id:i,name:c};a.promise(o(s).unwrap().then((e=>e.message)),{loading:"Memuat data...",success:e=>e,error:e=>e.data.message})},className:"rounded border bg-white p-2 d-flex flex-column gap-2 mb-2",children:[s.jsx("p",{className:"m-0 h6",children:"Kategori Penilaian"}),s.jsx("input",{type:"text",name:"name",id:"name",className:"form-control",placeholder:"Penilaian",value:c||"",onChange:e=>d(e.target.value)}),s.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[s.jsx("button",{type:"button",className:"btn btn-sm btn-warning",onClick:b,children:"Batal"}),s.jsx("button",{type:"submit",className:"btn btn-sm btn-success",disabled:m,children:"Simpan"})]})]})},m=({indicator:e,setIndicator:i})=>{const[r,c]=l.useState(""),[d,o]=l.useState(""),[m,u]=l.useState(""),{data:x}=t({page:"",limit:"",search:""}),[h,{isLoading:b,isSuccess:g,isError:j,reset:p}]=n(),N=()=>{i({}),c(""),o(""),u("")};return l.useEffect((()=>{(g||j)&&(N(),p())}),[g,j]),l.useEffect((()=>{e&&(c(e.id),u(e.name),o(e.category_id))}),[e]),s.jsxs("form",{onSubmit:e=>{e.preventDefault();const s={id:r,categoryId:d,name:m};a.promise(h(s).unwrap().then((e=>e.message)),{loading:"Menambahkan indikator...",success:e=>e,error:e=>e.data.message})},className:"rounded border bg-white p-2 d-flex flex-column gap-2",children:[s.jsx("p",{className:"m-0 h6",children:"Indikator Penilaian"}),s.jsxs("select",{name:"cetegory",id:"1",className:"form-select",required:!0,value:d||"",onChange:e=>o(e.target.value),children:[s.jsx("option",{value:"",hidden:!0,children:"Pilih Kategori"}),null==x?void 0:x.map((e=>s.jsx("option",{value:e.id,children:e.name},e.id)))]}),s.jsx("input",{type:"text",className:"form-control",placeholder:"Nama Indikator",required:!0,value:m||"",onChange:e=>u(e.target.value)}),s.jsxs("div",{className:"text-end",children:[s.jsx("button",{type:"button",className:"btn btn-sm btn-warning me-2",onClick:N,children:"Batal"}),s.jsx("button",{type:"submit",className:"btn btn-sm btn-success",disabled:b,children:"Simpan"})]})]})},u=({setCategory:e,setIndicator:n})=>{const[c,o]=l.useState(1),[m,u]=l.useState(10),[x,h]=l.useState(""),{data:b={},isLoading:g}=t({page:c,limit:m,search:x}),{categories:j=[],totalData:p,totalPage:N}=b,[f,{isLoading:v}]=i(),[y,{isLoading:k}]=r();return s.jsx(d,{isLoading:g,page:c,setPage:o,totalPage:N,totalData:p,limit:m,setLimit:u,search:x,setSearch:h,children:s.jsxs("table",{className:"mb-0 table table-bordered table-hover table-striped",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-center",children:"No"}),s.jsx("th",{className:"text-center",children:"Kategori"}),s.jsx("th",{className:"text-center",children:"Indikator"}),s.jsx("th",{className:"text-center",children:"Aksi"})]})}),s.jsx("tbody",{children:null==j?void 0:j.map(((t,i)=>s.jsxs("tr",{children:[s.jsx("th",{scope:"col",className:"text-center align-middle",children:(c-1)*m+i+1}),s.jsx("td",{className:"align-middle",children:t.name}),s.jsx("td",{className:"align-middle",children:s.jsx("div",{className:"d-flex flex-column gap-2",children:t.indicators.filter((e=>null!==e)).length>0?t.indicators.filter((e=>null!==e)).map(((e,t)=>s.jsxs("div",{className:"d-flex align-items-center justify-content-between p-2 rounded border border-2 pointer",children:[s.jsx("p",{className:"m-0",children:e.name}),s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[s.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>n(e),children:s.jsx("i",{className:"bi bi-pencil-square"})}),s.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>{return s=e.id,void a.promise(y(s).unwrap().then((e=>e.message)),{loading:"Menghapus indikator...",success:e=>e,error:e=>e.data.message});var s},children:s.jsx("i",{className:"bi bi-x text-white"})})]})]},t))):s.jsx("p",{className:"m-0 text-muted",children:"Belum ada indikator untuk kategori ini"})})}),s.jsx("td",{className:"align-middle",children:s.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[s.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>e(t),children:s.jsx("i",{className:"bi bi-pencil-square"})}),s.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>{return e=t.id,void a.promise(f(e).unwrap().then((e=>e.message)),{loading:"Menghapus kategori...",success:e=>e,error:e=>e.data.message});var e},children:s.jsx("i",{className:"bi bi-trash"})})]})})]},i)))})]})})},x=()=>{const[e,a]=l.useState({}),[t,n]=l.useState({});return s.jsx(c,{title:"Metrik Penilaian",levels:["tahfiz"],children:s.jsxs("div",{className:"row g-2",children:[s.jsxs("div",{className:"col-lg-3 col-12",children:[s.jsx(o,{category:e,setCategory:a}),s.jsx(m,{indicator:t,setIndicator:n})]}),s.jsx("div",{className:"col-lg-9 col-12",children:s.jsx(u,{setCategory:a,setIndicator:n})})]})})};export{x as default};
//# sourceMappingURL=TahfizMetric-Cm5UFqLh.js.map
