import{a4 as e,a5 as a,l as t,bg as s,s as i,j as n,m as r,n as l,I as d,bh as c,bi as o,bj as u,F as h,t as m,aq as p,B as x,r as g,bk as j,bl as f,bm as b,bn as k,h as y,aF as w,R as v,C as S,a as C,A as _,a3 as T,Z as N,bo as P,bp as L,bq as M,br as F,bs as z,au as I,am as A,b as B,bt as E,at as D,bu as R,bv as O,D as H,bw as K,bx as Y,by as $,bz as V,bA as U,bB as G,bC as q,bD as J,bE as W,bF as Z}from"./index-CkbFvJ_0.js";import{c as X,i as Q,u as ee}from"./vendor-DnNJsrFE.js";import{S as ae}from"./Subjects-Dd-1O6Aq.js";import{A as te}from"./Add-C15bWNc8.js";import{U as se,R as ie,a as ne}from"./InboxOutlined-BBLrcGLE.js";import{E as re,S as le}from"./Pagination-DUZ3fk1r.js";import{R as de}from"./FileAddOutlined-CMDCT8Bq.js";import{L as ce}from"./index-DwPfVTSu.js";import{P as oe}from"./index-B9vS2emJ.js";import{R as ue}from"./DeleteOutlined-B8AWRrpI.js";import{S as he}from"./index-C83xQ6_Y.js";import{C as me}from"./Collapse-BH7gJtSF.js";import{E as pe}from"./Editor-DmjG4hlf.js";import{R as xe}from"./ReadOutlined-C_oAFhHv.js";import{R as ge}from"./FileTextOutlined-_LXV4HPg.js";import{d as je}from"./dayjs.min-NR93IlBy.js";import"./id-BaT3o_TC.js";import{R as fe}from"./CalendarOutlined-C3Y9yO-p.js";import{D as be}from"./index-LPLKuESt.js";import{R as ke}from"./CheckCircleOutlined-CHQ4Igi6.js";import{R as ye}from"./CloseCircleOutlined-DIPh4O0t.js";import{F as we,a as ve}from"./Table-B6Sdh0mV.js";import{R as Se}from"./FileExcelOutlined-dHNI7dTa.js";import{T as Ce}from"./index-B7bNcx2y.js";import{R as _e}from"./BookOutlined-CA2xbRTp.js";import{A as Te}from"./index-CNvy4rwH.js";import{r as Ne,u as Pe,w as Le}from"./xlsx-C5xT2hrF.js";import{R as Me}from"./DownloadOutlined-BwyKFFJh.js";import"./progress-BoG5Mtie.js";import"./ClockCircleOutlined-D0J3emkO.js";var Fe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M923 283.6a260.04 260.04 0 00-56.9-82.8 264.4 264.4 0 00-84-55.5A265.34 265.34 0 00679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 00-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9zM512 814.8S156 586.7 156 385.5C156 283.6 240.3 201 344.3 201c73.1 0 136.5 40.8 167.7 100.4C543.2 241.8 606.6 201 679.7 201c104 0 188.3 82.6 188.3 184.5 0 201.2-356 429.3-356 429.3z"}}]},name:"heart",theme:"outlined"},ze=function(t,s){return X.createElement(e,a({},t,{ref:s,icon:Fe}))},Ie=X.forwardRef(ze),Ae={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"}}]},name:"history",theme:"outlined"},Be=function(t,s){return X.createElement(e,a({},t,{ref:s,icon:Ae}))},Ee=X.forwardRef(Be),De={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M855.7 210.8l-42.4-42.4a8.03 8.03 0 00-11.3 0L168.3 801.9a8.03 8.03 0 000 11.3l42.4 42.4c3.1 3.1 8.2 3.1 11.3 0L855.6 222c3.2-3 3.2-8.1.1-11.2zM304 448c79.4 0 144-64.6 144-144s-64.6-144-144-144-144 64.6-144 144 64.6 144 144 144zm0-216c39.7 0 72 32.3 72 72s-32.3 72-72 72-72-32.3-72-72 32.3-72 72-72zm416 344c-79.4 0-144 64.6-144 144s64.6 144 144 144 144-64.6 144-144-64.6-144-144-144zm0 216c-39.7 0-72-32.3-72-72s32.3-72 72-72 72 32.3 72 72-32.3 72-72 72z"}}]},name:"percentage",theme:"outlined"},Re=function(t,s){return X.createElement(e,a({},t,{ref:s,icon:De}))},Oe=X.forwardRef(Re),He={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"},Ke=function(t,s){return X.createElement(e,a({},t,{ref:s,icon:He}))},Ye=X.forwardRef(Ke),$e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM664 533h-48.1c-4.2 0-7.8 3.2-8.1 7.4C604 589.9 562.5 629 512 629s-92.1-39.1-95.8-88.6c-.3-4.2-3.9-7.4-8.1-7.4H360a8 8 0 00-8 8.4c4.4 84.3 74.5 151.6 160 151.6s155.6-67.3 160-151.6a8 8 0 00-8-8.4z"}}]},name:"smile",theme:"outlined"},Ve=function(t,s){return X.createElement(e,a({},t,{ref:s,icon:$e}))},Ue=X.forwardRef(Ve),Ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"},qe=function(t,s){return X.createElement(e,a({},t,{ref:s,icon:Ge}))},Je=X.forwardRef(qe),We={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},Ze=function(t,s){return X.createElement(e,a({},t,{ref:s,icon:We}))},Xe=X.forwardRef(Ze),Qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M368 724H252V608c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v116H72c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h116v116c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V788h116c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M912 302.3L784 376V224c0-35.3-28.7-64-64-64H128c-35.3 0-64 28.7-64 64v352h72V232h576v560H448v72h272c35.3 0 64-28.7 64-64V648l128 73.7c21.3 12.3 48-3.1 48-27.6V330c0-24.6-26.7-40-48-27.7zM888 625l-104-59.8V458.9L888 399v226z"}},{tag:"path",attrs:{d:"M320 360c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H208c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h112z"}}]},name:"video-camera-add",theme:"outlined"},ea=function(t,s){return X.createElement(e,a({},t,{ref:s,icon:Qe}))},aa=X.forwardRef(ea),ta={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M960 509.2c0-2.2 0-4.7-.1-7.6-.1-8.1-.3-17.2-.5-26.9-.8-27.9-2.2-55.7-4.4-81.9-3-36.1-7.4-66.2-13.4-88.8a139.52 139.52 0 00-98.3-98.5c-28.3-7.6-83.7-12.3-161.7-15.2-37.1-1.4-76.8-2.3-116.5-2.8-13.9-.2-26.8-.3-38.4-.4h-29.4c-11.6.1-24.5.2-38.4.4-39.7.5-79.4 1.4-116.5 2.8-78 3-133.5 7.7-161.7 15.2A139.35 139.35 0 0082.4 304C76.3 326.6 72 356.7 69 392.8c-2.2 26.2-3.6 54-4.4 81.9-.3 9.7-.4 18.8-.5 26.9 0 2.9-.1 5.4-.1 7.6v5.6c0 2.2 0 4.7.1 7.6.1 8.1.3 17.2.5 26.9.8 27.9 2.2 55.7 4.4 81.9 3 36.1 7.4 66.2 13.4 88.8 12.8 47.9 50.4 85.7 98.3 98.5 28.2 7.6 83.7 12.3 161.7 15.2 37.1 1.4 76.8 2.3 116.5 2.8 13.9.2 26.8.3 38.4.4h29.4c11.6-.1 24.5-.2 38.4-.4 39.7-.5 79.4-1.4 116.5-2.8 78-3 133.5-7.7 161.7-15.2 47.9-12.8 85.5-50.5 98.3-98.5 6.1-22.6 10.4-52.7 13.4-88.8 2.2-26.2 3.6-54 4.4-81.9.3-9.7.4-18.8.5-26.9 0-2.9.1-5.4.1-7.6v-5.6zm-72 5.2c0 2.1 0 4.4-.1 7.1-.1 7.8-.3 16.4-.5 25.7-.7 26.6-2.1 53.2-4.2 77.9-2.7 32.2-6.5 58.6-11.2 76.3-6.2 23.1-24.4 41.4-47.4 47.5-21 5.6-73.9 10.1-145.8 12.8-36.4 1.4-75.6 2.3-114.7 2.8-13.7.2-26.4.3-37.8.3h-28.6l-37.8-.3c-39.1-.5-78.2-1.4-114.7-2.8-71.9-2.8-124.9-7.2-145.8-12.8-23-6.2-41.2-24.4-47.4-47.5-4.7-17.7-8.5-44.1-11.2-76.3-2.1-24.7-3.4-51.3-4.2-77.9-.3-9.3-.4-18-.5-25.7 0-2.7-.1-5.1-.1-7.1v-4.8c0-2.1 0-4.4.1-7.1.1-7.8.3-16.4.5-25.7.7-26.6 2.1-53.2 4.2-77.9 2.7-32.2 6.5-58.6 11.2-76.3 6.2-23.1 24.4-41.4 47.4-47.5 21-5.6 73.9-10.1 145.8-12.8 36.4-1.4 75.6-2.3 114.7-2.8 13.7-.2 26.4-.3 37.8-.3h28.6l37.8.3c39.1.5 78.2 1.4 114.7 2.8 71.9 2.8 124.9 7.2 145.8 12.8 23 6.2 41.2 24.4 47.4 47.5 4.7 17.7 8.5 44.1 11.2 76.3 2.1 24.7 3.4 51.3 4.2 77.9.3 9.3.4 18 .5 25.7 0 2.7.1 5.1.1 7.1v4.8zM423 646l232-135-232-133z"}}]},name:"youtube",theme:"outlined"},sa=function(t,s){return X.createElement(e,a({},t,{ref:s,icon:ta}))},ia=X.forwardRef(sa);const{TextArea:na}=d,ra=({title:e,open:a,onClose:c,chapterid:o,content:u})=>{const[h]=t.useForm(),[m,{isLoading:p,isSuccess:x,error:g,data:j,reset:f}]=s();return X.useEffect(()=>{x&&(i.success(j.message),h.resetFields(),c(),f()),g&&(i.error(g.data.message),f())},[j,x,g]),X.useEffect(()=>{a&&(h.resetFields(),u&&h.setFieldsValue({title:u.content_title,content:u.content_target}))},[u]),n.jsx(r,{title:e,open:a,onCancel:c,okText:"Simpan",cancelText:"Tutup",onOk:()=>h.submit(),children:n.jsx(l,{tip:"Memproses Data",spinning:p,children:n.jsxs(t,{layout:"vertical",form:h,onFinish:e=>{if(u){const a={chapterid:o,contentid:u.content_id,...e};m(a)}else{const a={chapterid:o,...e};m(a)}},children:[n.jsx(t.Item,{name:"title",label:"Judul Materi",rules:[{required:!0,message:"Judul Materi Wajib diisi!"}],children:n.jsx(d,{placeholder:"Judul Materi"})}),n.jsx(t.Item,{name:"content",label:"Capaian Pembelajaran",rules:[{required:!0,message:"Capaian Wajib diisi!"}],children:n.jsx(na,{rows:4,placeholder:"Capaian Pembelajaran"})})]})})})},{Dragger:la}=se,da=({title:e,open:a,onClose:s,contentid:o})=>{const[u]=t.useForm(),[h,{isLoading:m,isSuccess:p,error:x,data:g,reset:j}]=c();X.useEffect(()=>{a&&u.resetFields(),p&&(i.success(g?.message||"File berhasil diunggah!"),j(),s(),u.resetFields()),x&&(i.error(x.data?.message||"Terjadi kesalahan saat mengunggah."),j())},[g,p,x,s,j,a]);return n.jsx(r,{title:e,open:a,onCancel:s,okText:"Simpan",cancelText:"Tutup",onOk:()=>u.submit(),confirmLoading:m,destroyOnHidden:!0,maskClosable:!1,children:n.jsx(l,{tip:"Mengunggah File...",spinning:m,children:n.jsxs(t,{form:u,layout:"vertical",onFinish:e=>{const a=new FormData;a.append("contentId",o),a.append("title",e.title),e.files.forEach(e=>{a.append("files",e.originFileObj)}),h(a)},children:[n.jsx(t.Item,{name:"title",label:"Nama File",rules:[{required:!0,message:"Nama file tidak boleh kosong!"}],children:n.jsx(d,{placeholder:"Nama File"})}),n.jsx(t.Item,{label:"Pilih File",name:"files",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e?.fileList,rules:[{required:!0,message:"Silakan pilih minimal satu file!"}],children:n.jsxs(la,{name:"files",multiple:!0,accept:".pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.txt,.zip,.rar",beforeUpload:()=>!1,children:[n.jsx("p",{className:"ant-upload-drag-icon",children:n.jsx(ie,{})}),n.jsx("p",{className:"ant-upload-text",children:"Klik atau seret file ke area ini untuk mengunggah"}),n.jsx("p",{className:"ant-upload-hint",children:"Mendukung unggahan tunggal atau massal. Format yang diizinkan: PDF, DOC, PPT, XLS, TXT, ZIP, RAR."})]})})]})})})},ca=({title:e,open:a,onClose:s,contentid:l})=>{const[o]=t.useForm(),[u,{data:h,error:m,isLoading:p,isSuccess:x,reset:g}]=c();return X.useEffect(()=>{a&&o.resetFields(),x&&(i.success(h.message),o.resetFields(),s(),g()),m&&(i.error(m.data.message),g())},[a,h,x,m]),n.jsx(r,{title:e,open:a,onCancel:s,okText:"Simpan",cancelText:"Tutup",onOk:()=>o.submit(),destroyOnHidden:!0,loading:p,children:n.jsxs(t,{layout:"vertical",form:o,onFinish:e=>{if(!/^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+/.test(e.video))return void i.error("URL tidak valid. Pastikan URL dari YouTube");const a=new FormData;a.append("contentId",l),a.append("title",e.title),a.append("video",e.video),u(a)},children:[n.jsx(t.Item,{name:"title",label:"Judul Video",rules:[{required:!0,message:"Judul Wajib diisi"}],children:n.jsx(d,{placeholder:"Judul Video"})}),n.jsx(t.Item,{name:"video",label:"YouTube URL",rules:[{required:!0,message:"YouTube URL harus diisi"}],children:n.jsx(d,{placeholder:"YouTube URL"})})]})})},oa=({open:e,onClose:a,video:t})=>{if(!t||!t.video)return null;const s=(e=>{let a="";const t=e.match(/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);return t&&(a=t[1]),a})(t.video),i=`https://www.youtube.com/embed/${s}?autoplay=1`;return n.jsx(r,{title:t.title?`Playing Video: ${t.title}`:"Play Video",open:e,onCancel:a,destroyOnHidden:!0,width:800,footer:null,children:s?n.jsx("div",{className:"video-responsive",style:{position:"relative",paddingBottom:"56.25%",height:0,overflow:"hidden",borderRadius:"15px"},children:n.jsx("iframe",{width:"100%",height:"100%",src:i,title:t.title||"YouTube video player",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})}):n.jsx("p",{children:"Invalid YouTube URL provided."})})},{Panel:ua}=me,{Text:ha,Paragraph:ma,Title:pa}=m,xa=({contents:e,chapterId:a})=>{const[t,{isSuccess:s,isLoading:r,data:l,error:d,reset:c}]=o(),[m]=u(),[j,f]=X.useState(!1),[b,k]=X.useState(""),[y,w]=X.useState(""),[v,S]=X.useState(!1),[C,_]=X.useState(!1),[T,N]=X.useState(!1),[P,L]=X.useState(""),M=e=>{t(e)};if(X.useEffect(()=>{s&&(i.success(l.message),c()),d&&(i.error(d.data.message),c())},[l,s,d]),!e||0===e.length)return n.jsx(re,{image:re.PRESENTED_IMAGE_SIMPLE,description:"Belum ada materi untuk bab ini."});const F=e.map((e,a)=>({key:e.content_id,label:n.jsx(pa,{level:5,style:{margin:0},children:e.content_title}),extra:n.jsxs(he,{onClick:e=>e.stopPropagation(),children:[n.jsx(p,{title:"Edit Materi",children:n.jsx(x,{shape:"circle",icon:n.jsx(g,{}),onClick:()=>(e=>{k(e),f(!0)})(e)})}),n.jsx(oe,{title:"Hapus materi ini?",description:"Semua file dan video di dalamnya akan ikut terhapus.",onConfirm:()=>{return a=e.content_id,void m(a);var a},okText:"Ya, Hapus",cancelText:"Batal",children:n.jsx(p,{title:"Hapus Materi",children:n.jsx(x,{danger:!0,shape:"circle",icon:n.jsx(ue,{})})})})]}),children:n.jsxs(h,{vertical:!0,gap:"large",children:[n.jsxs("div",{children:[n.jsx(ha,{strong:!0,children:"Tujuan Pembelajaran:"}),n.jsx(ma,{children:n.jsx(ha,{type:"secondary",style:{whiteSpace:"pre-wrap"},children:e.content_target||"-"})})]}),n.jsxs("div",{children:[n.jsxs(h,{justify:"space-between",align:"center",wrap:"wrap",gap:8,children:[n.jsx(ha,{strong:!0,children:"File Materi:"}),n.jsx(p,{title:"Tambah File Baru",children:n.jsx(x,{icon:n.jsx(de,{}),onClick:()=>{return a=e.content_id,w(a),void S(!0);var a},children:"Tambah File"})})]}),n.jsx(ce,{itemLayout:"horizontal",dataSource:e.files,renderItem:e=>n.jsx(ce.Item,{actions:[n.jsx(oe,{title:"Hapus file ini?",onConfirm:()=>M(e.id),okText:"Ya",cancelText:"Tidak",children:n.jsx(p,{title:"Hapus File",children:n.jsx(x,{type:"text",danger:!0,shape:"circle",icon:n.jsx(ue,{})})})},`delete-${e.id}`)],children:n.jsx(ce.Item.Meta,{avatar:n.jsx(ne,{}),title:n.jsx("a",{href:e.file,target:"_blank",rel:"noopener noreferrer",children:e.title})})})})]}),n.jsxs("div",{children:[n.jsxs(h,{justify:"space-between",align:"center",wrap:"wrap",gap:8,children:[n.jsx(ha,{strong:!0,children:"Video Materi:"}),n.jsx(p,{title:"Tambah Video Baru",children:n.jsx(x,{icon:n.jsx(aa,{}),onClick:()=>{return a=e.content_id,w(a),void _(!0);var a},children:"Tambah Video"})})]}),n.jsx(ce,{dataSource:e.videos,renderItem:e=>n.jsx(ce.Item,{actions:[n.jsx(x,{shape:"circle",icon:n.jsx(aa,{}),onClick:()=>(e=>{L(e),N(!0)})(e)},`Play-${e.id}`),n.jsx(oe,{title:"Hapus file ini?",onConfirm:()=>M(e.id),okText:"Ya",cancelText:"Tidak",children:n.jsx(p,{title:"Hapus File",children:n.jsx(x,{type:"text",danger:!0,shape:"circle",icon:n.jsx(ue,{})})})},`delete-${e.id}`)],children:n.jsx(ce.Item.Meta,{avatar:n.jsx(ia,{style:{color:"#CD201F"}}),title:n.jsx(ha,{children:e.title})})})})]})]})}));return n.jsxs(n.Fragment,{children:[n.jsx(me,{accordion:!0,items:F}),n.jsx(ra,{title:`Edit Materi ${b.content_title}`,open:j,content:b,onClose:()=>{k(""),f(!1)}}),n.jsx(da,{title:"Simpan File Baru",open:v,onClose:()=>{w(""),S(!1)},contentid:y}),n.jsx(ca,{title:"Simpan YouTube Video",open:C,onClose:()=>{w(""),_(!1)},contentid:y}),n.jsx(oa,{open:T,onClose:()=>{L(""),N(!1)},video:P})]})},ga=({title:e,open:a,onClose:s,chapter:c})=>{const[o]=t.useForm(),[u]=Q(),[h,m]=X.useState(""),{data:p}=j(),[x,{isLoading:g,isSuccess:b,data:k,error:y}]=f(),w=u.get("subjectid"),v=p?.map(e=>({value:e.id,label:e.name}));return X.useEffect(()=>{b&&(i.success(k.message),o.resetFields(),m(""),s()),y&&i.error(y.data.message)},[k,b,y]),X.useEffect(()=>{a&&(o.resetFields(),m(""),c&&(m(c.chapter_id),o.setFieldsValue({title:c.chapter_name,target:c.target,classes:c.class?.map(e=>e.id)})))},[c,a]),n.jsx(r,{title:e,open:a,onCancel:s,okText:"Simpan",cancelText:"Tutup",destroyOnHidden:!0,onOk:()=>o.submit(),children:n.jsx(l,{tip:"Memproses data",spinning:g,children:n.jsxs(t,{form:o,layout:"vertical",onFinish:e=>{if(h){const a={subjectid:w,chapterid:h,...e};x(a)}else{const a={subjectid:w,...e};x(a)}},children:[n.jsx(t.Item,{name:"title",label:"Nama Bab",rules:[{required:!0,message:"Nama bab wajib diisi"}],children:n.jsx(d,{placeholder:"Nama Bab"})}),n.jsx(t.Item,{name:"target",label:"Capaian Pembelajaran",children:n.jsx(pe,{placeholder:"Tuliskan Capaian Pembelajaran",height:250})}),n.jsx(t.Item,{name:"classes",label:"Pilih Kelas",rules:[{required:!0,message:"Kelas wajib dipilih"}],children:n.jsx(le,{mode:"multiple",placeholder:"Pilih Kelas",options:v,allowClear:!0,showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})})]})})})},{confirm:ja}=r,fa=({name:e,id:a,onBack:t})=>{const[s,r]=X.useState(!1),[l,d]=X.useState(!1),[c,o]=X.useState(!1),[u,j]=X.useState(""),{data:f,isLoading:N}=b(a,{skip:!a}),[P,{isLoading:L,isSuccess:M,error:F,data:z}]=k();return X.useEffect(()=>{M&&i.success(z.message),F&&i.error(F.data.message)},[z,M,F]),n.jsxs(y,{title:e.replace(/-/g," "),levels:["teacher"],children:[n.jsxs(h,{vertical:!0,gap:"middle",children:[n.jsxs(h,{align:"center",justify:"space-between",children:[n.jsxs(he,{children:[n.jsx(x,{shape:"circle",icon:n.jsx(w,{}),onClick:t}),n.jsxs("div",{children:[n.jsx(m.Title,{style:{margin:0},level:5,children:`Pelajaran: ${e.replace(/-/g," ")}`}),n.jsx(m.Text,{type:"secondary",children:"Daftar Bab"})]})]}),n.jsx(te,{onClick:()=>d(!0)})]}),n.jsx(v,{gutter:[16,16],children:f?.length>0?f?.map((e,a)=>{return n.jsx(S,{sm:24,children:n.jsx(C,{hoverable:!0,loading:N||L,title:n.jsx(T,{color:"green",children:e.chapter_name}),actions:[n.jsx(p,{title:"Edit Bab",children:n.jsx(g,{onClick:()=>(e=>{j(e),o(!0),d(!0)})(e)},"edit")}),n.jsx(p,{title:"Hapus Bab",children:n.jsx(ue,{onClick:()=>{return a=e.chapter_id,void ja({title:"Apakah anda yakin akan menghapus bab ini?",content:"Semua file akan ikut terhapus permanen",okText:"Ya, Hapus",cancelText:"Batal",okType:"danger",onOk(){P(a)}});var a}},"add_content")})],extra:n.jsx(x,{icon:n.jsx(de,{}),onClick:()=>(j(e),void r(!0)),children:"Tambah Materi"}),children:n.jsxs(h,{vertical:!0,gap:"small",children:[n.jsx(_,{defaultActiveKey:"1",items:[{label:"Capaian",key:"1",children:n.jsx("article",{dangerouslySetInnerHTML:(t=e.target,{__html:t})})},{label:"Materi",key:"2",children:n.jsx(xa,{contents:e.contents,chapterId:e.chapter_id})}]}),n.jsxs(m.Text,{children:[n.jsx("strong",{children:"Pengajar:"})," ",e.teacher_name]}),n.jsxs(he,{size:[0,8],wrap:!0,children:[n.jsx("strong",{style:{marginRight:5},children:"Kelas: "}),e.class?.map(e=>n.jsx(T,{color:"blue",children:e.name},e.id))]}),n.jsxs(he,{size:"middle",wrap:!0,style:{marginTop:16},children:[n.jsxs(m.Text,{type:"secondary",children:[n.jsx(xe,{})," ",e.content," Konten"]}),n.jsxs(m.Text,{type:"secondary",children:[n.jsx(ge,{})," ",e.file," File"]}),n.jsxs(m.Text,{type:"secondary",children:[n.jsx(ia,{})," ",e.video," Video"]})]})]})})},e.chapter_id);var t}):n.jsx(S,{span:24,style:{textAlign:"center",marginTop:"2rem"},children:n.jsx(re,{description:n.jsx(m.Text,{type:"secondary",children:`Bab untuk pelajaran ${e.replace(/-/g," ")} belum tersedia`})})})})]}),n.jsx(ga,{title:c?"Perbaiki Bab":"Tambah Bab baru",open:l,onClose:()=>{j(""),o(!1),d(!1)},chapter:u}),n.jsx(ra,{title:`Tambah Materi ${u.chapter_name}`,open:s,onClose:()=>{j(""),r(!1)},chapterid:u.chapter_id})]})};je.locale("id");const{Text:ba}=m,ka={Hadir:"#52c41a",Telat:"#faad14",Sakit:"#1677ff",Izin:"#722ed1",Alpa:"#f5222d"},ya=({classid:e,subjectid:a})=>{const[t,s]=X.useState({current:1,pageSize:10}),[l,d]=X.useState(""),[c,o]=X.useState(je()),[u,h]=X.useState([]),m=c.format("YYYY-MM-DD"),{data:p,isLoading:g,isFetching:j}=N({page:t.current,limit:t.pageSize,search:l,classid:e},{skip:!e}),{data:f}=P({classid:e,subjectid:a,date:m},{skip:!e||!a}),[b]=L(),[k]=M(),[y]=F(),[w]=z(),{students:_,totalData:T}=p||{},E=u.length>0;X.useEffect(()=>{h([])},[c,e,a]);const D=async(e,a,t,s)=>{const n="apiCall";i.loading({content:a,key:n});try{const a=await e.unwrap();return i.success({content:a.message||t,key:n}),!0}catch(r){return i.error({content:r.data?.message||s,key:n}),!1}},R=t=>{if(!E)return void i.warning("Pilih siswa terlebih dahulu.");D(k({classid:e,subjectid:a,studentids:u,note:t,date:m}),`Memproses ${t} untuk ${u.length} siswa...`,"Presensi massal berhasil","Gagal memproses presensi massal").then(e=>{e&&h([])})},O=[{title:"No",key:"no",width:"5%",render:(e,a,s)=>(t.current-1)*t.pageSize+s+1},{title:"Siswa",dataIndex:"student_name",key:"student",render:(e,a)=>n.jsxs(he,{children:[n.jsx(A,{icon:n.jsx(B,{})}),n.jsxs("div",{children:[n.jsx(ba,{strong:!0,children:e}),n.jsx("br",{}),n.jsxs(ba,{type:"secondary",children:["NIS: ",a.nis," | ",a.class_name]})]})]})},{title:"Status Presensi",key:"attendance",width:"40%",render:(t,s)=>{const i=f?.find(e=>e.studentid===s.student),r=i?.note,l=e=>r===e?{backgroundColor:ka[e],borderColor:ka[e],color:"#fff"}:{};return n.jsxs(ve.Group,{value:r,onChange:t=>{return i=s.student,n=t.target.value,void D(b({classid:e,subjectid:a,studentid:i,note:n,date:m}),"Menyimpan presensi...","Presensi berhasil disimpan","Gagal menyimpan presensi");var i,n},buttonStyle:"solid",size:"small",block:!0,children:[n.jsx(ve.Button,{value:"Hadir",style:l("Hadir"),children:"Hadir"}),n.jsx(ve.Button,{value:"Telat",style:l("Telat"),children:"Telat"}),n.jsx(ve.Button,{value:"Sakit",style:l("Sakit"),children:"Sakit"}),n.jsx(ve.Button,{value:"Izin",style:l("Izin"),children:"Izin"}),n.jsx(ve.Button,{value:"Alpa",style:l("Alpa"),children:"Alpa"})]})}},{title:"Aksi",key:"action",align:"center",render:(t,s)=>n.jsx(oe,{title:"Hapus Presensi?",description:"Anda yakin ingin menghapus presensi siswa ini?",onConfirm:()=>{return t=s.student,void D(y({classid:e,subjectid:a,studentid:t,date:m}),"Menghapus presensi...","Presensi berhasil dihapus","Gagal menghapus presensi");var t},okText:"Ya",cancelText:"Tidak",children:n.jsx(x,{icon:n.jsx(ue,{}),type:"text",danger:!0})})}],H={selectedRowKeys:u,onChange:e=>h(e)};return e&&a?n.jsxs(C,{variant:"bordered",children:[n.jsxs(v,{gutter:[16,16],justify:"space-between",align:"middle",children:[n.jsx(S,{xs:24,md:8,children:n.jsxs(he,{direction:"vertical",children:[n.jsxs(ba,{strong:!0,children:[n.jsx(fe,{style:{marginRight:8}}),"Tanggal Presensi"]}),n.jsx(be,{value:c,onChange:e=>o(e||je()),format:"dddd, D MMMM YYYY",disabledDate:e=>e&&e>je().endOf("day"),style:{width:"100%"}})]})}),n.jsx(S,{xs:24,md:16,children:n.jsxs(he,{wrap:!0,style:{float:"right"},children:[n.jsxs(x,{onClick:()=>R("Hadir"),disabled:!E,icon:n.jsx(ke,{}),type:"primary",children:["Hadir (",u.length,")"]}),n.jsxs(x,{onClick:()=>R("Sakit"),disabled:!E,icon:n.jsx(Ie,{}),children:["Sakit (",u.length,")"]}),n.jsxs(x,{onClick:()=>R("Izin"),disabled:!E,icon:n.jsx(I,{}),children:["Izin (",u.length,")"]}),n.jsxs(x,{onClick:()=>R("Alpa"),disabled:!E,icon:n.jsx(ye,{}),danger:!0,children:["Alpa (",u.length,")"]}),n.jsxs(x,{onClick:()=>{E?r.confirm({title:`Hapus Presensi ${u.length} Siswa?`,content:"Apakah Anda yakin ingin menghapus data presensi untuk semua siswa yang dipilih pada tanggal ini?",okText:"Ya, Hapus",okType:"danger",cancelText:"Batal",onOk:()=>{D(w({classid:e,subjectid:a,studentids:u,date:m}),"Menghapus presensi massal...","Presensi massal berhasil dihapus","Gagal menghapus presensi massal").then(e=>{e&&h([])})}}):i.warning("Pilih siswa terlebih dahulu.")},disabled:!E,icon:n.jsx(ue,{}),danger:!0,type:"primary",children:["Hapus (",u.length,")"]})]})})]}),n.jsx(we,{style:{marginTop:24},rowSelection:H,columns:O,dataSource:_,rowKey:"student",loading:g||j,pagination:{...t,total:T,showSizeChanger:!0},onChange:e=>{s(e)},scroll:{x:!0}})]}):n.jsx(C,{children:n.jsx(re,{image:re.PRESENTED_IMAGE_SIMPLE,description:"Silakan pilih kelas dan mata pelajaran terlebih dahulu."})})};je.locale("id");const{Text:wa,Title:va}=m,Sa=({classid:e,subjectid:a})=>{const[t,s]=X.useState(je()),{data:i,isLoading:r,isError:d,error:c}=E({classid:e,subjectid:a,month:t?.format("YYYY-MM")},{skip:!e||!a||!t}),o=e=>{switch(e?.toLowerCase()){case"hadir":return"success";case"sakit":return"processing";case"izin":return"warning";case"alpa":return"error";default:return"default"}},u=(()=>{const e=[{title:"No",key:"index",width:60,fixed:"left",align:"center",render:(e,a,t)=>t+1},{title:"NIS",dataIndex:"nis",key:"nis",width:120,fixed:"left"},{title:"Nama Siswa",dataIndex:"student_name",key:"student_name",width:250,fixed:"left",render:e=>n.jsx(wa,{strong:!0,children:e})}];if(!i?.dates||0===i.dates.length)return e;const a=i.dates.map(e=>{return{title:(a=e,a?je(a).format("D-MMM-YY"):"-"),dataIndex:e,key:e,align:"center",width:110,render:e=>n.jsx(T,{color:o(e),style:{minWidth:"70px",textAlign:"center"},children:e||"-"})};var a}),t={title:"Presentase %",dataIndex:"presentase",key:"presentase",width:120,fixed:"right",align:"center",render:e=>n.jsx(wa,{strong:!0,children:null!=e?`${e}%`:"-"})};return[...e,...a,t]})();return d?n.jsx(re,{description:c?.data?.message||"Gagal memuat data."}):n.jsx(l,{spinning:r,tip:"Memuat data riwayat...",children:n.jsxs(C,{title:n.jsxs(he,{children:[n.jsx(Ee,{}),n.jsx(va,{level:5,style:{margin:0},children:"Riwayat Presensi"})]}),children:[n.jsx(v,{style:{marginBottom:24},children:n.jsx(S,{children:n.jsxs(he,{direction:"vertical",children:[n.jsxs(wa,{strong:!0,children:[n.jsx(fe,{})," Filter Berdasarkan Bulan"]}),n.jsx(be,{picker:"month",value:t,onChange:e=>s(e),style:{width:250},allowClear:!1})]})})}),n.jsx(we,{columns:u,dataSource:i?.students,rowKey:"studentid",bordered:!0,pagination:{pageSize:10,showSizeChanger:!0},scroll:{x:"max-content"},locale:{emptyText:n.jsx(re,{image:n.jsx(Se,{style:{fontSize:48,color:"#bfbfbf"}}),description:!r&&i?.students?.length>0?`Tidak ada data presensi pada bulan ${t.format("MMMM YYYY")}`:"Belum ada siswa di kelas ini untuk periode aktif."})}})]})})},Ca=()=>{const{user:e}=D(e=>e.auth),{data:a,isLoading:t}=j(),[s,i]=X.useState(""),[r,l]=X.useState(""),d=e?.subjects?.map(e=>({label:e.name,value:e.id})),c=a?.map(e=>({label:e.name,value:e.id})),o=[{label:"Presensi Harian",key:"1",children:n.jsx(ya,{classid:s,subjectid:r})},{label:"Riwayat Presensi",key:"2",children:n.jsx(Sa,{classid:s,subjectid:r})}];return n.jsxs(h,{vertical:!0,gap:"middle",children:[n.jsx(C,{hoverable:!0,title:"Managemen Kehadiran Siswa",children:n.jsxs(v,{gutter:[16,16],children:[n.jsx(S,{sm:24,md:12,children:n.jsx(le,{style:{width:"100%"},placeholder:"Pilih Mata Pelajran",allowClear:!0,options:d,onChange:e=>{l(e)},showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),n.jsx(S,{sm:24,md:12,children:n.jsx(le,{style:{width:"100%"},placeholder:"Pilih Kelas",allowClear:!0,options:c,onChange:e=>{i(e)},showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})})]})}),s&&r?n.jsx(_,{centered:!0,items:o}):n.jsx(re,{description:n.jsx(m.Text,{type:"secondary",children:"Silakan pilih mata pelajaran dan kelas terlebih dahulu untuk melihat data presensi"})})]})},{Text:_a}=m,Ta=({title:e,open:a,onClose:s,subject:l})=>{const[d]=t.useForm(),c=t.useWatch([],d),{data:o,isLoading:u}=R({subjectid:l.id},{skip:!l.id}),[h,{data:m,isLoading:p,isSuccess:x,error:g}]=O(),j=X.useMemo(()=>{const{presensi:e=0,attitude:a=0,daily:t=0}=c||{};return e+a+t},[c]);return X.useEffect(()=>{a&&d.resetFields()},[a]),X.useEffect(()=>{o&&d.setFieldsValue({presensi:o.presensi,attitude:o.attitude,daily:o.daily})},[o]),X.useEffect(()=>{x&&(i.success(m.message),s(),d.resetFields()),g&&i.error(g.data.message)},[m,x,g]),n.jsx(r,{title:e,open:a,onCancel:s,destroyOnHidden:!0,okText:"Simpan",cancelText:"Tutup",onOk:()=>d.submit(),okButtonProps:{disabled:100!==j},loading:p||u,confirmLoading:p||u,children:n.jsxs(t,{form:d,layout:"vertical",onFinish:e=>{if(100!==j)return void r.error({title:"Input Tidak Valid",content:"Total bobot nilai harus tepat 100%."});const a={subjectid:l.id,...e};h(a)},children:[n.jsx(_a,{type:"secondary",children:"Pastikan total bobot dari semua komponen penilaian adalah 100%."}),n.jsx(H,{style:{marginTop:"12px"}}),n.jsxs(v,{gutter:16,children:[n.jsx(S,{span:12,children:n.jsx(t.Item,{name:"presensi",label:n.jsxs(he,{children:[n.jsx(Oe,{}),"Bobot Nilai Kehadiran"]}),rules:[{required:!0,message:"Wajib diisi"}],children:n.jsx(Ce,{style:{width:"100%"},min:0,max:100,addonAfter:"%",placeholder:"e.g., 10"})})}),n.jsx(S,{span:12,children:n.jsx(t.Item,{name:"attitude",label:n.jsxs(he,{children:[n.jsx(Ue,{}),"Bobot Nilai Sikap"]}),rules:[{required:!0,message:"Wajib diisi"}],children:n.jsx(Ce,{style:{width:"100%"},min:0,max:100,addonAfter:"%",placeholder:"e.g., 20"})})})]}),n.jsx(v,{gutter:16,children:n.jsx(S,{span:12,children:n.jsx(t.Item,{name:"daily",label:n.jsxs(he,{children:[n.jsx(_e,{}),"Bobot Nilai Harian"]}),tooltip:"Nilai rerata dari sumatif dan formatif",rules:[{required:!0,message:"Wajib diisi"}],children:n.jsx(Ce,{style:{width:"100%"},min:0,max:100,addonAfter:"%",placeholder:"e.g., 40"})})})}),n.jsx(H,{}),100===j?n.jsx(Te,{message:n.jsxs(_a,{strong:!0,children:["Total Bobot: ",j,"%"]}),description:"Total bobot sudah sesuai.",type:"success",showIcon:!0}):n.jsx(Te,{message:n.jsxs(_a,{strong:!0,children:["Total Bobot: ",j,"%"]}),description:"Total bobot harus tepat 100% untuk dapat menyimpan.",type:"warning",showIcon:!0})]})})},{Meta:Na}=C,Pa=()=>{const[e,a]=X.useState(!1),[t,s]=X.useState(""),[i,r]=Q(),{user:l}=D(e=>e.auth),d=l?.subjects;return n.jsxs(h,{vertical:!0,gap:"middle",children:[n.jsx(m.Title,{level:5,children:"Pilih Mata Pelajaran Untuk Penilaian"}),n.jsx(v,{gutter:[16,16],children:d?.map(e=>n.jsx(S,{sm:24,md:12,lg:6,children:n.jsx(C,{hoverable:!0,cover:n.jsx("img",{src:e.cover?e.cover:"/logo.png",alt:e.name}),actions:[n.jsx(p,{title:"Penilaian",children:n.jsx(ge,{onClick:()=>(e=>{r({mode:"scoring",name:e.name?.replace(/\s+/g,"-"),subjectid:e.id})})(e)})},"scoring"),n.jsx(p,{title:"Pembobotan",children:n.jsx(Ye,{onClick:()=>(e=>{s(e),a(!0)})(e)})},"setting")],children:n.jsx(Na,{title:e.name})})},e.id))}),n.jsx(Ta,{title:`Pembobotan Nilai ${t?.name}`,open:e,onClose:()=>{s(""),a(!1)},subject:t})]})},{Dragger:La}=se,Ma=({title:e,open:a,onCancel:t,onUpload:s,isLoading:l})=>{const[d,c]=X.useState(null),[o,u]=X.useState([]),[h,m]=X.useState([]),[p,g]=X.useState([]);X.useEffect(()=>{a||(c(null),u([]),m([]),g([]))},[a]);const j={name:"file",multiple:!1,accept:".xlsx, .xls",fileList:d?[d]:[],beforeUpload:e=>{c(e);const a=new FileReader;return a.onload=e=>{try{const a=new Uint8Array(e.target.result),t=Ne(a,{type:"array"}),s=t.SheetNames[0],n=t.Sheets[s],r=Pe.sheet_to_json(n,{header:1});if(r.length>1){const e=r[0],a=r.slice(1).filter(e=>null!==e[0]&&void 0!==e[0]&&""!==String(e[0]).trim());u(a);const t=e.map((e,a)=>({title:e,dataIndex:a,key:a,width:1===a?250:120}));m(t);const s=a.map((e,a)=>{const t={key:a};return e.forEach((e,a)=>{t[a]=e}),t});g(s),i.success(`Berhasil membaca ${a.length} baris data dari file.`)}else i.warn("File excel tidak memiliki data untuk ditampilkan."),u([]),m([]),g([])}catch(a){i.error("Terjadi kesalahan saat membaca file.")}},a.readAsArrayBuffer(e),!1},onRemove:()=>{c(null),u([]),m([]),g([])}};return n.jsxs(r,{title:e,open:a,onCancel:t,width:1e3,confirmLoading:l,footer:[n.jsx(x,{onClick:t,children:"Batal"},"back"),n.jsx(x,{type:"primary",loading:l,onClick:()=>{o.length>0?s(o):i.error("Tidak ada data untuk diunggah. Silakan pilih file yang valid.")},disabled:0===o.length,icon:n.jsx(Xe,{}),children:"Upload Data"},"submit")],children:[n.jsxs(La,{...j,style:{marginBottom:20},children:[n.jsx("p",{className:"ant-upload-drag-icon",children:n.jsx(ie,{})}),n.jsx("p",{className:"ant-upload-text",children:"Klik atau seret file ke area ini untuk mengunggah"}),n.jsx("p",{className:"ant-upload-hint",children:"Gunakan template yang disediakan dan pastikan file dalam format .xlsx"})]}),p.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(Te,{message:`Pratinjau Data: Ditemukan ${p.length} baris data yang akan diunggah.`,type:"info",showIcon:!0,style:{marginBottom:16}}),n.jsx(we,{columns:h,dataSource:p,bordered:!0,size:"small",pagination:{pageSize:5},scroll:{y:240,x:"max-content"}})]})]})},Fa=({students:e,totalData:a,page:t,limit:s,setPage:r,setLimit:l,isLoading:c})=>{const[o,u]=X.useState({}),[h,m]=X.useState(!1),{user:p}=D(e=>e.auth),g=p?.id,[j]=Q(),f=j.get("name"),b=j.get("subjectid"),k=j.get("chapter"),y=j.get("class"),w=j.get("month"),v=j.get("semester"),{data:S,refetch:_}=K({classid:y,subjectid:b,chapterid:k,month:w,semester:v},{skip:!(y&&b&&k&&w&&v),refetchOnMountOrArgChange:!0}),[T,{isLoading:N}]=Y(),[P,{isLoading:L,data:M,error:F,isSuccess:z,reset:I}]=$();X.useEffect(()=>{u({})},[y,b,k,w,v]),X.useEffect(()=>{if(S&&Array.isArray(S)){const e=S.reduce((e,a)=>(e[a.student_id]={kinerja:a.kinerja??"",kedisiplinan:a.kedisiplinan??"",keaktifan:a.keaktifan??"",percayaDiri:a.percaya_diri??"",catatan:a.catatan_guru??""},e),{});Object.keys(e).length>0&&u(e)}},[S]),X.useEffect(()=>{z&&(i.success(M.message),I(),m(!1)),F&&(i.error(F.data.message),I())},[M,F,z]);const A=(e,a,t)=>{u(s=>({...s,[e]:{...s[e],[a]:t}}))},B=e=>{const a=o[e];if(!a)return 0;const t=[a.kinerja,a.kedisiplinan,a.keaktifan,a.percayaDiri].filter(e=>""!==e&&null!=e);return 0===t.length?0:(t.reduce((e,a)=>e+Number(a),0)/t.length).toFixed(1)},E=[{title:"No",key:"index",render:(e,a,i)=>(t-1)*s+i+1,width:60,fixed:"left"},{title:"NIS",dataIndex:"nis",key:"nis",width:120,fixed:"left"},{title:"Nama Siswa",dataIndex:"student_name",key:"student_name",width:200,fixed:"left"},{title:"Kinerja",key:"kinerja",width:120,render:(e,a)=>n.jsx(d,{type:"number",min:0,max:100,value:o[a.student]?.kinerja??"",onChange:e=>A(a.student,"kinerja",e.target.value),placeholder:"0-100"})},{title:"Kedisiplinan",key:"kedisiplinan",width:120,render:(e,a)=>n.jsx(d,{type:"number",min:0,max:100,value:o[a.student]?.kedisiplinan??"",onChange:e=>A(a.student,"kedisiplinan",e.target.value),placeholder:"0-100"})},{title:"Keaktifan",key:"keaktifan",width:120,render:(e,a)=>n.jsx(d,{type:"number",min:0,max:100,value:o[a.student]?.keaktifan??"",onChange:e=>A(a.student,"keaktifan",e.target.value),placeholder:"0-100"})},{title:"Percaya Diri",key:"percayaDiri",width:120,render:(e,a)=>n.jsx(d,{type:"number",min:0,max:100,value:o[a.student]?.percayaDiri??"",onChange:e=>A(a.student,"percayaDiri",e.target.value),placeholder:"0-100"})},{title:"Catatan Guru",key:"catatan",width:250,render:(e,a)=>n.jsx(d.TextArea,{rows:3,value:o[a.student]?.catatan||"",onChange:e=>A(a.student,"catatan",e.target.value),placeholder:"Catatan..."})},{title:"Rerata",key:"average",width:100,render:(e,a)=>n.jsx("strong",{children:B(a.student)})},{title:"Aksi",key:"action",width:100,fixed:"right",render:(e,a)=>n.jsx(x,{type:"primary",size:"small",onClick:()=>(async e=>{const a=e.student,t=o[a]||{},s={student_id:a,subject_id:Number(b),class_id:Number(y),chapter_id:Number(k),teacher_id:g,month:w,semester:v,kinerja:t.kinerja?Number(t.kinerja):null,kedisiplinan:t.kedisiplinan?Number(t.kedisiplinan):null,keaktifan:t.keaktifan?Number(t.keaktifan):null,percaya_diri:t.percayaDiri?Number(t.percayaDiri):null,catatan_guru:t.catatan||null};try{const e=await T(s).unwrap();i.success(e.message||"Nilai berhasil disimpan!"),_()}catch(n){i.error(n.data?.message||"Gagal menyimpan nilai.")}})(a),loading:N,children:"Simpan"})}];return n.jsxs(C,{title:"Penilaian Sikap",extra:n.jsxs(he,{children:[n.jsx(x,{icon:n.jsx(Xe,{}),onClick:()=>m(!0),children:"Upload Nilai"}),n.jsx(x,{icon:n.jsx(Me,{}),onClick:()=>{const a=[["NIS","Nama Siswa","Kinerja","Kedisiplinan","Keaktifan","Percaya Diri","Catatan","Rerata"]];e&&e.forEach(e=>{const t=e.student,s=o[t]||{},i=B(t);a.push([e.nis||"",e.student_name||"",s.kinerja??"",s.kedisiplinan??"",s.keaktifan??"",s.percayaDiri??"",s.catatan??"",i>0?i:""])});const t=Pe.book_new(),s=Pe.aoa_to_sheet(a);s["!cols"]=[{wch:15},{wch:30},{wch:12},{wch:15},{wch:12},{wch:15},{wch:40},{wch:12}],Pe.book_append_sheet(t,s,"Penilaian Sikap");const n=`penilaian_sikap_${f?.replace(/-/g," ")}.xlsx`;Le(t,n),i.success("Template berhasil diunduh!")},type:"primary",children:"Download"})]}),children:[n.jsx(we,{columns:E,dataSource:e,rowKey:"id",bordered:!0,loading:c,pagination:{current:t,pageSize:s,total:a,showSizeChanger:!0},onChange:e=>{r(e.current),l(e.pageSize)},scroll:{x:1500}}),n.jsx(Ma,{title:"Upload Nilai Sikap (Bulk)",open:h,onCancel:()=>m(!1),onUpload:async e=>{if(!e||0===e.length)return void i.error("Tidak ada data untuk diunggah.");const a={classid:Number(y),subjectid:Number(b),chapterid:Number(k),month:w,semester:v,data:e};try{await P(a).unwrap(),i.success("Data nilai berhasil di-upload!"),m(!1),_()}catch(t){i.error(t.data?.message||"Gagal mengupload file.")}},isLoading:L})]})},za=({students:e,totalData:a,page:t,limit:s,setPage:r,setLimit:l,isLoading:c})=>{const[o,u]=X.useState({}),[h,m]=X.useState(!1),{user:p}=D(e=>e.auth),g=p?.id,[j]=Q(),f=j.get("name"),b=j.get("subjectid"),k=j.get("chapter"),y=j.get("class"),w=j.get("month"),v=j.get("semester"),{data:S,refetch:_}=V({classid:y,subjectid:b,chapterid:k,month:w,semester:v},{skip:!(y&&b&&k&&w&&v),refetchOnMountOrArgChange:!0}),[T,{isLoading:N,isSuccess:P,error:L,data:M}]=U(),[F,{isLoading:z,data:I,error:A,isSuccess:B,reset:E}]=G();X.useEffect(()=>{if(S&&Array.isArray(S)){const e=S.reduce((e,a)=>(e[a.student_id]={f_1:a.f_1??"",f_2:a.f_2??"",f_3:a.f_3??"",f_4:a.f_4??"",f_5:a.f_5??"",f_6:a.f_6??"",f_7:a.f_7??"",f_8:a.f_8??""},e),{});u(e)}},[S]),X.useEffect(()=>{B&&(i.success(I.message),E(),m(!1)),A&&(i.error(A.data.message),E())},[I,A,B]),X.useEffect(()=>{P&&i.success(M.message),L&&i.error(L.data.message)},[M,L,P]);const R=e=>{const a=o[e];if(!a)return 0;const t=Object.values(a).filter(e=>""!==e&&null!=e);return 0===t.length?0:(t.reduce((e,a)=>e+Number(a),0)/t.length).toFixed(1)},O=[...[{title:"No",key:"index",render:(e,a,i)=>(t-1)*s+i+1,width:60,fixed:"left"},{title:"NIS",dataIndex:"nis",key:"nis",width:120,fixed:"left"},{title:"Nama Siswa",dataIndex:"student_name",key:"student_name",width:200,fixed:"left"}],...Array.from({length:8},(e,a)=>{const t=a+1;return{title:`f_${t}`,key:`f_${t}`,width:100,render:(e,a)=>n.jsx(d,{type:"number",min:0,max:100,style:{textAlign:"center"},placeholder:"0-100",value:o[a.student]?.[`f_${t}`]??"",onChange:e=>((e,a,t)=>{u(s=>({...s,[e]:{...s[e],[`f_${a}`]:t}}))})(a.student,t,e.target.value)})}}),...[{title:"Rerata",key:"average",width:80,fixed:"right",render:(e,a)=>n.jsx("strong",{children:R(a.student)})},{title:"Aksi",key:"action",width:100,fixed:"right",render:(e,a)=>n.jsx(x,{type:"primary",size:"small",onClick:()=>(async e=>{const a=e.student,t=o[a]||{},s={student_id:a,subject_id:Number(b),class_id:Number(y),chapter_id:Number(k),teacher_id:g,month:w,semester:v,F_1:t.f_1?Number(t.f_1):null,F_2:t.f_2?Number(t.f_2):null,F_3:t.f_3?Number(t.f_3):null,F_4:t.f_4?Number(t.f_4):null,F_5:t.f_5?Number(t.f_5):null,F_6:t.f_6?Number(t.f_6):null,F_7:t.f_7?Number(t.f_7):null,F_8:t.f_8?Number(t.f_8):null};T(s)})(a),loading:N,children:"Simpan"})}]];return n.jsxs(C,{title:"Penilaian Formatif",extra:n.jsxs(he,{children:[n.jsx(x,{icon:n.jsx(Xe,{}),onClick:()=>m(!0),children:"Upload Nilai"}),n.jsx(x,{icon:n.jsx(Me,{}),onClick:()=>{const a=["NIS","Nama Siswa"];for(let e=1;e<=8;e++)a.push(`F_${e}`);a.push("Rerata");const t=[a];e&&e.forEach(e=>{const a=e.student,s=o[a]||{},i=R(a),n=[e.nis||"",e.student_name||""];for(let t=1;t<=8;t++)n.push(s[`f_${t}`]??"");n.push(i>0?i:""),t.push(n)});const s=Pe.book_new(),n=Pe.aoa_to_sheet(t);n["!cols"]=[{wch:15},{wch:30},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:10}],Pe.book_append_sheet(s,n,"Penilaian Formatif"),Le(s,`penilaian_formatif_${f?.replace(/-/g," ")}.xlsx`),i.success("Template berhasil diunduh!")},type:"primary",children:"Download"})]}),children:[n.jsx(we,{columns:O,dataSource:e,rowKey:"id",bordered:!0,loading:c,pagination:{current:t,pageSize:s,total:a,showSizeChanger:!0},onChange:e=>{r(e.current),l(e.pageSize)},scroll:{x:1500}}),n.jsx(Ma,{title:"Upload Nilai Formatif (Bulk)",open:h,onCancel:()=>m(!1),onUpload:async e=>{const a={classid:Number(y),subjectid:Number(b),chapterid:Number(k),month:w,semester:v,data:e};F(a)},isLoading:z})]})},Ia=({students:e,totalData:a,page:t,limit:s,setPage:r,setLimit:l,isLoading:c})=>{const[o,u]=X.useState({}),[h,m]=X.useState(!1),{user:p}=D(e=>e.auth),g=p?.id,[j]=Q(),f=j.get("name"),b=j.get("subjectid"),k=j.get("chapter"),y=j.get("class"),w=j.get("month"),v=j.get("semester"),{data:S,refetch:_}=q({classid:y,subjectid:b,chapterid:k,month:w,semester:v},{skip:!(y&&b&&k&&w&&v),refetchOnMountOrArgChange:!0}),[T,{isLoading:N}]=J(),[P,{isLoading:L,isSuccess:M,data:F,error:z,reset:I}]=W(),A=e=>{const a=o[e];if(!a)return 0;const t=Object.values(a).filter(e=>""!==e&&null!=e);return 0===t.length?0:(t.reduce((e,a)=>e+Number(a),0)/t.length).toFixed(1)};X.useEffect(()=>{if(S&&Array.isArray(S)){const e=S.reduce((e,a)=>(e[a.student_id]={oral:a.oral??"",written:a.written??"",project:a.project??"",performance:a.performance??""},e),{});u(e)}},[S]);X.useEffect(()=>{M&&(i.success(F.message),I(),m(!1)),z&&(i.error(z.data.message),I())},[F,z,M]);const B=[{title:"No",key:"index",render:(e,a,i)=>(t-1)*s+i+1,width:60,fixed:"left"},{title:"NIS",dataIndex:"nis",key:"nis",width:120,fixed:"left"},{title:"Nama Siswa",dataIndex:"student_name",key:"student_name",width:250,fixed:"left"},...[{title:"Lisan",key:"oral"},{title:"Tulis",key:"written"},{title:"Proyek",key:"project"},{title:"Keterampilan",key:"performance"}].map(e=>({title:e.title,key:e.key,width:120,render:(a,t)=>n.jsx(d,{type:"number",min:0,max:100,placeholder:"0-100",value:o[t.student]?.[e.key]??"",onChange:a=>{return s=t.student,i=e.key,n=a.target.value,void u(e=>({...e,[s]:{...e[s],[i]:n}}));var s,i,n}})})),{title:"Rata2",key:"average",width:100,render:(e,a)=>n.jsx("strong",{children:A(a.student)})},{title:"Aksi",key:"action",width:100,fixed:"right",render:(e,a)=>n.jsx(x,{type:"primary",size:"small",onClick:()=>(async e=>{const a=e.student,t=o[a]||{},s={student_id:a,subject_id:Number(b),class_id:Number(y),chapter_id:Number(k),teacher_id:g,month:w,semester:v,oral:t.oral?Number(t.oral):null,written:t.written?Number(t.written):null,project:t.project?Number(t.project):null,performance:t.performance?Number(t.performance):null};try{const e=await T(s).unwrap();i.success(e.message||"Nilai berhasil disimpan!"),_()}catch(n){i.error(n.data?.message||"Gagal menyimpan nilai.")}})(a),loading:N,children:"Simpan"})}];return n.jsxs(C,{title:"Penilaian Sumatif",extra:n.jsxs(he,{children:[n.jsx(x,{icon:n.jsx(Xe,{}),onClick:()=>m(!0),children:"Upload Nilai"}),n.jsx(x,{icon:n.jsx(Me,{}),onClick:()=>{const a=[["NIS","Nama Siswa","Lisan","Tulis","Proyek","Keterampilan","Rata2"]];e&&e.forEach(e=>{const t=e.student,s=o[t]||{},i=A(t);a.push([e.nis||"",e.student_name||"",s.oral??"",s.written??"",s.project??"",s.performance??"",i>0?i:""])});const t=Pe.book_new(),s=Pe.aoa_to_sheet(a);s["!cols"]=[{wch:15},{wch:30},{wch:12},{wch:12},{wch:12},{wch:12},{wch:12}],Pe.book_append_sheet(t,s,"Penilaian Sumatif"),Le(t,`penilaian_sumatif_${f?.replace(/-/g," ")}.xlsx`),i.success("Template berhasil diunduh!")},type:"primary",children:"Download"})]}),children:[n.jsx(we,{columns:B,dataSource:e,rowKey:"id",bordered:!0,loading:c,pagination:{current:t,pageSize:s,total:a,showSizeChanger:!0},onChange:e=>{r(e.current),l(e.pageSize)},scroll:{x:1200}}),n.jsx(Ma,{title:"Upload Nilai Sumatif (Bulk)",open:h,onCancel:()=>m(!1),onUpload:async e=>{const a={classid:Number(y),subjectid:Number(b),chapterid:Number(k),month:w,semester:v,data:e};P(a)},isLoading:L})]})},{Title:Aa,Text:Ba}=m,{Search:Ea}=d,Da=({data:e})=>{if(!e?.results?.[0])return null;const a=e.results[0];return n.jsx(C,{size:"small",children:n.jsxs(h,{justify:"space-between",wrap:"wrap",children:[n.jsxs(h,{vertical:!0,children:[n.jsx(Ba,{strong:!0,children:"Mata Pelajaran"}),n.jsx(Ba,{children:a.subject_name})]}),n.jsxs(h,{vertical:!0,children:[n.jsx(Ba,{strong:!0,children:"Chapter"}),n.jsx(Ba,{children:a.chapter_name})]}),n.jsxs(h,{vertical:!0,children:[n.jsx(Ba,{strong:!0,children:"Kelas"}),n.jsx(Ba,{children:a.class_name})]}),n.jsxs(h,{vertical:!0,children:[n.jsx(Ba,{strong:!0,children:"Guru Pengampu"}),n.jsx(Ba,{children:a.teacher_name})]})]})})},Ra=()=>{const[e,a]=X.useState(1),[t,s]=X.useState(10),[i,r]=X.useState(""),[d,c]=X.useState(i),{user:o}=D(e=>e.auth),[u]=Q(),m=u.get("month"),p=u.get("subjectid"),g=u.get("chapter"),j=u.get("class"),{data:f,isLoading:b,isError:k,refetch:y,error:w}=Z({page:e,limit:t,search:d,month:m,subjectid:p,chapterid:g,classid:j});X.useEffect(()=>{const e=setTimeout(()=>{c(i),a(1)},500);return()=>{clearTimeout(e)}},[i]);const v=[{title:"No",key:"no",render:(a,s,i)=>(e-1)*t+i+1,width:50},{title:"Nama Siswa",dataIndex:"student_name",key:"student_name"},{title:"Kehadiran",dataIndex:"attendance",key:"attendance",align:"center"},{title:"Sikap",dataIndex:"attitude",key:"attitude",align:"center"},{title:"Harian",dataIndex:"daily",key:"daily",align:"center"},{title:"Nilai Akhir",dataIndex:"final_score",key:"final_score",align:"center",render:e=>n.jsx(Ba,{strong:!0,children:e})}];return m&&g&&j?n.jsxs(h,{vertical:!0,gap:"large",children:[n.jsx(Te,{showIcon:!0,type:"info",message:"Informasi Rekapitulasi",description:"Data yang ditampilkan adalah nilai yang sudah dibobotkan berdasarkan pengaturan yang telah ditentukan sebelumnya."}),n.jsx(C,{children:n.jsxs(h,{vertical:!0,gap:"middle",children:[n.jsx(Da,{data:f}),n.jsxs(h,{justify:"space-between",children:[n.jsx(Ea,{placeholder:"Cari nama siswa...",value:i,onChange:e=>r(e.target.value),style:{maxWidth:300},allowClear:!0}),n.jsx(x,{icon:n.jsx(Je,{}),onClick:y,color:"cyan",variant:"solid",children:"Sinkron Data"})]}),n.jsx(l,{spinning:b,children:n.jsx(we,{columns:v,dataSource:f?.results,rowKey:"student_id",pagination:{current:e,pageSize:t,total:f?.totalData,showSizeChanger:!0,pageSizeOptions:["10","20","50"]},onChange:e=>{a(e.current),s(e.pageSize)},bordered:!0,scroll:{x:"max-content"}})})]})})]}):n.jsx(Te,{message:"Parameter Tidak Lengkap",description:"Harap pilih Bulan, Chapter, dan Kelas terlebih dahulu untuk melihat rekapitulasi nilai.",type:"warning",showIcon:!0})},{Search:Oa}=d,Ha=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],Ka=[{label:"Semester 1",value:1},{label:"Semester 2",value:2}],Ya=({name:e,id:a})=>{const t=ee(),[s,i]=Q(),{data:r,isLoading:l}=b(a),[d,c]=X.useState(1),[o,u]=X.useState(10),[p,g]=X.useState(""),j=s.get("semester"),f=s.get("month"),k=s.get("chapter"),C=s.get("class"),T=s.get("subjectid"),{data:P,isLoading:L}=N({page:d,limit:o,search:p,classid:C},{skip:!C}),M=X.useMemo(()=>Ha.map(e=>({value:e,label:e})),[]),F=X.useMemo(()=>Ka.map(e=>({value:e.value,label:e.label})),[]),z=X.useMemo(()=>r?.map(e=>({value:e.chapter_id,label:e.chapter_name}))||[],[r]),I=X.useMemo(()=>{if(!k)return[];const e=r?.find(e=>String(e.chapter_id)===String(k));return e?.class?.map(e=>({value:e.id,label:e.name}))||[]},[r,k]),A=(e,a)=>{const t=new URLSearchParams(s);a?t.set(e,a):t.delete(e),"chapter"===e&&t.delete("class"),c(1),i(t)},B=[{label:"Kehadiran",key:"1",children:n.jsx(Sa,{classid:C,subjectid:T})},{label:"Sikap",key:"2",children:n.jsx(Fa,{students:P?.students,totalData:P?.totalData,page:d,limit:o,search:p,setPage:c,setLimit:u,setSearch:g,isLoading:L})},{label:"Formatif",key:"3",children:n.jsx(za,{students:P?.students,totalData:P?.totalData,page:d,limit:o,search:p,setPage:c,setLimit:u,setSearch:g,isLoading:L})},{label:"Sumatif",key:"4",children:n.jsx(Ia,{students:P?.students,totalData:P?.totalData,page:d,limit:o,search:p,setPage:c,setLimit:u,setSearch:g,isLoading:L})},{label:"Rekap",key:"5",children:n.jsx(Ra,{})}],E=j&&f&&k&&C;return n.jsx(y,{title:`Pelajaran ${e.replace(/-/g," ")}`,levels:["teacher"],children:n.jsxs(h,{vertical:!0,gap:"middle",children:[n.jsxs(he,{children:[n.jsx(x,{shape:"circle",icon:n.jsx(w,{}),onClick:()=>t("/learning-management-system")}),n.jsx(m.Title,{style:{margin:0},level:5,children:`Penilaian ${e.replace(/-/g," ")}`})]}),n.jsxs(v,{gutter:[10,10],children:[n.jsx(S,{sm:24,md:6,children:n.jsx(le,{style:{width:"100%"},placeholder:"Pilih Semester",options:F,allowClear:!0,value:j?Number(j):null,onChange:e=>A("semester",e),showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),n.jsx(S,{sm:24,md:6,children:n.jsx(le,{style:{width:"100%"},placeholder:"Pilih Bulan",options:M,allowClear:!0,value:f,onChange:e=>A("month",e),showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),n.jsx(S,{sm:24,md:6,children:n.jsx(le,{style:{width:"100%"},placeholder:"Pilih Chapter",options:z,allowClear:!0,loading:l,value:k?Number(k):null,onChange:e=>A("chapter",e),showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),n.jsx(S,{sm:24,md:6,children:n.jsx(le,{style:{width:"100%"},placeholder:"Pilih Kelas",options:I,allowClear:!0,disabled:!k,value:C?Number(C):null,onChange:e=>A("class",e),showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})})]}),E?n.jsxs(n.Fragment,{children:[n.jsx(Oa,{placeholder:"Cari nama siswa...",onSearch:e=>{g(e),c(1)},enterButton:!0,allowClear:!0}),n.jsx(_,{centered:!0,items:B})]}):n.jsx(re,{description:"Pilih Semester, bulan, chapter dan kelas terlebih dahulu"})]})})},$a=()=>{const e=ee(),[a]=Q(),t=a.get("name"),s=a.get("subjectid"),i=a.get("mode"),r=()=>{e("/learning-management-system")},l=[{label:"Absen",key:"1",children:n.jsx(Ca,{})},{label:"Mata Pelajaran",key:"2",children:n.jsx(ae,{})},{label:"Penilaian",key:"3",children:n.jsx(Pa,{})}];return"lms"===i?n.jsx(fa,{name:t,id:s,onBack:r}):"scoring"===i?n.jsx(Ya,{name:t,id:s}):n.jsx(y,{title:"Learning Management System",levels:["teacher"],children:n.jsx(_,{defaultActiveKey:"1",items:l,centered:!0})})};export{$a as default};
