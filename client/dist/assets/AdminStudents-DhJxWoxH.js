import{a7 as e,ab as s,ai as a,j as i,e as n,aa as d,aj as l,ak as t,X as r,al as c,am as m,V as o}from"./index-BrYqPfJf.js";import{b as u}from"./vendor-CnnDPxwB.js";import{L as x}from"./Layout-BiUTaUnj.js";import{T as h}from"./Table-Ya74POof.js";import"./index-B8CuzAwO.js";import"./index-g0LoU_Ie.js";import"./index-BpPDjKa5.js";const p=[{id:"nis",name:"nis",placeholder:"NIS"},{id:"name",name:"name",placeholder:"Name"}],g=({detail:d,setDetail:l})=>{const[t,r]=u.useState({id:"",entry:"",classid:"",nis:"",name:"",gender:""}),{data:c}=e({page:"",limit:"",search:""}),{data:m}=s({page:"",limit:"",search:""}),[o,{isSuccess:x,isLoading:h,isError:g,reset:b}]=a(),j=e=>{const{name:s,value:a}=e.target;r((e=>({...e,[s]:a})))},v=()=>{l({}),r({id:"",entry:"",classid:"",nis:"",name:"",gender:""})};return u.useEffect((()=>{if(x){b(),l({}),r({id:"",entry:"",classid:"",nis:"",name:"",gender:""});document.querySelector("[data-bs-dismiss='modal']").click()}g&&b()}),[x,g]),u.useEffect((()=>{d&&r({id:d.id||"",entry:d.entry_id||"",classid:d.classid||"",name:d.name||"",nis:d.nis||"",gender:d.gender||""})}),[d]),u.useEffect((()=>{const e=document.getElementById("addstudent");if(!e)return;const s=()=>{r({id:"",entry:"",classid:"",nis:"",name:"",gender:""}),document.activeElement&&document.activeElement.blur()};return e.addEventListener("hidden.bs.modal",s),()=>e.removeEventListener("hidden.bs.modal",s)}),[]),i.jsx("div",{className:"modal fade",id:"addstudent","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"studentModalLabel","aria-hidden":"true",children:i.jsx("div",{className:"modal-dialog ",children:i.jsxs("form",{onSubmit:e=>{e.preventDefault(),n.promise(o(t).unwrap().then((e=>e.message)),{loading:"Menyimpan Data...",success:e=>e,error:e=>e.data.message})},className:"modal-content p-3",children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h5",{className:"modal-title",id:"studentModalLabel",children:t.id?"Edit Siswa":"Tambah Siswa"}),i.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:v})]}),i.jsxs("div",{className:"modal-body d-flex flex-column gap-3",children:[i.jsxs("select",{name:"entry",id:"entry",className:"form-select",value:t.entry,onChange:j,required:!0,children:[i.jsx("option",{value:"",hidden:!0,children:"Tahun Masuk"}),null==c?void 0:c.map((e=>i.jsx("option",{value:e.id,children:e.name},e.id)))]}),i.jsxs("select",{name:"classid",id:"classid",className:"form-select",value:t.classid,onChange:j,required:!0,children:[i.jsx("option",{value:"",hidden:!0,children:"Kelas"}),null==m?void 0:m.map((e=>i.jsx("option",{value:e.id,children:e.name},e.id)))]}),null==p?void 0:p.map(((e,s)=>i.jsx("input",{type:"text",className:"form-control",placeholder:e.placeholder,name:e.name,id:e.name,value:t[e.name]||"",onChange:j,required:!0},s))),i.jsxs("select",{name:"gender",id:"gender",className:"form-select",value:t.gender,onChange:j,required:!0,children:[i.jsx("option",{value:"",hidden:!0,children:"Jenis Kelamin"}),i.jsx("option",{value:"L",children:"Laki Laki"}),i.jsx("option",{value:"P",children:"Perempuan"})]})]}),i.jsxs("div",{className:"modal-footer",children:[i.jsxs("button",{type:"button",className:"btn  btn-warning","data-bs-dismiss":"modal",onClick:v,children:[i.jsx("i",{className:"bi bi-x-lg me-1"}),"Batal"]}),i.jsxs("button",{type:"submit",className:"btn btn-success",disabled:h,children:[i.jsx("i",{className:"bi bi-save me-1"}),"Simpan"]})]})]})})})},b=({setDetail:e})=>{const[s,a]=u.useState(1),[n,x]=u.useState(12),[p,g]=u.useState("");u.useState("");const{data:b={},isLoading:j,refetch:v}=d({page:s,limit:n,search:p}),{students:N=[],totalData:f,totalPages:y}=b;l(),console.log(b);const[w,{isSuccess:k,isLoading:L,isError:S,reset:E}]=t(),[C]=r();c();const[M,{isLoading:D}]=m();return u.useEffect((()=>{k&&E(),S&&E()}),[k,S]),i.jsx(h,{page:s,setPage:a,setLimit:x,setSearch:g,totalData:f,totalPages:y,isLoading:j,downloadButton:{onClick:()=>{o.promise(M().unwrap().then((e=>e.message)),{loading:"Mengunduh data siswa...",success:e=>e,error:e=>{var s;return(null==(s=e.data)?void 0:s.message)||"Gagal mengunduh file"}})},isLoading:D},children:i.jsx("div",{className:"row g-4",children:N.length>0?N.map(((a,d)=>i.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-3",children:i.jsx("div",{className:"card border shadow-sm hover-shadow h-100 p-0 overflow-hidden position-relative rounded-4",children:i.jsxs("div",{className:"card-body p-4 d-flex flex-column h-100",children:[i.jsxs("div",{className:"d-flex align-items-start justify-content-between mb-2",children:[i.jsxs("div",{children:[i.jsx("h5",{className:"text-primary mb-1",style:{fontSize:20},children:a.name}),i.jsxs("span",{className:"badge bg-secondary mb-2",children:["NIS: ",a.nis]}),i.jsx("span",{className:`badge ms-2 ${a.isactive?"bg-success bg-opacity-10 text-success":"bg-danger bg-opacity-10 text-danger"} pointer`,style:{cursor:"pointer"},onClick:()=>{return e=a.id,void o.promise(C(e).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message});var e},children:a.isactive?"Aktif":"Nonaktif"})]}),i.jsxs("div",{className:"dropdown",children:[i.jsx("button",{className:"btn btn-sm btn-outline-primary",type:"button",id:`dropdownMenuButton${a.id}`,"data-bs-toggle":"dropdown","aria-expanded":"false",children:i.jsx("i",{className:"bi bi-three-dots-vertical"})}),i.jsxs("ul",{className:"dropdown-menu dropdown-menu-end shadow","aria-labelledby":`dropdownMenuButton${a.id}`,children:[i.jsx("li",{children:i.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2","data-bs-target":"#addstudent","data-bs-toggle":"modal",onClick:()=>e(a),children:[i.jsx("i",{className:"bi bi-pencil-square"})," Edit"]})}),i.jsx("li",{children:i.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2 text-danger",disabled:L,onClick:()=>{return e=a.id,void(window.confirm("Apakah anda yakin ingin menghapus siswa ini dan semua data yang terkait dengan siswa ini?")&&o.promise(w(e).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message}));var e},children:[i.jsx("i",{className:"bi bi-person-x-fill"})," Hapus"]})})]})]})]}),i.jsxs("div",{className:"d-flex flex-column gap-2",children:[i.jsxs("div",{className:"d-flex align-items-center gap-2",children:[i.jsx("i",{className:"bi bi-calendar-event text-primary"}),i.jsxs("span",{className:"small",children:["Tahun Ajaran: ",i.jsx("b",{children:a.periode_name})]})]}),i.jsxs("div",{className:"d-flex align-items-center gap-2",children:[i.jsx("i",{className:"bi bi-calendar-plus text-primary"}),i.jsxs("span",{className:"small",children:["Tahun Masuk: ",i.jsx("b",{children:a.entry})]})]}),i.jsxs("div",{className:"d-flex align-items-center gap-2",children:[i.jsx("i",{className:"bi bi-building text-primary"}),i.jsxs("span",{className:"small",children:["Satuan: ",i.jsx("b",{children:a.homebase})]})]}),i.jsxs("div",{className:"d-flex align-items-center gap-2",children:[i.jsx("i",{className:"bi bi-mortarboard-fill text-primary"}),i.jsxs("span",{className:"small",children:["Kelas: ",i.jsx("b",{children:a.classname})]})]}),i.jsxs("div",{className:"d-flex align-items-center gap-2 mb-1",children:[i.jsx("i",{className:`bi ${"L"===a.gender?"bi-gender-male":"bi-gender-female"} text-primary`}),i.jsxs("span",{className:"small",children:["Gender:"," ",i.jsx("b",{children:"L"===a.gender?"Laki-laki":"Perempuan"})]})]})]}),i.jsxs("p",{className:"m-0 text-muted small text-end",children:["#",(s-1)*n+d+1]})]})})},d))):i.jsx("div",{className:"col-12",children:i.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center py-5 text-muted gap-2",children:[i.jsx("i",{className:"bi bi-inbox fs-1"}),i.jsx("span",{className:"fs-5",children:"Data tidak tersedia"})]})})})})},j=()=>{const[e,s]=u.useState("");return i.jsxs(x,{title:"Siswa",levels:["admin"],children:[i.jsx(g,{detail:e,setDetail:s}),i.jsx(b,{setDetail:s})]})};export{j as default};
//# sourceMappingURL=AdminStudents-DhJxWoxH.js.map
