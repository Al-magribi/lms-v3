import{aX as a,aY as s,j as e,e as l,aZ as n,a_ as t}from"./index-Crz-ZxvS.js";import{L as i}from"./Layout-8dPvkf5v.js";import{u as d,b as r,e as c}from"./vendor-CnnDPxwB.js";import{T as o}from"./Table-DmgUSnWx.js";import{r as m,u as b}from"./xlsx-B4fPQ8kA.js";import"./index-B8CuzAwO.js";import"./index-g0LoU_Ie.js";import"./index-BpPDjKa5.js";const p=a=>({__html:a}),x=({subject:n,name:t,bankid:i})=>{const c=d(),[m,b]=r.useState(1),[x,u]=r.useState(10),[g,h]=r.useState(""),{data:j={},isLoading:N}=a({page:m,limit:x,search:g,bankid:i}),{totalData:f,totalPages:v,questions:y=[]}=j,[k,{isLoading:w}]=s();return e.jsx(o,{page:m,setPage:b,setLimit:u,setSearch:h,totalData:f,totalPages:v,isLoading:N,children:e.jsx("div",{className:"row g-4",children:(null==y?void 0:y.length)>0?null==y?void 0:y.map(((a,s)=>e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card shadow-sm",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("span",{className:"badge bg-primary me-3",children:(m-1)*x+s+1}),e.jsx("span",{className:"badge "+(1==a.qtype?"bg-success":"bg-info"),children:1==a.qtype?"PG":"Essay"})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>(a=>{const s=t.replace(/[\s/]/g,"-"),e=n.replace(/[\s/]/g,"-");c(`/admin-cbt-bank/${e}/${s}/${i}/${a}/edit-soal`)})(a.id),children:e.jsx("i",{className:"bi bi-pencil"})}),e.jsx("button",{className:"btn btn-sm btn-danger",disabled:w,onClick:()=>{return s=a.id,void l.promise(k(s).unwrap().then((a=>a.message)),{loading:"Memproses...",success:a=>a,error:a=>a.data.message});var s},children:e.jsx("i",{className:"bi bi-trash"})})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("small",{className:"text-muted d-block mb-2",children:"Pertanyaan"}),e.jsx("div",{className:"border rounded p-3 bg-light",dangerouslySetInnerHTML:p(a.question)})]}),1==a.qtype&&e.jsx("div",{className:"row g-3 mb-3",children:["a","b","c","d","e"].map((s=>a[s]&&""!==a[s].trim()&&e.jsx("div",{className:"col-md-6 col-lg-4",children:e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("span",{className:"badge bg-secondary me-2 mt-1",children:s.toUpperCase()}),e.jsx("div",{className:"border rounded p-2 flex-grow-1 "+(a.qkey===s?"bg-success bg-opacity-10":""),dangerouslySetInnerHTML:p(a[s])})]})},s)))}),e.jsxs("div",{className:"d-flex gap-3 pt-3 border-top",children:[e.jsxs("div",{children:[e.jsx("small",{className:"text-muted d-block",children:"Jawaban"}),e.jsx("span",{className:"badge bg-success",children:a.qkey})]}),e.jsxs("div",{children:[e.jsx("small",{className:"text-muted d-block",children:"Poin"}),e.jsx("span",{className:"badge bg-primary",children:a.poin})]})]})]})})},a.id))):e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"alert alert-info mb-0",children:"Data belum tersedia"})})})})},u=({bankid:a})=>{const[s,t]=r.useState(null),i=r.useRef(null),[d,{isLoading:c,isError:o,isSuccess:p,reset:x}]=n();return r.useEffect((()=>{p&&(x(),i.current.value=null),o&&(x(),i.current.value=null)}),[p,o]),e.jsx("div",{className:"modal fade",id:"upload","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"staticBackdropLabel",children:"Upload Soal"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:e.jsx("input",{type:"file",name:"file",id:"file",className:"form-control",ref:i,onChange:a=>t(a.target.files[0])})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-secondary","data-bs-dismiss":"modal",onClick:()=>{i.current.value=null,t(null)},children:"Batal"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",disabled:c,onClick:e=>{if(e.preventDefault(),s){const e=new FileReader;e.onload=s=>{const e=new Uint8Array(s.target.result),n=m(e,{type:"array"}),t=n.SheetNames[0],i=n.Sheets[t],r=b.sheet_to_json(i,{header:1,range:1}).filter((a=>a.length>0&&a.some((a=>null!=a)))).map((a=>{const[s,e,l,n,t,i,d,r,c]=a;return 2===s?[s,e,null,null,null,null,null,r,c]:[s,e,l,n,t,i,d,r,c]}));l.promise(d({body:r,bankid:a}).unwrap().then((a=>a.message)),{loading:"Menyimpan data...",success:a=>a,error:a=>a.data.message})},e.readAsArrayBuffer(s)}},children:"Upload"})]})]})})})},g=()=>{const a=d(),s=c(),{subject:n,name:r,bankid:o}=s,[m,{isLoading:b}]=t();return e.jsxs(i,{title:"Daftar Soal ",levels:["admin","teacher"],children:[e.jsx("div",{className:"container-fluid bg-white p-2 rounded shadow border mb-2",children:e.jsxs("div",{className:"row g-2",children:[e.jsx("div",{className:"col-lg-6 col-12 d-flex align-items-center",children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("p",{className:"m-0",children:["Mata Pelajaran: ",e.jsx("strong",{children:n.replace(/-/g," ")})]}),e.jsxs("p",{className:"m-0",children:["Bank Soal: ",e.jsx("strong",{children:r.replace(/-/g," ")})]})]})}),e.jsx("div",{className:"col-lg-6 col-12",children:e.jsxs("div",{className:"d-flex flex-wrap gap-2 justify-content-end",children:[e.jsxs("button",{className:"btn btn-sm btn-secondary","data-toggle":"tooltip","data-placement":"bottom",title:"Template",onClick:()=>{window.open("/temp/template_soal.xlsx","_blank")},children:[e.jsx("i",{className:"bi bi-filetype-xlsx"}),e.jsx("span",{className:"d-none d-sm-inline",children:"Template"})]}),e.jsxs("button",{className:"btn btn-sm btn-primary","data-toggle":"tooltip","data-placement":"bottom",title:"Upload","data-bs-toggle":"modal","data-bs-target":"#upload",children:[e.jsx("i",{className:"bi bi-file-earmark-arrow-up"}),e.jsx("span",{className:"d-none d-sm-inline",children:"Upload Soal"})]}),e.jsxs("button",{"data-toggle":"tooltip","data-placement":"bottom",title:"Tambah Soal",className:"btn btn-sm btn-success",onClick:()=>{const s=r.replace(/[\s/]/g,"-"),e=n.replace(/[\s/]/g,"-");a(`/admin-cbt-bank/${e}/${s}/${o}/tambah-soal`)},children:[e.jsx("i",{className:"bi bi-file-earmark-plus"}),e.jsx("span",{className:"d-none d-sm-inline",children:"Tambah Soal"})]}),e.jsxs("button",{className:"btn btn-sm btn-danger","data-toggle":"tooltip","data-placement":"bottom",title:"Hapus Soal",disabled:b,onClick:()=>{window.confirm("Apakah Anda yakin akan menghapus bank soal ini?")&&l.promise(m(o).unwrap().then((a=>a.message)),{loading:"Memproses...",success:a=>a,error:a=>a.data.message})},children:[e.jsx("i",{className:"bi bi-folder-x"}),e.jsx("span",{className:"d-none d-sm-inline",children:"Hapus Semua Soal"})]})]})})]})}),e.jsx(x,{subject:n,name:r,bankid:o}),e.jsx(u,{bankid:o})]})};export{g as default};
//# sourceMappingURL=CbtQuesList-BlOIrex9.js.map
