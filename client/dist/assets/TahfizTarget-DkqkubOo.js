import{aY as z,aO as v,aZ as y,r as o,j as e,e as T,a_ as S}from"./index-Bkq01jzn.js";import{L as w}from"./Layout-uGiKgFPI.js";import{S as k}from"./react-select.esm-DldCcTPv.js";const E=({detail:a,setDetail:s})=>{const{data:d}=z(),{data:n}=v({page:"",limit:"",search:""}),[r,{isLoading:x,isSuccess:h,isError:m,reset:j}]=y(),[c,i]=o.useState({id:a?a.id:"",grade_id:"",juz_ids:[]}),g=t=>{t.preventDefault();const f=c.juz_ids.map(l=>({id:c.id,gradeId:c.grade_id,juzId:l.value})).map(l=>r(l).unwrap().then(_=>_.message));T.promise(Promise.all(f),{loading:"Memuat data...",success:l=>l[0],error:l=>l.data.message})},p=()=>{s({}),i({id:"",grade_id:"",juz_ids:[]})},b=t=>{i(u=>({...u,juz_ids:t||[]}))};o.useEffect(()=>{a&&i({id:a.id||"",grade_id:a.grade_id||"",juz_ids:a.juz_id?[{value:a.juz_id,label:a.juz_name||`Juz ${a.juz_id}`}]:[]})},[a]),o.useEffect(()=>{(m||h)&&(j(),s({}),i({id:"",grade_id:"",juz_ids:[]}))},[h,m]);const N=(n==null?void 0:n.map(t=>({value:t.id,label:t.name})))||[];return e.jsxs("form",{onSubmit:g,className:"rounded border bg-white p-2 d-flex flex-column gap-2",children:[e.jsx("p",{className:"m-0 h6",children:"Target Hafalan"}),e.jsxs("select",{className:"form-select",value:c.grade_id,onChange:t=>i({...c,grade_id:t.target.value}),children:[e.jsx("option",{value:"",hidden:!0,children:"Pilih Tingkat"}),d==null?void 0:d.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(k,{isMulti:!0,options:N,value:c.juz_ids,onChange:b,className:"mb-2",placeholder:"Pilih Juz"}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm  btn-warning",onClick:p,children:"Batal"}),e.jsx("button",{type:"submit",className:"btn btn-sm btn-success",disabled:x,children:"Simpan"})]})]})},J=()=>{const{data:a}=S();return e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"mb-0 table table-bordered table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center",children:"Tingkat"}),e.jsx("th",{className:"text-center",children:"Juz"}),e.jsx("th",{className:"text-center",children:"Ayat"}),e.jsx("th",{className:"text-center",children:"Baris"}),e.jsx("th",{className:"text-center",children:"Total Ayat"}),e.jsx("th",{className:"text-center",children:"Total Baris"}),e.jsx("th",{className:"text-center",children:"Aksi"})]})}),e.jsx("tbody",{children:(a==null?void 0:a.length)>0?a==null?void 0:a.map((s,d)=>e.jsx(o.Fragment,{children:s.target.map((n,r)=>e.jsxs("tr",{children:[r===0&&e.jsx("th",{rowSpan:s.target.length,className:"text-center align-middle",children:s.grade}),e.jsx("td",{className:"text-center",children:n.juz}),e.jsx("td",{className:"text-center",children:n.total_ayat}),e.jsx("td",{className:"text-center",children:n.total_line}),r===0&&e.jsx("td",{rowSpan:s.target.length,className:"text-center align-middle",children:s.total_ayat}),r===0&&e.jsx("td",{rowSpan:s.target.length,className:"text-center align-middle",children:s.total_line}),e.jsx("td",{className:"text-center",children:e.jsx("div",{className:"d-flex justify-content-center gap-2",children:e.jsx("button",{className:"btn btn-sm btn-danger",children:e.jsx("i",{className:"bi bi-trash"})})})})]},r))},d)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center",children:"Tidak ada data tersedia"})})})]})})},G=()=>{const[a,s]=o.useState({});return e.jsx(w,{title:"Target Hafalan",levels:["tahfiz"],children:e.jsxs("div",{className:"row g-2",children:[e.jsx("div",{className:"col-lg-3 col-12",children:e.jsx(E,{detail:a,setDetail:s})}),e.jsx("div",{className:"col-lg-9 col-12",children:e.jsx(J,{})})]})})};export{G as default};
