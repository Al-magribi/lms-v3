import{bn as e,bk as a,ba as s,j as t,V as l,bw as i,bx as r}from"./index-CNbAajcm.js";import{b as n,e as d}from"./vendor-BYWiIb5-.js";import{L as c}from"./Layout-_SAc74nU.js";import{S as o}from"./react-select.esm-4h58l94a.js";import"./index-C-OX0RB-.js";import"./index-DLmIb9aI.js";const m=({typeId:i,setTypeId:r,examiner:d,setExaminer:c,surah:m,setSelectedSurah:h,setSelectedJuz:u,countAyat:x,fromAyat:j,setFromAyat:p,toAyat:v,setToAyat:N,countLine:f,fromLine:g,setFromLine:y,toLine:b,setToLine:S,addToTable:A,setTableData:L})=>{const{data:I}=e({page:"",limit:"",search:""}),{data:k}=a({page:"",limit:"",search:""}),{data:_}=s({page:"",limit:"",search:""}),[C,T]=n.useState([]),[w,z]=n.useState([]),[D,J]=n.useState(null);return t.jsx("div",{className:"row g-2",children:t.jsx("div",{className:"col-12",children:t.jsxs("div",{className:"row g-2",children:[t.jsx("div",{className:"col-12",children:t.jsx("p",{className:"m-0",children:"Hafalan Berdasarkan Juz"})}),t.jsx("div",{className:"col-6",children:t.jsx(o,{isMulti:!0,options:null==_?void 0:_.map((e=>({value:e.id,label:e.name}))),value:C,onChange:e=>{T(e||[])},placeholder:"Pilih Juz"})}),t.jsx("div",{className:"col-6 d-flex align-items-center",children:t.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>{if(0===C.length)return void l.error("Pilih Juz terlebih dahulu");const e=[];C.forEach((a=>{const s=null==_?void 0:_.find((e=>e.id===a.value));s&&0!==s.surah.length?(u(s),e.push(...s.surah.map((e=>({juzId:s.id,fromSurah:e.surah_id,fromSurahName:e.surah,fromAyat:e.from_ayat,toAyat:e.to_ayat,fromLine:1,toLine:e.lines}))))):l.error(`Data tidak tersedia untuk Juz ${a.label}`)})),e.length>0&&(L((a=>[...a,...e])),T([]))},children:t.jsx("i",{className:"bi bi-floppy"})})}),t.jsx("div",{className:"col-12",children:t.jsx("p",{className:"m-0",children:"Hafalan Berdasarkan Surah"})}),t.jsx("div",{className:" col-6",children:t.jsxs("select",{name:"juz2",id:"jus2",className:"form-select",onChange:e=>{const a=parseInt(e.target.value),s=null==_?void 0:_.find((e=>e.id===a));s&&0!==s.surah.length?(u(s),z(s.surah)):(l.error("Data tidak tersedia"),z([]))},children:[t.jsx("option",{value:"",hidden:!0,children:"Pilih Juz"}),null==_?void 0:_.map((e=>t.jsx("option",{value:e.id,children:e.name},e.id)))]})}),t.jsx("div",{className:" col-6",children:t.jsxs("select",{name:"surah",id:"surah",className:"form-select",onChange:e=>{const a=parseInt(e.target.value),s=w.find((e=>e.id===a));s?(h(s),J(s),p(""),N(""),y(""),S("")):l.error("Surah tidak ditemukan!")},disabled:0===w.length,children:[t.jsx("option",{value:"",hidden:!0,children:"Pilih Surah"}),null==w?void 0:w.map((e=>t.jsx("option",{value:e.id,children:e.surah},e.id)))]})}),t.jsx("div",{className:" col-6",children:t.jsxs("select",{name:"fromAyat",id:"fromAyat",className:"form-select",disabled:!D,value:j,onChange:e=>p(e.target.value),children:[t.jsx("option",{value:"",hidden:!0,children:"Dari Ayat"}),D&&Array.from({length:D.to_ayat-D.from_ayat+1},((e,a)=>D.from_ayat+a)).map((e=>t.jsx("option",{value:e,children:e},e)))]})}),t.jsx("div",{className:" col-6",children:t.jsxs("select",{name:"toAyat",id:"toAyat",className:"form-select",disabled:!j,value:v,onChange:e=>N(e.target.value),children:[t.jsx("option",{value:"",hidden:!0,children:"Sampai Ayat"}),D&&Array.from({length:D.to_ayat-D.from_ayat+1},((e,a)=>D.from_ayat+a)).map((e=>t.jsx("option",{value:e,children:e},e)))]})}),t.jsx("div",{className:"col-lg-4 col-6",children:t.jsxs("select",{name:"fromLine",id:"fromLine",className:"form-select",disabled:!v,value:g,onChange:e=>y(e.target.value),children:[t.jsx("option",{value:"",hidden:!0,children:"Dari Baris"}),D&&Array.from({length:D.lines},((e,a)=>a+1)).map((e=>t.jsx("option",{value:e,children:e},e)))]})}),t.jsx("div",{className:"col-lg-4 col-6",children:t.jsxs("select",{name:"toLine",id:"toLine",className:"form-select",disabled:!g,value:b,onChange:e=>S(e.target.value),children:[t.jsx("option",{value:"",hidden:!0,children:"Sampai Baris"}),D&&Array.from({length:D.lines},((e,a)=>a+1)).map((e=>t.jsx("option",{value:e,children:e},e)))]})}),t.jsx("div",{className:"col-lg-4 col-12 d-flex align-items-center justify-content-lg-start justify-content-end",children:t.jsx("button",{className:"btn btn-sm btn-primary",disabled:!b,onClick:A,children:t.jsx("i",{className:"bi bi-floppy"})})}),t.jsx("div",{className:"col-6",children:t.jsxs("select",{name:"type",id:"type",className:"form-select",value:i||"",onChange:e=>r(e.target.value),children:[t.jsx("option",{value:"",hidden:!0,children:"Jenis Penilaian"}),null==I?void 0:I.map((e=>t.jsx("option",{value:e.id,children:e.name},e.id)))]})}),t.jsx("div",{className:"col-6",children:t.jsxs("select",{name:"examiner",id:"examiner",className:"form-select",value:d||"",onChange:e=>c(e.target.value),children:[t.jsx("option",{value:"",hidden:!0,children:"Penguji"}),null==k?void 0:k.map((e=>t.jsx("option",{value:e.id,children:e.name},e.id)))]})})]})})})},h=()=>{const{data:e}=i();return t.jsx("div",{className:"mt-2 table-responsive rounded-3 border mb-2",children:t.jsxs("table",{className:"table table-striped table-hover mb-0",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Kategori"}),t.jsx("th",{children:"Indikator"}),t.jsx("th",{children:"Poin"})]})}),t.jsx("tbody",{children:null==e?void 0:e.map(((e,a)=>t.jsxs("tr",{children:[t.jsx("td",{className:"align-middle",children:e.name}),t.jsx("td",{className:"align-middle",children:t.jsx("div",{className:"d-flex flex-column gap-2",children:e.indicators.filter((e=>null!==e)).length>0?e.indicators.filter((e=>null!==e)).map(((a,s)=>t.jsxs("div",{className:"d-flex align-items-center justify-content-between p-2 gap-2 rounded border bg-white",children:[t.jsx("p",{className:"m-0",children:a.name}),t.jsx("input",{type:"text",className:"form-control",placeholder:"Penilaian",style:{width:150},"data-indicator-id":a.id,"data-category-id":e.id})]},s))):t.jsx("p",{className:"m-0 text-muted",children:"Tidak ada indikator untuk kategori ini"})})}),t.jsx("td",{className:"align-middle",children:t.jsx("div",{className:"d-flex justify-content-center",children:t.jsx("input",{type:"text",name:"category-score",className:"form-control",placeholder:"Nilai","data-category-id":e.id})})})]},a)))})]})})},u=({data:e,deleteSurah:a})=>t.jsx("div",{style:{maxHeight:500,overflow:"auto"},className:"table-responsive rounded-3 border",children:t.jsxs("table",{className:"table mb-0 table-striped table-hover",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-center",children:"Nama Surat"}),t.jsx("th",{className:"text-center",children:"Dari Ayat"}),t.jsx("th",{className:"text-center",children:"Sampai Ayat"}),t.jsx("th",{className:"text-center",children:"Dari Baris"}),t.jsx("th",{className:"text-center",children:"Sampai Baris"}),t.jsx("th",{className:"text-center",children:"Aksi"})]})}),t.jsx("tbody",{children:(null==e?void 0:e.length)>0?null==e?void 0:e.map(((e,s)=>t.jsxs("tr",{children:[t.jsx("td",{className:"text-center align-middle",children:e.fromSurahName}),t.jsx("td",{className:"text-center align-middle",children:e.fromAyat}),t.jsx("td",{className:"text-center align-middle",children:e.toAyat}),t.jsx("td",{className:"text-center align-middle",children:e.fromLine}),t.jsx("td",{className:"text-center align-middle",children:e.toLine}),t.jsx("td",{className:"text-center align-middle",children:t.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>a(e.fromSurahName),children:t.jsx("i",{className:"bi bi-trash"})})})]},s))):t.jsx("tr",{children:t.jsx("td",{colSpan:6,children:"Data belum tersedia"})})})]})}),x=()=>{const{name:e,userid:a,periodeId:s}=d(),i=e.replace(/-/g," "),[o,x]=n.useState(""),[j,p]=n.useState(""),[v,N]=n.useState({}),[f,g]=n.useState({});let y=null==f?void 0:f.to_ayat;const[b,S]=n.useState(""),[A,L]=n.useState("");let I=null==f?void 0:f.to_line;const[k,_]=n.useState(""),[C,T]=n.useState(""),[w,z]=n.useState([]),[D,{isLoading:J,isSuccess:P,isError:E,reset:B}]=r();return n.useEffect((()=>{(P||E)&&(B(),x(""),p(""),S(""),L(""),_(""),T(""),z([]))}),[P,E]),t.jsx(c,{title:`Hafalan ${i}`,levels:["tahfiz"],children:t.jsx("div",{className:"container-fluid p-3",children:t.jsxs("div",{className:"card shadow-sm",children:[t.jsx("div",{className:"card-header bg-white border-bottom",children:t.jsx("h5",{className:"card-title mb-0",children:i})}),t.jsxs("div",{className:"card-body",children:[t.jsxs("div",{className:"row g-4",children:[t.jsx("div",{className:"col-lg-6",children:t.jsx("div",{className:"d-flex flex-column gap-4",children:t.jsx("div",{className:"card",children:t.jsx("div",{className:"card-body",children:t.jsx(m,{typeId:o,setTypeId:x,examiner:j,setExaminer:p,surah:f,setSelectedSurah:g,setSelectedJuz:N,countAyat:y,fromAyat:b,setFromAyat:S,toAyat:A,setToAyat:L,countLine:I,fromLine:k,setFromLine:_,toLine:C,setToLine:T,addToTable:()=>{z((e=>[...e,{juzId:v.id,fromSurah:f.surah_id,fromSurahName:f.surah,fromAyat:b,toAyat:A,fromLine:k,toLine:C}])),y=0,S(""),L(""),I=0,_(""),T("")},setTableData:z})})})})}),t.jsx("div",{className:"col-lg-6",children:t.jsx("div",{className:"card",children:t.jsx("div",{className:"card-body",children:t.jsx(h,{})})})}),t.jsx("div",{className:"col-12",children:t.jsx("div",{className:"card",children:t.jsx("div",{className:"card-body",children:t.jsx(u,{data:w,deleteSurah:e=>{const a=w.filter((a=>a.fromSurahName!==e));z(a)}})})})})]}),t.jsx("div",{className:"text-end mt-2",children:t.jsxs("button",{className:"btn btn-primary",disabled:0===(null==w?void 0:w.length)||J,onClick:()=>{const e=document.querySelectorAll("[name='category-score']"),t=document.querySelectorAll("input[data-indicator-id]"),i=Array.from(e).map((e=>{const a=e.dataset.categoryId,s=e.value,l=Array.from(t).filter((e=>e.dataset.categoryId===a)).map((e=>({indicator_id:parseInt(e.dataset.indicatorId),poin:e.value})));return{category_id:parseInt(a),poin:s,indicators:l}})),r={userid:parseInt(a),periodeId:parseInt(s),juzId:v.id,surahs:w,examiner:parseInt(j),poin:{type_id:parseInt(o),categories:i}};if(!(o&&j&&w&&i))return l.warning("Lengkapi data");l.promise(D(r).unwrap().then((e=>e.message)),{loading:"Memuat data...",success:e=>e,error:e=>e.data.message}),e.forEach((e=>e.value="")),t.forEach((e=>e.value=""))},children:[J?t.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}):null,"Simpan"]})})]})]})})})};export{x as default};
//# sourceMappingURL=TahfizStudent-C0zfKRIC.js.map
