import{c as e,X as a,Y as s,j as l,d as t,Z as n,_ as i}from"./index-_rzZYDOK.js";import{b as c,u as r}from"./vendor-BB4zGQ0b.js";import{S as d}from"./react-select.esm-CfCICUSq.js";import{T as o}from"./Table-Pbg_IZUs.js";const m=({detail:n,setDetail:i})=>{var r;const{user:o}=e((e=>e.auth)),[m,u]=c.useState({id:"",teacher:(null==o?void 0:o.id)||null,subject:null,btype:"",name:""}),{data:b}=a(),[h,{isSuccess:j,isLoading:x,isError:p,reset:g}]=s(),v=null==b?void 0:b.map((e=>({value:e.id,label:e.name,subjects:e.subjects}))),N=null==b?void 0:b.find((e=>e.id===m.teacher)),f=(null==(r=null==N?void 0:N.subjects)?void 0:r.map((e=>({value:e.id,label:e.name}))))||[],S=e=>{const{name:a,value:s}=e.target;u((e=>({...e,[a]:s})))};return c.useEffect((()=>{(j||p)&&(u({id:"",teacher:(null==o?void 0:o.id)||null,btype:"",subject:null,name:""}),g())}),[j,p,o]),c.useEffect((()=>{n&&u({id:n.id,teacher:n.teacher||(null==o?void 0:o.id)||null,subject:n.subject,name:n.name,btype:n.btype})}),[n,o]),l.jsxs("form",{onSubmit:e=>{e.preventDefault(),t.promise(h(m).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message})},className:"bg-white p-2 rounded d-flex flex-column gap-2 border",children:[l.jsx("p",{className:"m-0 h6",children:"Bank Soal"}),l.jsx(d,{isClearable:!0,isSearchable:!0,placeholder:"Cari Guru",value:(null==v?void 0:v.find((e=>e.value===m.teacher)))||null,options:v,onChange:e=>{u((a=>({...a,teacher:(null==e?void 0:e.value)||null,subject:null})))}}),l.jsx(d,{isClearable:!0,isSearchable:!0,placeholder:"Pilih Mata Pelajaran",value:(null==f?void 0:f.find((e=>e.value===m.subject)))||null,options:f,onChange:e=>{u((a=>({...a,subject:(null==e?void 0:e.value)||null})))},isDisabled:!m.teacher}),l.jsxs("select",{name:"btype",id:"btype",className:"form-select",value:m.btype,onChange:S,children:[l.jsx("option",{value:"",hidden:!0,children:"Jenis Bank Soal"}),l.jsx("option",{value:"bank",children:"Bank"}),l.jsx("option",{value:"paket",children:"Paket"})]}),l.jsx("input",{name:"name",className:"form-control",placeholder:"Nama Bank Soal",value:m.name,onChange:S}),l.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-sm btn-warning",onClick:()=>{i({}),u({id:"",teacher:(null==o?void 0:o.id)||null,subject:null,btype:"",name:""})},children:"Batal"}),l.jsx("button",{type:"submit",className:"btn btn-sm btn-success",children:"Simpan"})]})]})},u=({setDetail:e})=>{const a=r(),[s,d]=c.useState(1),[m,u]=c.useState(10),[b,h]=c.useState(""),{data:j={},isLoading:x}=n({page:s,limit:m,search:b}),{banks:p=[],totalData:g,totalPages:v}=j,[N,{isLoading:f}]=i();return l.jsx(o,{page:s,setPage:d,setLimit:u,setSearch:h,totalData:g,totalPages:v,isLoading:x,children:l.jsxs("table",{className:"table table-bordered table-striped table-hover m-0",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-center",children:"No"}),l.jsx("th",{className:"text-center",children:"Guru"}),l.jsx("th",{className:"text-center",children:"Mata Pelajaran"}),l.jsx("th",{className:"text-center",children:"Bank Soal"}),l.jsx("th",{className:"text-center",children:"Jenis"}),l.jsx("th",{className:"text-center",children:"Soal"}),l.jsx("th",{className:"text-center",children:"Aksi"})]})}),l.jsx("tbody",{children:(null==p?void 0:p.length)>0?null==p?void 0:p.map(((n,i)=>l.jsxs("tr",{children:[l.jsx("td",{className:"text-center align-middle",children:(s-1)*m+i+1}),l.jsx("td",{className:"align-middle",children:n.teacher_name}),l.jsx("td",{className:"align-middle",children:n.subject_name}),l.jsx("td",{className:"align-middle",children:n.name}),l.jsx("td",{className:"text-center align-middle",children:l.jsx("p",{className:"m-0 badge bg-success",children:n.btype.toUpperCase()})}),l.jsx("td",{className:"text-center align-middle",children:l.jsx("p",{className:"m-0 badge bg-secondary",children:`${n.question_count} Soal`})}),l.jsx("td",{className:"text-center align-middle",children:l.jsxs("div",{className:"d-flex justify-content-center gap-1",children:[l.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>((e,s,l)=>{const t=s.replace(/[\s/]/g,"-"),n=e.replace(/[\s/]/g,"-");a(`/admin-cbt-bank/${n}/${t}/${l}`)})(n.subject_name,n.name,n.id),children:l.jsx("i",{className:"bi bi-folder-fill"})}),l.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>e(n),children:l.jsx("i",{className:"bi bi-pencil-square"})}),l.jsx("button",{className:"btn btn-sm btn-danger",disabled:f,onClick:()=>{return e=n.id,void t.promise(N(e).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message});var e},children:l.jsx("i",{className:"bi bi-folder-minus"})})]})})]},i))):l.jsx("tr",{children:l.jsx("td",{colSpan:7,children:"Data belum tersedia"})})})]})})},b=()=>{const[e,a]=c.useState("");return l.jsxs("div",{className:"row g-2",children:[l.jsx("div",{className:"col-lg-3 col-12",children:l.jsx(m,{detail:e,setDetail:a})}),l.jsx("div",{className:"col-lg-9 col-12",children:l.jsx(u,{setDetail:a})})]})};export{b as C};
//# sourceMappingURL=CbtBank-tNIxxq9k.js.map
