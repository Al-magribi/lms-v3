import{E as e,F as a,j as l,m as s,e as t}from"./index-DFhdulld.js";import{b as r}from"./vendor-CnnDPxwB.js";import{L as n}from"./Layout-BdxnsoD5.js";import{C as i}from"./CmsForm-CjFKk7X5.js";import{v as o,w as d,x as c}from"./index-B8CuzAwO.js";const m=()=>{const[m,p]=r.useState(null),[u,x]=r.useState(!0),[g,f]=r.useState(null),[h,y]=r.useState(null),[b,j]=r.useState("#0d6efd"),[v,N]=r.useState("#cfe2ff"),{data:S,isLoading:w,refetch:C,error:_}=e(),[k,{isLoading:L,isSuccess:F,isError:P,error:E,reset:I,data:D}]=a();r.useEffect((()=>{S&&(p(S),f(S.logo),j(S.primary_color||"#0d6efd"),N(S.secondary_color||"#cfe2ff"),x(!1))}),[S]);const R=async e=>{const a=(e=>{const a=parseInt(e.slice(1,3),16),l=parseInt(e.slice(3,5),16),s=parseInt(e.slice(5,7),16),t=.85,r=Math.round(a*(1-t)+216.75),n=Math.round(l*(1-t)+216.75),i=Math.round(s*(1-t)+216.75);return`#${r.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}`})(e);if(m)try{const l=new FormData;Object.entries({...m,primary_color:e,secondary_color:a}).forEach((([e,a])=>{"logo"!==e&&l.append(e,a)})),h?l.append("logo",h):m.logo&&l.append("logo",m.logo),await k(l).unwrap(),t.success("Warna berhasil diperbarui!")}catch(l){t.error("Gagal memperbarui warna")}};r.useEffect((()=>{F&&(I(),C(),window.location.reload(),y(null)),P&&I()}),[F,P,D,E,C,I]);return l.jsx(n,{title:"Pengaturan",levels:["cms"],children:l.jsx("div",{className:"container-fluid py-3 py-md-4",children:l.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[l.jsxs("div",{className:"d-flex align-items-center mb-4",children:[l.jsx("div",{style:{backgroundColor:null==S?void 0:S.secondary_color,color:null==S?void 0:S.primary_color},className:" p-3 rounded me-3",children:l.jsx(o,{className:"fs-4"})}),l.jsx("h4",{className:"mb-0",children:"Pengaturan"})]}),l.jsx("div",{className:"card border-0 shadow-sm",children:l.jsxs("div",{className:"card-body",children:[u||w||L?l.jsxs("div",{className:"text-center py-5",children:[l.jsx("div",{className:"spinner-border text-primary",role:"status",children:l.jsx("span",{className:"visually-hidden",children:"Loading..."})}),l.jsx("p",{className:"mt-2",children:"Loading settings..."})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"form-label",children:"Logo"}),l.jsxs("div",{className:"d-flex align-items-center gap-3",children:[l.jsx("input",{type:"file",className:"form-control",accept:"image/*",onChange:e=>{const a=e.target.files[0];a&&(y(a),f(URL.createObjectURL(a)))}}),g&&l.jsx("img",{src:g,alt:"Logo preview",style:{maxHeight:"100px",objectFit:"contain"},className:"border rounded p-2"})]})]}),l.jsx(i,{fields:[{name:"name",label:"Site Name",type:"text",required:!0},{name:"tagline",label:"Tagline",type:"text",required:!0},{name:"description",label:"Description",type:"textarea",required:!0},{name:"video_url",label:"Video URL",type:"text"},{name:"youtube",label:"YouTube",type:"text"},{name:"instagram",label:"Instagram",type:"text"},{name:"facebook",label:"Facebook",type:"text"},{name:"ppdb_url",label:"PPDB URL",type:"text"},{name:"address",label:"Alamat",type:"text"},{name:"title_reason",label:"Judul Alasan",type:"text"},{name:"desc_reason",label:"Deskripsi Alasan",type:"textarea"},{name:"title_facility",label:"Judul Fasilitas",type:"text"},{name:"desc_facility",label:"Deskripsi Fasilitas",type:"textarea"}],initialValues:m,onSubmit:async e=>{try{const a=new FormData,l={...e,primary_color:b,secondary_color:v};Object.keys(l).forEach((e=>{"logo"!==e&&a.append(e,l[e])})),h?a.append("logo",h):(null==S?void 0:S.logo)&&a.append("logo",S.logo),t.promise(k(a).unwrap().then((e=>e.message)),{loading:"Menyimpan pengaturan...",success:e=>e,error:e=>{var a;return(null==(a=null==e?void 0:e.data)?void 0:a.message)||"Gagal menyimpan pengaturan"}})}catch(a){console.error("Error in handleSubmit:",a),t.error("Terjadi kesalahan saat menyimpan pengaturan")}},submitButtonText:"Simpan",submitButtonIcon:l.jsx(d,{className:"me-2"})})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("h4",{children:"Pengaturan Warna"}),l.jsxs("div",{className:"mt-4",children:[l.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[l.jsx("label",{className:"form-label mb-0",children:"Primary Color"}),l.jsx("div",{className:"d-flex align-items-center gap-2",children:l.jsx("div",{className:"rounded-circle",style:{backgroundColor:v,width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid #dee2e6"},children:l.jsx(c,{style:{color:b},className:"fs-4"})})})]}),l.jsx("div",{className:"d-flex flex-wrap gap-2",children:[{name:"Blue",value:"#0d6efd",light:"#cfe2ff"},{name:"Indigo",value:"#6610f2",light:"#e0cffc"},{name:"Purple",value:"#6f42c1",light:"#e2d9f3"},{name:"Pink",value:"#d63384",light:"#f7d6e6"},{name:"Red",value:"#dc3545",light:"#f8d7da"},{name:"Orange",value:"#fd7e14",light:"#ffe5d0"},{name:"Yellow",value:"#ffc107",light:"#fff3cd"},{name:"Green",value:"#198754",light:"#d1e7dd"},{name:"Teal",value:"#20c997",light:"#d2f4ea"},{name:"Cyan",value:"#0dcaf0",light:"#cff4fc"}].map((e=>l.jsx("div",{className:"rounded-circle",style:{backgroundColor:e.value,width:"30px",height:"30px",border:"2px solid #dee2e6",cursor:"pointer"},onClick:()=>R(e.value),title:e.name},e.name)))}),l.jsx("div",{className:"mt-3",children:l.jsx("input",{type:"color",className:"form-control form-control-color",value:b,onChange:e=>R(e.target.value),title:"Choose your color"})}),l.jsx("div",{className:"mt-3",children:l.jsxs("small",{className:"text-muted",children:["Selected Colors:",l.jsxs("div",{className:"d-flex gap-2 mt-1",children:[l.jsxs("div",{className:"d-flex align-items-center",children:[l.jsx("div",{className:"rounded-circle me-1",style:{backgroundColor:b,width:"20px",height:"20px",border:"1px solid #dee2e6"}}),"Primary: ",b]}),l.jsxs("div",{className:"d-flex align-items-center",children:[l.jsx("div",{className:"rounded-circle me-1",style:{backgroundColor:v,width:"20px",height:"20px",border:"1px solid #dee2e6"}}),"Secondary: ",v]})]})]})})]})]})]})})]})})})};export{m as default};
//# sourceMappingURL=SettingsPage-BAQgLQmR.js.map
