import{j as s,u as a,a as e,aw as i,O as l,s as d,V as r}from"./index-CNbAajcm.js";import{b as c}from"./vendor-BYWiIb5-.js";import{L as n}from"./Layout-_SAc74nU.js";import"./index-C-OX0RB-.js";import"./index-DLmIb9aI.js";const m=({user:a,isEditing:e,setIsEditing:i})=>s.jsxs("div",{className:"card-header bg-info d-flex justify-content-between align-items-center",children:[s.jsxs("h4",{className:"mb-0",children:[s.jsx("i",{className:"bi bi-person-circle me-2"}),"Informasi Profile"]}),s.jsxs("button",{className:"btn btn-light btn-sm",onClick:()=>i(!e),children:[s.jsx("i",{className:`bi bi-${e?"x-lg":"pencil"} me-1`}),e?"Cancel":"Edit Profile"]})]}),o=({user:a})=>s.jsx("div",{style:{width:100,height:100},className:"rounded-circle bg-light d-flex justify-content-center align-items-center",children:(null==a?void 0:a.img)?s.jsx("img",{src:a.img,alt:a.name,className:"rounded-circle",style:{width:"100%",height:"100%",objectFit:"cover"}}):s.jsx("i",{className:"bi bi-person-badge display-5 text-info"})}),t=({formData:a,handleInputChange:e,handleSubmit:i,isLoading:l})=>s.jsxs("form",{onSubmit:i,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label",children:"Name"}),s.jsx("input",{type:"text",className:"form-control",name:"name",value:a.name,onChange:e})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label",children:"Email"}),s.jsx("input",{type:"email",className:"form-control",name:"email",value:a.email,onChange:e})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label",children:"Whatsapp"}),s.jsx("input",{type:"text",className:"form-control",name:"phone",value:a.phone,onChange:e})]}),s.jsxs("button",{type:"submit",className:"btn btn-info",disabled:l,children:[s.jsx("i",{className:"bi bi-save me-1"}),l?"Loading...":"Simpan Perubahan"]})]}),h=({user:a})=>s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-md-6 mb-3",children:s.jsx("div",{className:"card h-100",children:s.jsxs("div",{className:"card-body",children:[s.jsxs("h5",{className:"card-title",children:[s.jsx("i",{className:"bi bi-envelope me-2 text-primary"}),"Email"]}),s.jsx("p",{className:"card-text",children:(null==a?void 0:a.email)||"Tidak tersedia"})]})})}),s.jsx("div",{className:"col-md-6 mb-3",children:s.jsx("div",{className:"card h-100",children:s.jsxs("div",{className:"card-body",children:[s.jsxs("h5",{className:"card-title",children:[s.jsx("i",{className:"bi bi-telephone me-2 text-primary"}),"Whatsapp"]}),s.jsx("p",{className:"card-text",children:(null==a?void 0:a.phone)||"Tidak tersedia"})]})})}),s.jsx("div",{className:"col-md-6 mb-3",children:s.jsx("div",{className:"card h-100",children:s.jsxs("div",{className:"card-body",children:[s.jsxs("h5",{className:"card-title",children:[s.jsx("i",{className:"bi bi-building me-2 text-primary"}),"Satuan"]}),s.jsx("p",{className:"card-text",children:(null==a?void 0:a.homebase)||"Tidak tersedia"})]})})}),s.jsx("div",{className:"col-md-6 mb-3",children:s.jsx("div",{className:"card h-100",children:s.jsxs("div",{className:"card-body",children:[s.jsxs("h5",{className:"card-title",children:[s.jsx("i",{className:"bi bi-gender-ambiguous me-2 text-primary"}),"Jenis Kelamin"]}),s.jsx("p",{className:"card-text",children:"L"===(null==a?void 0:a.gender)?"Laki-laki":"Perempuan"})]})})}),s.jsx("div",{className:"col-md-6 mb-3",children:s.jsx("div",{className:"card h-100",children:s.jsxs("div",{className:"card-body",children:[s.jsxs("h5",{className:"card-title",children:[s.jsx("i",{className:"bi bi-people me-2 text-primary"}),"Status Wali Kelas"]}),s.jsx("p",{className:"card-text",children:(null==a?void 0:a.homeroom)?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"badge bg-success me-2",children:"Wali Kelas"}),(null==a?void 0:a.class)||"Tidak tersedia"]}):s.jsx("span",{className:"badge bg-secondary",children:"Bukan Wali Kelas"})})]})})}),s.jsx("div",{className:"col-md-6 mb-3",children:s.jsx("div",{className:"card h-100",children:s.jsxs("div",{className:"card-body",children:[s.jsxs("h5",{className:"card-title",children:[s.jsx("i",{className:"bi bi-key me-2 text-primary"}),"Activation ID"]}),s.jsx("p",{className:"card-text small",children:(null==a?void 0:a.activation)||"Tidak tersedia"})]})})})]}),x=({subjects:a})=>s.jsxs("div",{className:"card shadow mb-4",children:[s.jsx("div",{className:"card-header bg-primary text-white",children:s.jsxs("h4",{className:"mb-0",children:[s.jsx("i",{className:"bi bi-book me-2"}),"Mata Pelajaran"]})}),s.jsx("div",{className:"card-body",children:a&&a.length>0?s.jsx("div",{className:"row",children:a.map((a=>s.jsx("div",{className:"col-md-6 mb-3",children:s.jsx("div",{className:"card h-100",children:s.jsx("div",{className:"card-body",children:s.jsxs("div",{className:"d-flex align-items-center",children:[a.cover&&s.jsx("img",{src:a.cover,alt:a.name,className:"me-3",style:{width:60,height:80,objectFit:"cover",borderRadius:"5px"}}),s.jsx("h5",{className:"card-title mb-0",children:a.name})]})})})},a.id)))}):s.jsx("p",{className:"text-center",children:"Tidak ada mata pelajaran yang ditugaskan"})})]}),b=({formData:a,handleInputChange:e,handleSubmit:i,showPasswords:l,togglePasswordVisibility:d})=>s.jsxs("div",{className:"card shadow",children:[s.jsx("div",{className:"card-header bg-warning text-dark",children:s.jsxs("h4",{className:"mb-0",children:[s.jsx("i",{className:"bi bi-shield-lock me-2"}),"Ubah Password"]})}),s.jsx("div",{className:"card-body",children:s.jsxs("form",{onSubmit:i,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label",children:"Password Lama"}),s.jsxs("div",{className:"input-group",children:[s.jsx("input",{type:l.oldPassword?"text":"password",className:"form-control",name:"oldPassword",value:a.oldPassword,onChange:e,placeholder:"Masukkan password lama"}),s.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>d("oldPassword"),children:s.jsx("i",{className:"bi bi-eye"+(l.oldPassword?"-slash":"")})})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label",children:"Password Baru"}),s.jsxs("div",{className:"input-group",children:[s.jsx("input",{type:l.newPassword?"text":"password",className:"form-control",name:"newPassword",value:a.newPassword,onChange:e,placeholder:"Masukkan password baru"}),s.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>d("newPassword"),children:s.jsx("i",{className:"bi bi-eye"+(l.newPassword?"-slash":"")})})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label",children:"Konfirmasi Password Baru"}),s.jsxs("div",{className:"input-group",children:[s.jsx("input",{type:l.confirmPassword?"text":"password",className:"form-control",name:"confirmPassword",value:a.confirmPassword,onChange:e,placeholder:"Konfirmasi password baru"}),s.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>d("confirmPassword"),children:s.jsx("i",{className:"bi bi-eye"+(l.confirmPassword?"-slash":"")})})]})]}),s.jsxs("button",{type:"submit",className:"btn btn-warning",children:[s.jsx("i",{className:"bi bi-key me-1"}),"Ubah Password"]})]})})]}),j=()=>{const j=a(),{user:u}=e((s=>s.auth)),[N,p]=c.useState(!1),[w,v]=c.useState({oldPassword:!1,newPassword:!1,confirmPassword:!1}),[g,f]=c.useState({name:"",email:"",phone:"",oldPassword:"",newPassword:"",confirmPassword:""}),[P,{isLoading:y,isSuccess:k,isError:C,reset:S}]=i(),[E]=l(),L=s=>{const{name:a,value:e}=s.target;if("phone"===a){const s=e.replace(/\D/g,""),i=s.startsWith("0")?"62"+s.substring(1):s;f((s=>({...s,[a]:i})))}else f((s=>({...s,[a]:e})))},I=s=>{if(s.preventDefault(),g.newPassword||g.confirmPassword||g.oldPassword){if(g.newPassword!==g.confirmPassword)return void r.error("Password baru tidak cocok!");if(!g.oldPassword)return void r.error("Password lama harus diisi!")}const a={name:g.name,email:g.email,phone:g.phone};g.newPassword&&(a.oldPassword=g.oldPassword,a.newPassword=g.newPassword),r.promise(P(a).unwrap().then((s=>s.message)),{loading:"Memperbarui profil...",success:s=>s,error:s=>s.data.message})};return c.useEffect((()=>{k&&(f({name:"",email:"",phone:"",oldPassword:"",newPassword:"",confirmPassword:""}),p(!1),S(),E().unwrap().then((s=>{j(d(s))})).catch((s=>{r.error("Gagal memuat data pengguna"),console.error("Error: ",s)}))),C&&S()}),[k,C,j,E]),c.useEffect((()=>{u&&f({name:(null==u?void 0:u.name)||"",email:(null==u?void 0:u.email)||"",phone:(null==u?void 0:u.phone)||"",oldPassword:"",newPassword:"",confirmPassword:""})}),[u]),s.jsx(n,{title:"Profile",levels:["teacher"],children:s.jsx("div",{className:"container-fluid",children:s.jsxs("div",{className:"row justify-content-center",children:[s.jsx("div",{className:"col-md-6 col-12",children:s.jsxs("div",{className:"card shadow mb-4",children:[s.jsx(m,{user:u,isEditing:N,setIsEditing:p}),s.jsxs("div",{className:"card-body",children:[s.jsxs("div",{className:"row mb-4",children:[s.jsx("div",{className:"col-md-4 d-flex justify-content-center align-items-center",children:s.jsx(o,{user:u})}),s.jsx("div",{className:"col-md-8",children:N?s.jsx(t,{formData:g,handleInputChange:L,handleSubmit:I,isLoading:y}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"mb-3",children:null==u?void 0:u.name}),s.jsxs("span",{className:"badge bg-success mb-2",children:[s.jsx("i",{className:"bi bi-check-circle me-1"}),null==u?void 0:u.level]}),(null==u?void 0:u.isactive)?s.jsxs("span",{className:"badge bg-success ms-2",children:[s.jsx("i",{className:"bi bi-check-circle me-1"}),"Aktif"]}):s.jsxs("span",{className:"badge bg-danger ms-2",children:[s.jsx("i",{className:"bi bi-x-circle me-1"}),"Nonaktif"]})]})})]}),!N&&s.jsx(h,{user:u})]})]})}),s.jsxs("div",{className:"col-md-6 col-12",children:[s.jsx(x,{subjects:null==u?void 0:u.subjects}),s.jsx(b,{formData:g,handleInputChange:L,handleSubmit:I,showPasswords:w,togglePasswordVisibility:s=>{v((a=>({...a,[s]:!a[s]})))}})]})]})})})};export{j as default};
//# sourceMappingURL=TeacherProfile-D7IfOv8C.js.map
