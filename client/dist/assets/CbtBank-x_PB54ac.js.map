{"version":3,"file":"CbtBank-x_PB54ac.js","sources":["../../src/page/cbt/bank/Form.jsx","../../src/page/cbt/bank/TableBank.jsx","../../src/page/cbt/bank/CbtBank.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  useAddBankMutation,\r\n  useGetTeachersQuery,\r\n} from \"../../../controller/api/cbt/ApiBank\";\r\nimport Select from \"react-select\";\r\nimport { toast } from \"react-hot-toast\";\r\nimport { useSelector } from \"react-redux\";\r\n\r\nconst Form = ({ detail, setDetail }) => {\r\n  const { user } = useSelector((state) => state.auth);\r\n\r\n  const [formData, setFormData] = useState({\r\n    id: \"\",\r\n    teacher: user?.id || null,\r\n    subject: null,\r\n    btype: \"\",\r\n    name: \"\",\r\n  });\r\n\r\n  const { data: teachers } = useGetTeachersQuery();\r\n  const [addBank, { isSuccess, isLoading, isError, reset }] =\r\n    useAddBankMutation();\r\n\r\n  const teacherOptions = teachers?.map((teacher) => ({\r\n    value: teacher.id,\r\n    label: teacher.name,\r\n    subjects: teacher.subjects,\r\n  }));\r\n\r\n  const selectedTeacher = teachers?.find((t) => t.id === formData.teacher);\r\n\r\n  const subjectOptions =\r\n    selectedTeacher?.subjects?.map((subject) => ({\r\n      value: subject.id,\r\n      label: subject.name,\r\n    })) || [];\r\n\r\n  const handleTeacherChange = (selectedOption) => {\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      teacher: selectedOption?.value || null,\r\n      subject: null,\r\n    }));\r\n  };\r\n\r\n  const handleSubjectChange = (selectedOption) => {\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      subject: selectedOption?.value || null,\r\n    }));\r\n  };\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      [name]: value,\r\n    }));\r\n  };\r\n\r\n  const addHandler = (e) => {\r\n    e.preventDefault();\r\n\r\n    toast.promise(\r\n      addBank(formData)\r\n        .unwrap()\r\n        .then((res) => res.message),\r\n      {\r\n        loading: \"Memproses...\",\r\n        success: (message) => message,\r\n        error: (err) => err.data.message,\r\n      }\r\n    );\r\n  };\r\n\r\n  const cancel = () => {\r\n    setDetail({});\r\n    setFormData({\r\n      id: \"\",\r\n      teacher: user?.id || null,\r\n      subject: null,\r\n      btype: \"\",\r\n      name: \"\",\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isSuccess || isError) {\r\n      setFormData({\r\n        id: \"\",\r\n        teacher: user?.id || null,\r\n        btype: \"\",\r\n        subject: null,\r\n        name: \"\",\r\n      });\r\n      reset();\r\n    }\r\n  }, [isSuccess, isError, user]);\r\n\r\n  useEffect(() => {\r\n    if (detail) {\r\n      setFormData({\r\n        id: detail.id,\r\n        teacher: detail.teacher || user?.id || null,\r\n        subject: detail.subject,\r\n        name: detail.name,\r\n        btype: detail.btype,\r\n      });\r\n    }\r\n  }, [detail, user]);\r\n\r\n  return (\r\n    <form\r\n      onSubmit={addHandler}\r\n      className='bg-white p-2 rounded d-flex flex-column gap-2 border'>\r\n      <p className='m-0 h6'>Bank Soal</p>\r\n\r\n      <Select\r\n        isClearable\r\n        isSearchable\r\n        placeholder='Cari Guru'\r\n        value={\r\n          teacherOptions?.find((opt) => opt.value === formData.teacher) || null\r\n        }\r\n        options={teacherOptions}\r\n        onChange={handleTeacherChange}\r\n      />\r\n\r\n      <Select\r\n        isClearable\r\n        isSearchable\r\n        placeholder='Pilih Mata Pelajaran'\r\n        value={\r\n          subjectOptions?.find((opt) => opt.value === formData.subject) || null\r\n        }\r\n        options={subjectOptions}\r\n        onChange={handleSubjectChange}\r\n        isDisabled={!formData.teacher}\r\n      />\r\n\r\n      <select\r\n        name='btype'\r\n        id='btype'\r\n        className='form-select'\r\n        value={formData.btype}\r\n        onChange={handleInputChange}>\r\n        <option value='' hidden>\r\n          Jenis Bank Soal\r\n        </option>\r\n        <option value='bank'>Bank</option>\r\n        <option value='paket'>Paket</option>\r\n      </select>\r\n\r\n      <input\r\n        name='name'\r\n        className='form-control'\r\n        placeholder='Nama Bank Soal'\r\n        value={formData.name}\r\n        onChange={handleInputChange}\r\n      />\r\n\r\n      <div className='d-flex justify-content-end gap-2'>\r\n        <button\r\n          type='button'\r\n          className='btn btn-sm btn-warning'\r\n          onClick={cancel}>\r\n          Batal\r\n        </button>\r\n        <button type='submit' className='btn btn-sm btn-success'>\r\n          Simpan\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default Form;\r\n","import { useState } from \"react\";\r\nimport Table from \"../../../components/table/Table\";\r\nimport {\r\n  useDeleteBankMutation,\r\n  useGetBankQuery,\r\n} from \"../../../controller/api/cbt/ApiBank\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { toast } from \"react-hot-toast\";\r\n\r\nconst TableBank = ({ setDetail }) => {\r\n  const navigate = useNavigate();\r\n\r\n  const [page, setPage] = useState(1);\r\n  const [limit, setLimit] = useState(10);\r\n  const [search, setSearch] = useState(\"\");\r\n\r\n  const { data: rawData = {}, isLoading: dataLoading } = useGetBankQuery({\r\n    page,\r\n    limit,\r\n    search,\r\n  });\r\n  const { banks = [], totalData, totalPages } = rawData;\r\n  const [deleteBank, { isLoading }] = useDeleteBankMutation();\r\n\r\n  const deleteHandler = (id) => {\r\n    const confirm = window.confirm(\r\n      \"Apakah anda yakin ingin menghapus bank soal ini dan semua data yang terkait dengan bank soal ini?\"\r\n    );\r\n    if (confirm) {\r\n      toast.promise(\r\n        deleteBank(id)\r\n          .unwrap()\r\n          .then((res) => res.message),\r\n        {\r\n          loading: \"Memproses...\",\r\n          success: (message) => message,\r\n          error: (err) => err.data.message,\r\n        }\r\n      );\r\n    }\r\n  };\r\n\r\n  const goToLink = (subject, name, id) => {\r\n    const nameFormat = name.replace(/[\\s/]/g, \"-\");\r\n    const subjectFormat = subject.replace(/[\\s/]/g, \"-\");\r\n    navigate(`/admin-cbt-bank/${subjectFormat}/${nameFormat}/${id}`);\r\n  };\r\n\r\n  return (\r\n    <Table\r\n      page={page}\r\n      setPage={setPage}\r\n      setLimit={setLimit}\r\n      setSearch={setSearch}\r\n      totalData={totalData}\r\n      totalPages={totalPages}\r\n      isLoading={dataLoading}\r\n    >\r\n      <table className=\"table table-bordered table-striped table-hover m-0\">\r\n        <thead>\r\n          <tr>\r\n            <th className=\"text-center\">No</th>\r\n            <th className=\"text-center\">Guru</th>\r\n            <th className=\"text-center\">Mata Pelajaran</th>\r\n            <th className=\"text-center\">Bank Soal</th>\r\n            <th className=\"text-center\">Jenis</th>\r\n            <th className=\"text-center\">Soal</th>\r\n            <th style={{ width: 250 }} className=\"text-center\">\r\n              Aksi\r\n            </th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {banks?.length > 0 ? (\r\n            banks?.map((item, i) => (\r\n              <tr key={i}>\r\n                <td className=\"text-center align-middle\">\r\n                  {(page - 1) * limit + i + 1}\r\n                </td>\r\n                <td className=\"align-middle\">{item.teacher_name}</td>\r\n                <td className=\"align-middle\">{item.subject_name}</td>\r\n                <td className=\"align-middle\">{item.name}</td>\r\n                <td className=\"text-center align-middle\">\r\n                  <p className=\"m-0 badge bg-success\">\r\n                    {item.btype.toUpperCase()}\r\n                  </p>\r\n                </td>\r\n                <td className=\"text-center align-middle\">\r\n                  <p className=\"m-0 badge bg-secondary\">\r\n                    {`${item.question_count} Soal`}\r\n                  </p>\r\n                </td>\r\n                <td className=\"text-center align-middle\">\r\n                  <div className=\"d-flex justify-content-center gap-1\">\r\n                    <button\r\n                      className=\"btn btn-sm btn-primary\"\r\n                      onClick={() =>\r\n                        goToLink(item.subject_name, item.name, item.id)\r\n                      }\r\n                    >\r\n                      <i className=\"bi bi-folder-fill\"></i>\r\n                      <span className=\"ms-2\">Lihat</span>\r\n                    </button>\r\n                    <button\r\n                      className=\"btn btn-sm btn-warning\"\r\n                      onClick={() => setDetail(item)}\r\n                    >\r\n                      <i className=\"bi bi-pencil-square\"></i>\r\n                      <span className=\"ms-2\">Edit </span>\r\n                    </button>\r\n                    <button\r\n                      className=\"btn btn-sm btn-danger\"\r\n                      disabled={isLoading}\r\n                      onClick={() => deleteHandler(item.id)}\r\n                    >\r\n                      <i className=\"bi bi-folder-minus\"></i>\r\n                      <span className=\"ms-2\">Hapus</span>\r\n                    </button>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            ))\r\n          ) : (\r\n            <tr>\r\n              <td colSpan={7}>Data belum tersedia</td>\r\n            </tr>\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </Table>\r\n  );\r\n};\r\n\r\nexport default TableBank;\r\n","import React, { useState } from \"react\"\r\nimport Form from \"./Form\"\r\nimport TableBank from \"./TableBank\"\r\n\r\nconst CbtBank = () => {\r\n\tconst [detail, setDetail] = useState(\"\")\r\n\treturn (\r\n\t\t<div className='row g-2'>\r\n\t\t\t<div className='col-lg-3 col-12'>\r\n\t\t\t\t<Form detail={detail} setDetail={setDetail} />\r\n\t\t\t</div>\r\n\t\t\t<div className='col-lg-9 col-12'>\r\n\t\t\t\t<TableBank setDetail={setDetail} />\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default CbtBank\r\n"],"names":["Form","detail","setDetail","user","useSelector","state","auth","formData","setFormData","useState","id","teacher","subject","btype","name","data","teachers","useGetTeachersQuery","addBank","isSuccess","isLoading","isError","reset","useAddBankMutation","teacherOptions","map","value","label","subjects","selectedTeacher","find","t","subjectOptions","_a","handleInputChange","e","target","prev","useEffect","jsxRuntimeExports","jsxs","onSubmit","preventDefault","c","promise","unwrap","then","res","message","loading","success","error","err","className","children","jsx","Select","isClearable","isSearchable","placeholder","opt","options","onChange","selectedOption","isDisabled","hidden","type","onClick","TableBank","navigate","useNavigate","page","setPage","limit","setLimit","search","setSearch","rawData","dataLoading","useGetBankQuery","banks","totalData","totalPages","deleteBank","useDeleteBankMutation","Table","style","width","length","item","i","teacher_name","subject_name","toUpperCase","question_count","nameFormat","replace","subjectFormat","goToLink","disabled","deleteHandler","window","confirm","colSpan","CbtBank"],"mappings":"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"}