import{ai as e,j as a,d as s,a7 as t,b as n,aj as l}from"./index-CNbAajcm.js";import{b as r,u as i}from"./vendor-BYWiIb5-.js";import{L as c}from"./Layout-_SAc74nU.js";import{T as d}from"./Table-BSwODE4h.js";import"./index-C-OX0RB-.js";import"./index-DLmIb9aI.js";const o=({detail:t,setDetail:n})=>{const[l,i]=r.useState(""),[c,d]=r.useState(""),[o,m]=r.useState(null),u=r.useRef(null),[x,{isSuccess:h,isLoading:j,isError:p,reset:g}]=e();return r.useEffect((()=>{t&&(i(t.id),d(t.name))}),[t]),r.useEffect((()=>{(h||p)&&(g(),n({}),i(""),d(""),u.current&&(u.current.value=null))}),[h,p]),a.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!c)return s.error("Lengkapi data");const a=new FormData;a.append("id",l||""),a.append("name",c),a.append("cover",o),s.promise(x(a).unwrap().then((e=>e.message)),{loading:"Meyimpan data...",success:e=>e,error:e=>e.data.message})},className:"rounded border p-2 bg-white d-flex flex-column gap-2",children:[a.jsx("p",{className:"m-0 h6",children:"Mata Pelajaran"}),a.jsx("input",{type:"text",name:"name",id:"name",className:"form-control",placeholder:"Nama Mata Pelajaran",value:c||"",onChange:e=>d(e.target.value)}),a.jsxs("div",{className:"input-group",children:[a.jsx("input",{type:"file",className:"form-control",id:"inputGroupFile02",ref:u,onChange:e=>m(e.target.files[0])}),a.jsx("label",{className:"input-group-text",htmlFor:"inputGroupFile02",children:"Cover"})]}),a.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-sm btn-warning",onClick:()=>{n({}),i(""),d(""),u.current&&(u.current.value=null)},children:"Batal"}),a.jsx("button",{type:"submit",className:"btn btn-sm btn-success",disabled:j,children:"Simpan"})]})]})},m=({setDetail:e})=>{const c=i(),[o,m]=r.useState(1),[u,x]=r.useState(10),[h,j]=r.useState(""),{data:p={},isLoading:g}=t({page:o,limit:u,search:h}),{data:b}=n(),{totalData:N,totalPages:f,subjects:v=[]}=p,[y,{isSuccess:S,isLoading:w,isError:k,reset:D}]=l();return r.useEffect((()=>{(S||k)&&D()}),[S,k]),a.jsx(d,{page:o,setPage:m,setLimit:x,setSearch:j,totalData:N,totalPages:f,isLoading:g,children:a.jsxs("table",{className:"table table-bordered table-hover",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-center",children:"No"}),a.jsx("th",{className:"text-center",children:"Cover"}),a.jsx("th",{className:"text-center",children:"Mata Pelajaran"}),a.jsx("th",{className:"text-center",children:"Guru Pengampu"}),a.jsx("th",{className:"text-center",children:"Aksi"})]})}),a.jsx("tbody",{children:(null==v?void 0:v.length)>0?null==v?void 0:v.map(((t,n)=>a.jsxs("tr",{children:[a.jsx("td",{className:"text-center align-middle",children:(o-1)*u+n+1}),a.jsx("td",{className:"text-center align-middle",children:a.jsx("img",{src:t.cover?t.cover:null==b?void 0:b.logo,alt:`cover-${t.name}`,width:65,height:80,className:"overflow-hidden rounded",style:{objectFit:"cover"}})}),a.jsx("td",{className:"align-middle",children:t.name}),a.jsx("td",{className:"align-middle d-flex flex-column gap-2",children:t.teachers.map(((e,s)=>{var t,n;return a.jsxs("div",{className:"d-flex flex-column",children:[a.jsxs("p",{className:"m-0",children:[e.name," ",a.jsx("span",{className:"text-secondary",children:`(${(null==(t=e.class)?void 0:t.length)>0?null==(n=e.class)?void 0:n.map((e=>e.name)).join(", "):"Data belum tersedia"})`})]}),a.jsxs("div",{className:"d-flex gap-2 text-secondary",children:[a.jsxs("p",{className:"m-0",children:[e.chapters," Chapter"]}),a.jsxs("p",{className:"m-0",children:[e.contents," Materi"]})]})]},s)}))}),a.jsx("td",{className:"text-cente align-middle",children:a.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>((e,a)=>{const s=e.replace(/\s+/g,"-");c(`/pelajaran/${s}/${a}`)})(t.name,t.id),children:a.jsx("i",{className:"bi bi-three-dots-vertical"})}),a.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>e(t),children:a.jsx("i",{className:"bi bi-pencil-square"})}),a.jsx("button",{className:"btn btn-sm btn-danger",disabled:w,onClick:()=>{return e=t.id,void(window.confirm("Apakah anda yakin ingin menghapus data mata pelajaran ini dan semua data yang terkait dengan mata pelajaran ini?")&&s.promise(y(e).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message}));var e},children:a.jsx("i",{className:"bi bi-folder-minus"})})]})})]},n))):a.jsx("tr",{children:a.jsx("td",{colSpan:5,children:"Data tidak tersedia"})})})]})})},u=()=>{const[e,s]=r.useState({});return a.jsx(c,{title:"Mata Pelajaran",levels:["admin"],children:a.jsxs("div",{className:"row g-2",children:[a.jsx("div",{className:"col-lg-3 col-12",children:a.jsx(o,{detail:e,setDetail:s})}),a.jsx("div",{className:"col-lg-9 col-12",children:a.jsx(m,{setDetail:s})})]})})};export{u as default};
//# sourceMappingURL=AdminSubject-BpWuzxlZ.js.map
