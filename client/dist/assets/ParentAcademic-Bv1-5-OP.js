import{ax as e,l as s,aA as a,j as t,F as r,t as i,n as l,az as n,b as c,c as d,D as o,a3 as m,m as j,B as h,a as x,R as p,C as u,aB as g,h as y,A as f}from"./index-B0c3W_5t.js";import{c as v}from"./vendor-DnNJsrFE.js";import{G as b}from"./index-C6-LKUBG.js";import{S,E as I}from"./Pagination-WHZFXTMR.js";import{A as k}from"./index-DNhhOToF.js";import{R as w}from"./ReadOutlined-BmEEkt_R.js";import{R as C}from"./TeamOutlined-CDGKynT3.js";import{R as F}from"./CalendarOutlined-DHgioS5c.js";import{C as z}from"./Collapse-CO8PYkxq.js";import{L as T}from"./index-C8cpJ_iG.js";import{S as A}from"./index-D6RsJMEY.js";import{R as B}from"./FallOutlined-CEIXgA6v.js";import{R as P}from"./BookOutlined-CCa-PfGK.js";const{Title:D,Text:O,Paragraph:L}=i,{useBreakpoint:R}=b,$=({detail:e})=>{const s=e?.[0]?.attendance||[],a=e?.[1]?.attitude||[],r=e?.[2]||{summative:[],formative:[]};return t.jsxs(p,{gutter:[16,16],children:[t.jsx(u,{xs:24,md:12,lg:6,children:t.jsx(x,{size:"small",title:"Attendance",children:t.jsx(T,{dataSource:s,renderItem:e=>{const s=Object.keys(e)[0],a=e[s];return t.jsxs(T.Item,{children:[t.jsx(O,{style:{textTransform:"capitalize"},children:s}),t.jsx(O,{strong:!0,children:"presentase"===s?`${a}%`:a})]})}})})}),t.jsx(u,{xs:24,md:12,lg:6,children:t.jsx(x,{size:"small",title:"Attitude",children:t.jsx(T,{dataSource:a,renderItem:e=>{const s=Object.keys(e)[0],a=e[s];return t.jsxs(T.Item,{children:[t.jsx(O,{style:{textTransform:"capitalize"},children:s}),t.jsx(A,{value:a,precision:2,valueStyle:{fontSize:"1rem"}})]})}})})}),t.jsx(u,{xs:24,md:12,lg:8,children:t.jsx(x,{size:"small",title:"Summative",children:t.jsx(T,{dataSource:r.summative,renderItem:e=>{const s=Object.keys(e)[0],a=e[s];return t.jsxs(T.Item,{children:[t.jsx(O,{style:{textTransform:"capitalize"},children:s}),t.jsx(A,{value:a,precision:2,valueStyle:{fontSize:"1rem"}})]})}})})}),t.jsx(u,{xs:24,md:12,lg:4,children:t.jsx(x,{size:"small",title:"Formative",children:t.jsx(T,{dataSource:r.formative,renderItem:e=>t.jsx(T.Item,{children:e}),locale:{emptyText:"-"}})})})]})},G=({subject:e,isSmallScreen:s,onChapterClick:a})=>t.jsx(T.Item,{children:t.jsxs(x,{children:[t.jsxs(r,{justify:"space-between",align:"center",wrap:"wrap",gap:"small",children:[t.jsxs("div",{children:[t.jsx(D,{level:5,style:{marginBottom:0},children:e.name}),t.jsxs(O,{type:"secondary",children:[t.jsx(c,{})," Guru: ",e.teacher]})]}),t.jsx(A,{title:"Nilai",value:e.score,precision:2,valueStyle:{color:e.score>=75?"#3f8600":"#cf1322"},prefix:e.score>=75?t.jsx(g,{}):t.jsx(B,{})})]}),e.chapters&&e.chapters.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs(o,{orientation:"left",plain:!0,children:[t.jsx(P,{})," Detail Penilaian per Chapter"]}),s?t.jsx(T,{itemLayout:"vertical",dataSource:e.chapters,renderItem:e=>t.jsx(T.Item,{actions:[t.jsx(h,{type:"primary",size:"small",onClick:()=>a(e),children:"Lihat Detail"})],children:t.jsx(T.Item.Meta,{title:t.jsx(O,{strong:!0,children:e.name}),description:`Nilai: ${e.score}`})})}):t.jsx(z,{accordion:!0,children:e.chapters.map(e=>t.jsxs(z.Panel,{header:t.jsxs(r,{justify:"space-between",align:"center",style:{width:"100%"},children:[t.jsx(O,{strong:!0,children:e.name}),t.jsx(A,{title:"Nilai",value:e.score,precision:2,valueStyle:{fontSize:"1rem",color:e.score>=75?"#3f8600":"#cf1322"}})]}),children:[t.jsx($,{detail:e.detail}),e.note&&t.jsxs(t.Fragment,{children:[t.jsx(o,{orientation:"left",plain:!0,style:{marginTop:"24px"},children:"Catatan Guru Chapter Ini"}),t.jsxs(L,{italic:!0,children:['"',e.note,'"']})]})]},e.id))})]}),e.note&&t.jsxs(t.Fragment,{children:[t.jsx(o,{orientation:"left",plain:!0,children:"Catatan Umum Guru"}),t.jsxs(L,{italic:!0,children:['"',e.note,'"']})]})]})},`${e.name}-${e.teacher}`),K=Array.from({length:12},(e,s)=>new Date(0,s).toLocaleString("id-ID",{month:"long"})),N=K.map(e=>({label:e,value:e})),E=()=>{const[i,p]=v.useState(null),[u,g]=v.useState(!1),[y,f]=v.useState(null),{user:b}=e(e=>e.auth),[A]=s.useForm(),B=R(),P=!B.md,L=b?.student_id,E=b?.periode;v.useEffect(()=>{const e=(new Date).getMonth(),s=K[0===e?11:e-1];p(s),A.setFieldsValue({month:s})},[A]);const{data:H,error:M,isFetching:W}=a({studentId:L,month:i,periode:E},{skip:!L||!i||!E}),_=H&&H,U=e=>{f(e),g(!0)},V=()=>{g(!1),f(null)},X=e=>t.jsx(T,{itemLayout:"vertical",dataSource:e,renderItem:(e,s)=>t.jsx(G,{subject:e,isSmallScreen:P,onChapterClick:U},e.id||`${e.name}-${s}`)});return M?t.jsx(t.Fragment,{children:t.jsxs(r,{vertical:!0,gap:"middle",children:[t.jsx(s,{form:A,layout:"vertical",children:t.jsx(s.Item,{name:"month",label:t.jsx(D,{level:5,style:{margin:0},children:"Pilih Bulan"}),children:t.jsx(S,{placeholder:"Pilih Bulan",onChange:e=>p(e),options:N,style:{width:P?"100%":300}})})}),t.jsx(k,{message:"Terjadi Kesalahan",description:M?.data?.message||"Gagal memuat data.",type:"error",showIcon:!0})]})}):t.jsxs(r,{vertical:!0,gap:"large",children:[t.jsx(s,{form:A,layout:"vertical",children:t.jsx(s.Item,{name:"month",label:t.jsx(D,{level:5,style:{margin:0},children:"Pilih Bulan"}),children:t.jsx(S,{placeholder:"Pilih Bulan",onChange:e=>p(e),options:N,style:{width:P?"100%":300}})})}),W&&t.jsx("div",{style:{textAlign:"center",marginTop:50},children:t.jsx(l,{size:"large"})}),!W&&_&&t.jsxs(t.Fragment,{children:[t.jsxs(n,{bordered:!0,column:B.md?2:1,size:"small",children:[t.jsx(n.Item,{label:t.jsxs(t.Fragment,{children:[t.jsx(c,{})," Nama Siswa"]}),span:B.md?2:1,children:t.jsxs(O,{strong:!0,children:[_.name," (",_.nis,")"]})}),t.jsx(n.Item,{label:t.jsxs(t.Fragment,{children:[t.jsx(d,{})," Homebase"]}),children:_.homebase}),t.jsxs(n.Item,{label:t.jsxs(t.Fragment,{children:[t.jsx(w,{})," Kelas"]}),children:[_.grade," - ",_.class]}),t.jsx(n.Item,{label:t.jsxs(t.Fragment,{children:[t.jsx(C,{})," Wali Kelas"]}),children:_.teacher_homeroom}),t.jsx(n.Item,{label:t.jsxs(t.Fragment,{children:[t.jsx(F,{})," Periode Laporan"]}),children:t.jsxs(O,{strong:!0,children:[_.periode," - ",_.month]})})]}),t.jsx(o,{}),t.jsx(z,{accordion:!0,defaultActiveKey:["0"],ghost:!0,items:_.category.map((e,s)=>({key:String(s),label:t.jsx(D,{level:5,children:e.name}),children:"Diniyah"===e.name&&e.branch?t.jsx(z,{items:e.branch.map((e,s)=>({key:String(s),label:t.jsxs(r,{justify:"space-between",style:{width:"100%"},children:[t.jsx(O,{strong:!0,children:e.name}),t.jsxs(m,{color:"blue",children:["Nilai: ",e.score]})]}),children:X(e.subjects)}))}):X(e.subjects)}))})]}),t.jsx(j,{title:t.jsxs(D,{level:5,children:["Detail Penilaian: ",y?.name]}),open:u,onCancel:V,footer:[t.jsx(h,{onClick:V,children:"Tutup"},"back")],width:P?"90vw":"80vw",children:y&&t.jsx($,{detail:y.detail})}),!W&&!_&&i&&!M&&t.jsx(x,{children:t.jsx(I,{description:"Data laporan untuk bulan yang dipilih tidak tersedia."})})]})},H=()=>t.jsx(k,{type:"info",showIcon:!0,message:"Laporan Semester",description:"Halaman ini masih dalam tahap pengembangan"}),M=()=>{const{user:s}=e(e=>e.auth),a=[{label:"Bulanan",key:"1",children:t.jsx(E,{})},{label:"Semester",key:"2",children:t.jsx(H,{})}];return t.jsx(y,{title:"Laporan Akademik",levels:["parent"],children:t.jsx(f,{centered:!0,defaultActiveKey:"1",items:a})})};export{M as default};
