{"version":3,"file":"AdminSubject-Ca-Vf_Cp.js","sources":["../../src/page/admin/subject/Form.jsx","../../src/page/admin/subject/TableData.jsx","../../src/page/admin/subject/AdminSubject.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\r\nimport { useAddSubjectMutation } from \"../../../controller/api/admin/ApiSubject\";\r\nimport { toast } from \"react-hot-toast\";\r\n\r\nconst Form = ({ detail, setDetail }) => {\r\n  const [id, setId] = useState(\"\");\r\n  const [name, setName] = useState(\"\");\r\n  const [file, setFile] = useState(null);\r\n  const inputRef = useRef(null);\r\n\r\n  const [addSubject, { isSuccess, isLoading, isError, reset }] =\r\n    useAddSubjectMutation();\r\n\r\n  const addHandler = (e) => {\r\n    e.preventDefault();\r\n\r\n    if (!name) {\r\n      return toast.error(\"Lengkapi data\");\r\n    }\r\n\r\n    const data = new FormData();\r\n    data.append(\"id\", id ? id : \"\");\r\n    data.append(\"name\", name);\r\n    data.append(\"cover\", file);\r\n\r\n    toast.promise(\r\n      addSubject(data)\r\n        .unwrap()\r\n        .then((res) => res.message),\r\n      {\r\n        loading: \"Meyimpan data...\",\r\n        success: (message) => message,\r\n        error: (err) => err.data.message,\r\n      }\r\n    );\r\n  };\r\n\r\n  const cancel = () => {\r\n    setDetail({});\r\n    setId(\"\");\r\n    setName(\"\");\r\n    if (inputRef.current) {\r\n      inputRef.current.value = null;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (detail) {\r\n      setId(detail.id);\r\n      setName(detail.name);\r\n    }\r\n  }, [detail]);\r\n\r\n  useEffect(() => {\r\n    if (isSuccess || isError) {\r\n      reset();\r\n      setDetail({});\r\n      setId(\"\");\r\n      setName(\"\");\r\n      if (inputRef.current) {\r\n        inputRef.current.value = null;\r\n      }\r\n    }\r\n  }, [isSuccess, isError]);\r\n\r\n  return (\r\n    <form\r\n      onSubmit={addHandler}\r\n      className='rounded border p-2 bg-white d-flex flex-column gap-2'>\r\n      <p className='m-0 h6'>Mata Pelajaran</p>\r\n\r\n      <input\r\n        type='text'\r\n        name='name'\r\n        id='name'\r\n        className='form-control'\r\n        placeholder='Nama Mata Pelajaran'\r\n        value={name || \"\"}\r\n        onChange={(e) => setName(e.target.value)}\r\n      />\r\n\r\n      <div className='input-group'>\r\n        <input\r\n          type='file'\r\n          className='form-control'\r\n          id='inputGroupFile02'\r\n          ref={inputRef}\r\n          onChange={(e) => setFile(e.target.files[0])}\r\n        />\r\n        <label className='input-group-text' htmlFor='inputGroupFile02'>\r\n          Cover\r\n        </label>\r\n      </div>\r\n\r\n      <div className='d-flex justify-content-end gap-2'>\r\n        <button\r\n          type='button'\r\n          className='btn btn-sm btn-warning'\r\n          onClick={cancel}>\r\n          Batal\r\n        </button>\r\n\r\n        <button\r\n          type='submit'\r\n          className='btn btn-sm btn-success'\r\n          disabled={isLoading}>\r\n          Simpan\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default Form;\r\n","import { useEffect, useState } from \"react\";\r\nimport Table from \"../../../components/table/Table\";\r\nimport {\r\n  useDeleteSubjectMutation,\r\n  useGetSubjectQuery,\r\n} from \"../../../controller/api/admin/ApiSubject\";\r\nimport { toast } from \"react-hot-toast\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useGetAppQuery } from \"../../../controller/api/center/ApiApp\";\r\n\r\nconst TableData = ({ setDetail }) => {\r\n  const navigate = useNavigate();\r\n  const [page, setPage] = useState(1);\r\n  const [limit, setLimit] = useState(10);\r\n  const [search, setSearch] = useState(\"\");\r\n\r\n  const { data: rawData = {}, isLoading: dataLoading } = useGetSubjectQuery({\r\n    page,\r\n    limit,\r\n    search,\r\n  });\r\n  const { data: app } = useGetAppQuery();\r\n\r\n  const { totalData, totalPages, subjects = [] } = rawData;\r\n  const [deleteSubject, { isSuccess, isLoading, isError, reset }] =\r\n    useDeleteSubjectMutation();\r\n\r\n  const deleteHandler = (id) => {\r\n    const confirm = window.confirm(\r\n      \"Apakah anda yakin ingin menghapus data mata pelajaran ini dan semua data yang terkait dengan mata pelajaran ini?\"\r\n    );\r\n    if (confirm) {\r\n      toast.promise(\r\n        deleteSubject(id)\r\n          .unwrap()\r\n          .then((res) => res.message),\r\n        {\r\n          loading: \"Memproses...\",\r\n          success: (message) => message,\r\n          error: (err) => err.data.message,\r\n        }\r\n      );\r\n    }\r\n  };\r\n\r\n  const goToLink = (name, id) => {\r\n    const formattedName = name.replace(/\\s+/g, \"-\");\r\n    navigate(`/pelajaran/${formattedName}/${id}`);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isSuccess || isError) {\r\n      reset();\r\n    }\r\n  }, [isSuccess, isError]);\r\n\r\n  return (\r\n    <Table\r\n      page={page}\r\n      setPage={setPage}\r\n      setLimit={setLimit}\r\n      setSearch={setSearch}\r\n      totalData={totalData}\r\n      totalPages={totalPages}\r\n      isLoading={dataLoading}\r\n    >\r\n      <div className=\"row g-4\">\r\n        {subjects?.length > 0 ? (\r\n          subjects?.map((subject, i) => (\r\n            <div key={i} className=\"col-12 col-md-6\">\r\n              <div className=\"card shadow-sm h-100\">\r\n                <div className=\"card-body\">\r\n                  <div className=\"row align-items-center\">\r\n                    <div className=\"col-auto\">\r\n                      <div className=\"d-flex align-items-center\">\r\n                        <span className=\"badge bg-primary me-3\">\r\n                          {(page - 1) * limit + i + 1}\r\n                        </span>\r\n                        <img\r\n                          src={subject.cover ? subject.cover : app?.logo}\r\n                          alt={`cover-${subject.name}`}\r\n                          width={65}\r\n                          height={80}\r\n                          className=\"rounded\"\r\n                          style={{ objectFit: \"cover\" }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"col\">\r\n                      <h5 className=\"card-title mb-3\">{subject.name}</h5>\r\n                      <div className=\"d-flex flex-column gap-3\">\r\n                        {subject.teachers.map((teacher, i) => (\r\n                          <div key={i} className=\"d-flex flex-column\">\r\n                            <p className=\"m-0 fw-medium\">\r\n                              {teacher.name}{\" \"}\r\n                              <span className=\"text-secondary fw-normal\">{`(${\r\n                                teacher.class?.length > 0\r\n                                  ? teacher.class\r\n                                      ?.map((item) => item.name)\r\n                                      .join(\", \")\r\n                                  : \"Data belum tersedia\"\r\n                              })`}</span>\r\n                            </p>\r\n                            <div className=\"d-flex gap-3 text-secondary small\">\r\n                              <p className=\"m-0\">\r\n                                <i className=\"bi bi-book me-1\"></i>\r\n                                {teacher.chapters} Chapter\r\n                              </p>\r\n                              <p className=\"m-0\">\r\n                                <i className=\"bi bi-file-text me-1\"></i>\r\n                                {teacher.contents} Materi\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"col-auto\">\r\n                      <div className=\"d-flex gap-2\">\r\n                        <button\r\n                          className=\"btn btn-sm btn-primary\"\r\n                          onClick={() => goToLink(subject.name, subject.id)}\r\n                        >\r\n                          <i className=\"bi bi-three-dots-vertical\"></i>\r\n                        </button>\r\n                        <button\r\n                          className=\"btn btn-sm btn-warning\"\r\n                          onClick={() => setDetail(subject)}\r\n                        >\r\n                          <i className=\"bi bi-pencil-square\"></i>\r\n                        </button>\r\n                        <button\r\n                          className=\"btn btn-sm btn-danger\"\r\n                          disabled={isLoading}\r\n                          onClick={() => deleteHandler(subject.id)}\r\n                        >\r\n                          <i className=\"bi bi-folder-minus\"></i>\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))\r\n        ) : (\r\n          <div className=\"col-12\">\r\n            <div className=\"alert alert-info mb-0\">Data tidak tersedia</div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </Table>\r\n  );\r\n};\r\n\r\nexport default TableData;\r\n","import React, { useState } from \"react\"\r\nimport Layout from \"../../../components/layout/Layout\"\r\nimport Form from \"./Form\"\r\nimport TableData from \"./TableData\"\r\n\r\nconst AdminSubject = () => {\r\n\tconst [detail, setDetail] = useState({})\r\n\treturn (\r\n\t\t<Layout title={\"Mata Pelajaran\"} levels={[\"admin\"]}>\r\n\t\t\t<div className='row g-2'>\r\n\t\t\t\t<div className='col-lg-3 col-12'>\r\n\t\t\t\t\t<Form detail={detail} setDetail={setDetail} />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className='col-lg-9 col-12'>\r\n\t\t\t\t\t<TableData setDetail={setDetail} />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</Layout>\r\n\t)\r\n}\r\n\r\nexport default AdminSubject\r\n"],"names":["Form","detail","setDetail","id","setId","useState","name","setName","file","setFile","inputRef","useRef","addSubject","isSuccess","isLoading","isError","reset","useAddSubjectMutation","useEffect","current","value","jsxRuntimeExports","jsxs","onSubmit","e","preventDefault","toast","error","data","FormData","append","c","promise","unwrap","then","res","message","loading","success","err","className","children","jsx","type","placeholder","onChange","target","ref","files","htmlFor","onClick","disabled","TableData","navigate","useNavigate","page","setPage","limit","setLimit","search","setSearch","rawData","dataLoading","useGetSubjectQuery","app","useGetAppQuery","totalData","totalPages","subjects","deleteSubject","useDeleteSubjectMutation","Table","length","map","subject","i","src","cover","logo","alt","width","height","style","objectFit","teachers","teacher","_a","class","_b","item","join","chapters","contents","formattedName","replace","goToLink","deleteHandler","window","confirm","AdminSubject","Layout","title","levels"],"mappings":"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"}