import{i as e,k as a,l as s,s as i,j as t,m as l,n,I as r,o as d,p as o,q as m,r as c,h as u,F as p,t as h}from"./index-BerNJ4BB.js";import{c as x}from"./vendor-DnNJsrFE.js";import{A as g}from"./Add-DOjRQfzr.js";import{S as j}from"./Pagination-DLBnpq19.js";import{T as k}from"./TableLayout-o4CxzGTY.js";import{D as b}from"./Table-Azebf-5d.js";import{R as v}from"./DeleteOutlined-CM6OJbZQ.js";import"./index-CgL42zmd.js";const y=({title:d,open:o,setOpen:m,admin:c,setAdmin:u})=>{const{data:p,isLoading:h}=e({page:"",limit:"",search:""}),[g,{isLoading:k,data:b,error:v,isSuccess:y}]=a(),[f]=s.useForm(),S=s.useWatch("level",f),w=()=>{m(!1),u(),f.resetFields()},L=p?.map(e=>({value:e.id,label:e.name}));return x.useEffect(()=>{c?f.setFieldsValue({level:c.level,home:c.homebase,name:c.username,email:c.email,phone:c.phone}):f.resetFields()},[c]),x.useEffect(()=>{y&&(w(),i.success(b.message)),v&&i.error(v.data.message)},[y,b,v]),t.jsx(l,{title:d,open:o,onCancel:w,destroyOnHidden:!0,okText:"Simpan",cancelText:"Batal",onOk:()=>f.submit(),loading:h,confirmLoading:h,style:{top:20},children:t.jsx(n,{tip:"Memporses data..",spinning:k,children:t.jsxs(s,{form:f,layout:"vertical",onFinish:e=>{if(c){const a={...e,id:c.id};g(a)}else g(e)},validateMessages:{required:"${label} wajib diisi!",types:{email:"${label} tidak valid!",number:"${label} tidak valid!"}},children:[t.jsx(s.Item,{name:"level",label:"Level",rules:[{required:!0}],children:t.jsx(j,{placeholder:"Pilih Level",onChange:e=>{switch(e){case"pusat":f.setFieldsValue({level:"center"});break;case"admin":f.setFieldsValue({level:"admin"});break;case"tahfiz":f.setFieldsValue({level:"tahfiz"});break;case"cms":f.setFieldsValue({level:"cms"})}},options:[{value:"center",label:"Pusat"},{value:"admin",label:"Admin Satuan"},{value:"tahfiz",label:"Tahfiz"},{value:"cms",label:"Konten"}],showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),"admin"===S&&t.jsx(s.Item,{name:"home",label:"Satuan",rules:[{required:!0}],children:t.jsx(j,{placeholder:"Pilih Satuan",options:L,loading:h,showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),t.jsx(s.Item,{name:"name",label:"Username",rules:[{required:!0}],children:t.jsx(r,{placeholder:"Username"})}),t.jsx(s.Item,{name:"email",label:"Email",rules:[{required:!0,type:"email"}],children:t.jsx(r,{placeholder:"Email yang aktif"})}),t.jsx(s.Item,{name:"phone",label:"Whatsapp",rules:[{required:!0,message:"Whatsapp wajib diisi!"},{pattern:/^(62|0)[0-9]{9,15}$/,message:"Nomor Whatsapp tidak valid!"}],children:t.jsx(r,{placeholder:"62*******",type:"tel"})}),t.jsx(s.Item,{name:"password",label:"Password",rules:[{required:!0,type:"password"}],children:t.jsx(r.Password,{placeholder:"Password"})})]})})})},{Search:f}=r,{Text:S}=m,{confirm:w}=l,L=({onEdit:e})=>{const[a,s]=x.useState(1),[l,n]=x.useState(10),[r,m]=x.useState(""),{data:u,isLoading:p}=d({page:a,limit:l,search:r}),[h,{isLoading:g,isSuccess:j,data:y,error:f}]=o(),L=(a,{key:s})=>{switch(s){case"edit":(a=>{e(a)})(a);break;case"delete":w({title:`Apakah anda yakin menghapus admin ${a.username} ?`,content:"Penghapusan admin akan menghapus seluruh data yang sudah dibuat, \n            pasikan anda yaking melakukan tindakan ini!",okText:"Ya, Saya Yakin",cancelText:"Batalkan",okType:"danger",onOk(){h(a.id)}})}};x.useEffect(()=>{j&&i.success(y.message),f&&i.error(f.data.message)},[j,y,f]);const A=[{title:"No",key:"nomor",render:(e,s,i)=>(a-1)*l+i+1},{title:"Username",dataIndex:"username",key:"username",render:(e,a)=>t.jsx(S,{strong:!0,type:a.isactive?"success":"danger",children:e})},{title:"Email",dataIndex:"email",key:"email"},{title:"Level",dataIndex:"level",key:"level"},{title:"Homebase",dataIndex:"homebase",key:"homebase"},{title:"Aksi",key:"action",render:e=>t.jsx(b.Button,{menu:{items:[{key:"edit",label:"Edit",icon:t.jsx(c,{})},{key:"delete",label:"Hapus",icon:t.jsx(v,{}),danger:!0}],onClick:({key:a})=>L(e,{key:a})},children:"Pilihan Aksi"})}];return t.jsx(k,{onSearch:e=>{m(e),s(1)},isLoading:p||g,columns:A,source:u?.admin,rowKey:"id",page:a,limit:l,totalData:u?.totalData,onChange:e=>{s(e.current),n(e.pageSize)}})},{Title:A}=h,T=()=>{const[e,a]=x.useState(!1),[s,i]=x.useState({}),[l,n]=x.useState(!1);return t.jsxs(u,{title:"Managemen Administrasi",levels:["center"],children:[t.jsxs(p,{vertical:!0,gap:"middle",children:[t.jsxs(p,{justify:"space-between",children:[t.jsx(A,{level:5,style:{margin:0},children:"Mangemen Administrasi"}),t.jsx(g,{onClick:()=>a(!0)})]}),t.jsx(L,{onEdit:e=>{i(e),n(!0),a(!0)}})]}),t.jsx(y,{title:l?"Edit data Admin":"Tambah Admin",open:e,setOpen:()=>a(!1),admin:s,setAdmin:()=>i({})})]})};export{T as default};
