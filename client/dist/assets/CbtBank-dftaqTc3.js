import{b as e,aD as a,aE as s,j as l,e as t,aF as n,aG as i}from"./index-D4suB52Y.js";import{b as r,u as o}from"./vendor-DfXzdC0j.js";import{S as d}from"./react-select.esm-DUeLA41h.js";import{T as c}from"./Table-D7OA_qnS.js";const m=({detail:n,setDetail:i})=>{var o;const{user:c}=e((e=>e.auth)),[m,b]=r.useState({id:"",teacher:(null==c?void 0:c.id)||null,subject:null,btype:"",name:""}),{data:u}=a(),[h,{isSuccess:p,isLoading:x,isError:j,reset:g}]=s(),v=null==u?void 0:u.map((e=>({value:e.id,label:e.name,subjects:e.subjects}))),f=null==u?void 0:u.find((e=>e.id===m.teacher)),y=(null==(o=null==f?void 0:f.subjects)?void 0:o.map((e=>({value:e.id,label:e.name}))))||[],N=e=>{const{name:a,value:s}=e.target;b((e=>({...e,[a]:s})))},k=()=>{i({}),b({id:"",teacher:(null==c?void 0:c.id)||null,subject:null,btype:"",name:""})};return r.useEffect((()=>{if(p||j){b({id:"",teacher:(null==c?void 0:c.id)||null,btype:"",subject:null,name:""}),g();document.querySelector("[data-bs-dismiss='modal']").click()}}),[p,j,c,g]),r.useEffect((()=>{n&&b({id:n.id,teacher:n.teacher||(null==c?void 0:c.id)||null,subject:n.subject,name:n.name,btype:n.btype})}),[n,c]),r.useEffect((()=>{const e=document.getElementById("addbank");if(!e)return;const a=()=>{b({id:"",teacher:(null==c?void 0:c.id)||null,subject:null,btype:"",name:""})};return e.addEventListener("hidden.bs.modal",a),()=>e.removeEventListener("hidden.bs.modal",a)}),[c]),l.jsx("div",{className:"modal fade",id:"addbank","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"bankModalLabel","aria-hidden":"true",children:l.jsx("div",{className:"modal-dialog",children:l.jsxs("form",{onSubmit:e=>{e.preventDefault(),t.promise(h(m).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message})},className:"modal-content p-3",children:[l.jsxs("div",{className:"modal-header",children:[l.jsx("h5",{className:"modal-title",id:"bankModalLabel",children:m.id?"Edit Bank Soal":"Tambah Bank Soal"}),l.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:k})]}),l.jsxs("div",{className:"modal-body d-flex flex-column gap-3",children:[l.jsx(d,{isClearable:!0,isSearchable:!0,placeholder:"Cari Guru",value:(null==v?void 0:v.find((e=>e.value===m.teacher)))||null,options:v,onChange:e=>{b((a=>({...a,teacher:(null==e?void 0:e.value)||null,subject:null})))},className:"mb-2"}),l.jsx(d,{isClearable:!0,isSearchable:!0,placeholder:"Pilih Mata Pelajaran",value:(null==y?void 0:y.find((e=>e.value===m.subject)))||null,options:y,onChange:e=>{b((a=>({...a,subject:(null==e?void 0:e.value)||null})))},isDisabled:!m.teacher,className:"mb-2"}),l.jsxs("select",{name:"btype",id:"btype",className:"form-select",value:m.btype,onChange:N,required:!0,children:[l.jsx("option",{value:"",hidden:!0,children:"Jenis Bank Soal"}),l.jsx("option",{value:"bank",children:"Bank"}),l.jsx("option",{value:"paket",children:"Paket"})]}),l.jsx("input",{name:"name",className:"form-control",placeholder:"Nama Bank Soal",value:m.name,onChange:N,required:!0})]}),l.jsxs("div",{className:"modal-footer",children:[l.jsxs("button",{type:"button",className:"btn btn-warning","data-bs-dismiss":"modal",onClick:k,children:[l.jsx("i",{className:"bi bi-x-lg me-1"}),"Batal"]}),l.jsxs("button",{type:"submit",className:"btn btn-success",disabled:x,children:[l.jsx("i",{className:"bi bi-save me-1"}),"Simpan"]})]})]})})})},b=({setDetail:e})=>{const a=o(),[s,d]=r.useState(1),[m,b]=r.useState(10),[u,h]=r.useState(""),{data:p={},isLoading:x}=n({page:s,limit:m,search:u}),{banks:j=[],totalData:g,totalPages:v}=p,[f,{isLoading:y}]=i();return l.jsx("div",{style:{overflow:"visible",position:"relative"},children:l.jsx(c,{page:s,setPage:d,setLimit:b,setSearch:h,totalData:g,totalPages:v,isLoading:x,children:l.jsx("div",{className:"table-responsive",style:{overflow:"visible",position:"relative"},children:l.jsxs("table",{className:"table table-hover align-middle",style:{position:"relative",overflow:"visible"},children:[l.jsx("thead",{className:"table-light",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"text-center",style:{width:"60px"},children:"#"}),l.jsx("th",{scope:"col",children:"Nama Bank Soal"}),l.jsx("th",{scope:"col",children:"Guru"}),l.jsx("th",{scope:"col",children:"Mata Pelajaran"}),l.jsx("th",{scope:"col",children:"Jenis"}),l.jsx("th",{scope:"col",className:"text-center",children:"Jumlah Soal"}),l.jsx("th",{scope:"col",className:"text-center",style:{width:"120px"},children:"Aksi"})]})}),l.jsx("tbody",{style:{position:"relative",overflow:"visible"},children:(null==j?void 0:j.length)>0?null==j?void 0:j.map(((n,i)=>l.jsxs("tr",{className:"align-middle",style:{position:"relative",overflow:"visible"},children:[l.jsx("td",{className:"text-center",children:l.jsx("span",{className:"badge bg-primary rounded-pill",children:(s-1)*m+i+1})}),l.jsx("td",{children:l.jsxs("div",{className:"d-flex align-items-center gap-2",children:[l.jsx("div",{className:"bg-primary bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center",style:{width:40,height:40},children:l.jsx("i",{className:"bi bi-folder-fill text-primary"})}),l.jsx("div",{children:l.jsx("div",{className:"fw-semibold text-primary",title:n.name,children:n.name.length>25?`${n.name.slice(0,25)}...`:n.name})})]})}),l.jsx("td",{children:l.jsx("span",{className:"text-muted",title:n.teacher_name,children:n.teacher_name.length>20?`${n.teacher_name.slice(0,20)}...`:n.teacher_name})}),l.jsx("td",{children:l.jsx("span",{className:"badge bg-secondary bg-opacity-75",children:n.subject_name})}),l.jsx("td",{children:l.jsx("span",{className:"badge bg-success",children:n.btype.toUpperCase()})}),l.jsx("td",{className:"text-center",children:l.jsxs("span",{className:"badge bg-info",children:[n.question_count," Soal"]})}),l.jsx("td",{className:"text-center",style:{position:"relative",overflow:"visible"},children:l.jsxs("div",{className:"dropdown",style:{position:"relative"},children:[l.jsxs("button",{className:"btn btn-sm btn-outline-primary dropdown-toggle d-flex align-items-center gap-1",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",style:{minWidth:"120px",justifyContent:"space-between",fontSize:"0.875rem",padding:"0.375rem 0.75rem",border:"1px solid #0d6efd",borderRadius:"0.375rem",transition:"all 0.2s ease-in-out"},children:[l.jsx("span",{children:"Pilihan Aksi"}),l.jsx("i",{className:"bi bi-chevron-down",style:{fontSize:"0.75rem"}})]}),l.jsxs("ul",{className:"dropdown-menu dropdown-menu-end shadow-lg border-0",style:{minWidth:"200px",padding:"0.5rem 0",borderRadius:"0.5rem",border:"1px solid rgba(0,0,0,0.1)",backgroundColor:"#fff",zIndex:99999,position:"absolute",top:"100%",right:0,marginTop:"0.25rem",boxShadow:"0 0.5rem 1rem rgba(0, 0, 0, 0.15)",transform:"translateY(0)",opacity:1,visibility:"visible",maxHeight:"none",overflow:"visible",pointerEvents:"auto"},children:[l.jsx("li",{children:l.jsxs("button",{className:"dropdown-item d-flex align-items-center py-2 px-3",onClick:()=>((e,s,l)=>{const t=s.replace(/[\s/]/g,"-"),n=e.replace(/[\s/]/g,"-");a(`/admin-cbt-bank/${n}/${t}/${l}`)})(n.subject_name,n.name,n.id),style:{fontSize:"0.875rem",color:"#495057",transition:"all 0.15s ease-in-out",border:"none",backgroundColor:"transparent",width:"100%",textAlign:"left"},onMouseEnter:e=>{e.target.style.backgroundColor="#f8f9fa",e.target.style.color="#0d6efd"},onMouseLeave:e=>{e.target.style.backgroundColor="transparent",e.target.style.color="#495057"},children:[l.jsx("i",{className:"bi bi-eye me-3",style:{fontSize:"1rem",color:"#0d6efd"}}),l.jsx("span",{children:"Lihat"})]})}),l.jsx("li",{children:l.jsxs("button",{className:"dropdown-item d-flex align-items-center py-2 px-3",onClick:()=>e(n),"data-bs-toggle":"modal","data-bs-target":"#addbank",style:{fontSize:"0.875rem",color:"#495057",transition:"all 0.15s ease-in-out",border:"none",backgroundColor:"transparent",width:"100%",textAlign:"left"},onMouseEnter:e=>{e.target.style.backgroundColor="#f8f9fa",e.target.style.color="#0d6efd"},onMouseLeave:e=>{e.target.style.backgroundColor="transparent",e.target.style.color="#495057"},children:[l.jsx("i",{className:"bi bi-pencil me-3",style:{fontSize:"1rem",color:"#ffc107"}}),l.jsx("span",{children:"Edit"})]})}),l.jsx("li",{children:l.jsx("hr",{className:"dropdown-divider my-2",style:{borderColor:"#e9ecef",margin:"0.5rem 0"}})}),l.jsx("li",{children:l.jsxs("button",{className:"dropdown-item d-flex align-items-center py-2 px-3",disabled:y,onClick:()=>{return e=n.id,void(window.confirm("Apakah anda yakin ingin menghapus bank soal ini dan semua data yang terkait dengan bank soal ini?")&&t.promise(f(e).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message}));var e},style:{fontSize:"0.875rem",color:"#dc3545",transition:"all 0.15s ease-in-out",border:"none",backgroundColor:"transparent",width:"100%",textAlign:"left",opacity:y?.6:1},onMouseEnter:e=>{y||(e.target.style.backgroundColor="#fff5f5",e.target.style.color="#dc3545")},onMouseLeave:e=>{y||(e.target.style.backgroundColor="transparent",e.target.style.color="#dc3545")},children:[l.jsx("i",{className:"bi bi-trash me-3",style:{fontSize:"1rem"}}),l.jsx("span",{children:y?"Memproses...":"Hapus"})]})})]})]})})]},i))):l.jsx("tr",{children:l.jsx("td",{colSpan:"7",className:"text-center py-4",children:l.jsxs("div",{className:"text-muted",children:[l.jsx("i",{className:"bi bi-inbox fs-1 d-block mb-2"}),"Data belum tersedia"]})})})})]})})})})},u=()=>{const[e,a]=r.useState("");return l.jsxs("div",{className:"container-fluid",children:[l.jsx(m,{detail:e,setDetail:a}),l.jsx(b,{setDetail:a})]})};export{u as C};
//# sourceMappingURL=CbtBank-dftaqTc3.js.map
