import{av as e,aO as a,aP as s,aQ as t,j as l,e as i,aR as d,aS as c,b as n,ab as r}from"./index-EivrEbl6.js";import{b as m}from"./vendor-DfXzdC0j.js";import{L as h}from"./Layout-Cm1KUPxL.js";import{S as x}from"./react-select.esm-DUeLA41h.js";import{T as o}from"./Table-DnkXlGQ_.js";import"./index-Cjq_QsmG.js";import"./index-33-gAEu4.js";import"./index-C1AnEztE.js";const j=({classid:d,subjectid:c})=>{const[n,r]=m.useState(1),[h,x]=m.useState(10),[j,b]=m.useState(""),[N,u]=m.useState((new Date).toISOString().split("T")[0]),{data:p,isLoading:g}=e({page:n,limit:h,search:j,classid:d},{skip:!d}),{data:v}=a({classid:d,subjectid:c,date:N},{skip:!d||!c});s({classid:d,subjectid:c},{skip:!d||!c});const[y]=t(),{students:k,totalData:w,totalPages:f}=p||{},S=async({studentid:e,note:a,checked:s})=>{if(!s)return;const t={classid:d,subjectid:c,studentid:e,note:a,date:N};i.promise(y(t).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>{var a;return(null==(a=e.data)?void 0:a.message)||"Terjadi kesalahan"}})};return l.jsx(l.Fragment,{children:d&&c?k?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"card mb-4",children:l.jsx("div",{className:"card-body",children:l.jsx("div",{className:"row align-items-center",children:l.jsxs("div",{className:"col-md-6",children:[l.jsxs("label",{className:"form-label fw-bold",children:[l.jsx("i",{className:"bi bi-calendar-date me-2"}),"Tanggal Presensi: ",l.jsx("span",{children:(P=N,new Date(P).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))})]}),l.jsx("input",{type:"date",className:"form-control",value:N,onChange:e=>u(e.target.value),max:(new Date).toISOString().split("T")[0]})]})})})}),l.jsx(o,{isLoading:g,page:n,setPage:r,limit:h,setLimit:x,setSearch:b,totalData:w,totalPages:f,children:l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-hover align-middle",children:[l.jsx("thead",{className:"bg-primary text-white",children:l.jsxs("tr",{children:[l.jsx("th",{className:"align-middle text-center",style:{width:"5%"},children:"No"}),l.jsx("th",{className:"align-middle text-center",style:{width:"10%"},children:"NIS"}),l.jsx("th",{className:"align-middle text-center",style:{width:"25%"},children:"Nama"}),l.jsx("th",{className:"align-middle text-center",style:{width:"10%"},children:"Tingkat"}),l.jsx("th",{className:"align-middle text-center",style:{width:"15%"},children:"Kelas"}),l.jsxs("th",{className:"align-middle text-center",style:{width:"10%"},children:[l.jsx("i",{className:"bi bi-check-circle"}),l.jsx("div",{className:"small",children:"Hadir"})]}),l.jsxs("th",{className:"align-middle text-center",style:{width:"10%"},children:[l.jsx("i",{className:"bi bi-heart-pulse"}),l.jsx("div",{className:"small",children:"Sakit"})]}),l.jsxs("th",{className:"align-middle text-center",style:{width:"10%"},children:[l.jsx("i",{className:"bi bi-envelope-paper"}),l.jsx("div",{className:"small",children:"Izin"})]}),l.jsxs("th",{className:"align-middle text-center",style:{width:"10%"},children:[l.jsx("i",{className:"bi bi-x-circle"}),l.jsx("div",{className:"small",children:"Alpa"})]})]})}),l.jsx("tbody",{children:k.map(((e,a)=>{const s=null==v?void 0:v.find((a=>a.studentid===e.student));return l.jsxs("tr",{className:"attendance-change",children:[l.jsx("td",{className:"text-center align-middle",children:(n-1)*h+a+1}),l.jsx("td",{className:"text-center align-middle",children:e.nis}),l.jsx("td",{className:"align-middle",children:e.student_name}),l.jsx("td",{className:"text-center align-middle",children:e.grade_name}),l.jsx("td",{className:"text-center align-middle",children:e.class_name}),l.jsx("td",{className:"text-center align-middle",children:l.jsx("div",{className:"form-check d-flex justify-content-center",children:l.jsx("input",{className:"form-check-input border-success",type:"radio",name:`attendance-${e.student}`,style:{width:"1.5em",height:"1.5em"},checked:"Hadir"===(null==s?void 0:s.note),onChange:a=>{S({studentid:e.student,note:"Hadir",checked:a.target.checked})}})})}),l.jsx("td",{className:"text-center align-middle",children:l.jsx("div",{className:"form-check d-flex justify-content-center",children:l.jsx("input",{className:"form-check-input border-primary",type:"radio",name:`attendance-${e.student}`,style:{width:"1.5em",height:"1.5em"},checked:"Sakit"===(null==s?void 0:s.note),onChange:a=>{S({studentid:e.student,note:"Sakit",checked:a.target.checked})}})})}),l.jsx("td",{className:"text-center align-middle",children:l.jsx("div",{className:"form-check d-flex justify-content-center",children:l.jsx("input",{className:"form-check-input border-info",type:"radio",name:`attendance-${e.student}`,style:{width:"1.5em",height:"1.5em"},checked:"Izin"===(null==s?void 0:s.note),onChange:a=>{S({studentid:e.student,note:"Izin",checked:a.target.checked})}})})}),l.jsx("td",{className:"text-center align-middle",children:l.jsx("div",{className:"form-check d-flex justify-content-center",children:l.jsx("input",{className:"form-check-input border-danger",type:"radio",name:`attendance-${e.student}`,style:{width:"1.5em",height:"1.5em"},checked:"Alpa"===(null==s?void 0:s.note),onChange:a=>{S({studentid:e.student,note:"Alpa",checked:a.target.checked})}})})})]},e.id)}))})]})})})]}):l.jsxs("div",{className:"text-center py-5 empty-state",children:[l.jsx("div",{className:"mb-3",children:l.jsx("i",{className:"bi bi-people display-1 text-muted"})}),l.jsx("h5",{className:"fw-bold text-muted mb-2",children:"Data Siswa Tidak Tersedia"}),l.jsx("p",{className:"text-muted mb-0",children:"Tidak ada data siswa yang ditemukan untuk kelas ini"})]}):l.jsxs("div",{className:"text-center py-5 empty-state",children:[l.jsx("div",{className:"mb-3",children:l.jsx("i",{className:"bi bi-clipboard2-check display-1 text-muted"})}),l.jsx("h5",{className:"fw-bold text-muted mb-2",children:"Pilih Data Presensi"}),l.jsx("p",{className:"text-muted mb-0",children:"Silakan pilih mata pelajaran dan kelas terlebih dahulu"})]})});var P},b=({classid:e,subjectid:a})=>{const[s,t]=m.useState((new Date).getMonth()+1),[i,n]=m.useState((new Date).getFullYear()),{data:r,isLoading:h}=d({classid:e,subjectid:a,month:s,year:i},{skip:!e||!a});return e&&a?h?l.jsx(c,{}):l.jsxs("div",{className:"card",children:[l.jsx("div",{className:"card-header bg-primary text-white",children:l.jsxs("h5",{className:"card-title mb-0",children:[l.jsx("i",{className:"bi bi-calendar-month me-2"}),"Rangkuman Presensi Bulanan"]})}),l.jsxs("div",{className:"card-body",children:[l.jsx("div",{className:"row mb-3",children:l.jsxs("div",{className:"col-md-6",children:[l.jsx("label",{className:"form-label fw-bold",children:"Bulan:"}),l.jsx("select",{className:"form-select",value:s,onChange:e=>t(parseInt(e.target.value)),children:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"].map(((e,a)=>l.jsx("option",{value:a+1,children:e},a+1)))})]})}),r&&r.length>0?l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-hover table-striped",children:[l.jsx("thead",{className:"table-dark",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-center",style:{width:"5%"},children:"No"}),l.jsx("th",{style:{width:"10%"},children:"NIS"}),l.jsx("th",{style:{width:"35%"},children:"Nama Siswa"}),l.jsxs("th",{className:"text-center",style:{width:"12%"},children:[l.jsx("i",{className:"bi bi-check-circle text-success me-1"}),"Hadir"]}),l.jsxs("th",{className:"text-center",style:{width:"12%"},children:[l.jsx("i",{className:"bi bi-heart-pulse text-primary me-1"}),"Sakit"]}),l.jsxs("th",{className:"text-center",style:{width:"12%"},children:[l.jsx("i",{className:"bi bi-envelope-paper text-info me-1"}),"Izin"]}),l.jsxs("th",{className:"text-center",style:{width:"12%"},children:[l.jsx("i",{className:"bi bi-x-circle text-danger me-1"}),"Alpa"]}),l.jsxs("th",{className:"text-center",style:{width:"12%"},children:[l.jsx("i",{className:"bi bi-percent text-warning me-1"}),"Kehadiran"]})]})}),l.jsx("tbody",{children:r.map(((e,a)=>{const s=e.hadir+e.sakit+e.izin+e.alpa,t=s>0?(e.hadir/s*100).toFixed(1):0;return l.jsxs("tr",{className:"attendance-change",children:[l.jsx("td",{className:"text-center align-middle",children:a+1}),l.jsx("td",{className:"align-middle",children:e.nis}),l.jsx("td",{className:"align-middle fw-bold",children:e.student_name}),l.jsx("td",{className:"text-center align-middle",children:l.jsx("span",{className:"badge bg-success fs-6",children:e.hadir})}),l.jsx("td",{className:"text-center align-middle",children:l.jsx("span",{className:"badge bg-primary fs-6",children:e.sakit})}),l.jsx("td",{className:"text-center align-middle",children:l.jsx("span",{className:"badge bg-info fs-6",children:e.izin})}),l.jsx("td",{className:"text-center align-middle",children:l.jsx("span",{className:"badge bg-danger fs-6",children:e.alpa})}),l.jsx("td",{className:"text-center align-middle",children:l.jsxs("span",{className:"badge fs-6 "+(t>=90?"bg-success":t>=80?"bg-warning":"bg-danger"),children:[t,"%"]})})]},e.studentid)}))})]})}):l.jsxs("div",{className:"text-center py-5 empty-state",children:[l.jsx("div",{className:"mb-3",children:l.jsx("i",{className:"bi bi-calendar-x display-1 text-muted"})}),l.jsx("h5",{className:"fw-bold text-muted mb-2",children:"Data Tidak Tersedia"}),l.jsx("p",{className:"text-muted mb-0",children:"Tidak ada data presensi untuk periode yang dipilih"})]})]})]}):l.jsxs("div",{className:"text-center py-5 empty-state",children:[l.jsx("div",{className:"mb-3",children:l.jsx("i",{className:"bi bi-calendar-check display-1 text-muted"})}),l.jsx("h5",{className:"fw-bold text-muted mb-2",children:"Pilih Data Presensi"}),l.jsx("p",{className:"text-muted mb-0",children:"Silakan pilih mata pelajaran dan kelas terlebih dahulu"})]})},N=({classid:e,subjectid:t})=>{const[i,d]=m.useState(""),[n,r]=m.useState("all"),{data:h}=s({classid:e,subjectid:t},{skip:!e||!t}),{data:x,isLoading:o}=a({classid:e,subjectid:t,...i&&{date:i}},{skip:!e||!t}),j=e=>new Date(e).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),b=e=>{switch(e){case"Hadir":return l.jsx("span",{className:"badge bg-success",children:e});case"Sakit":return l.jsx("span",{className:"badge bg-primary",children:e});case"Izin":return l.jsx("span",{className:"badge bg-info",children:e});case"Alpa":return l.jsx("span",{className:"badge bg-danger",children:e});default:return l.jsx("span",{className:"badge bg-secondary",children:e||"Belum Diisi"})}};return e&&t?o?l.jsx(c,{}):l.jsxs("div",{className:"card",children:[l.jsx("div",{className:"card-header bg-info text-white",children:l.jsxs("h5",{className:"card-title mb-0",children:[l.jsx("i",{className:"bi bi-clock-history me-2"}),"Riwayat Presensi"]})}),l.jsxs("div",{className:"card-body",children:[l.jsxs("div",{className:"row mb-4",children:[l.jsxs("div",{className:"col-md-6",children:[l.jsxs("label",{className:"form-label fw-bold",children:[l.jsx("i",{className:"bi bi-calendar-range me-2"}),"Filter Tanggal:"]}),l.jsxs("select",{className:"form-select",value:n,onChange:e=>{r(e.target.value),"all"===e.target.value?d(""):"today"===e.target.value&&d((new Date).toISOString().split("T")[0])},children:[l.jsx("option",{value:"all",children:"Semua Tanggal"}),l.jsx("option",{value:"today",children:"Hari Ini"}),l.jsx("option",{value:"specific",children:"Tanggal Tertentu"})]})]}),l.jsxs("div",{className:"col-md-6",children:[l.jsxs("label",{className:"form-label fw-bold",children:[l.jsx("i",{className:"bi bi-calendar-date me-2"}),"Pilih Tanggal:"]}),l.jsxs("select",{className:"form-select",value:i,onChange:e=>d(e.target.value),disabled:"specific"!==n,children:[l.jsx("option",{value:"",children:"Pilih tanggal"}),null==h?void 0:h.map((e=>l.jsx("option",{value:e.date,children:j(e.date)},e.date)))]})]})]}),x&&x.length>0?l.jsx("div",{className:"table-responsive",children:l.jsxs("table",{className:"table table-hover table-striped",children:[l.jsx("thead",{className:"table-dark",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-center",style:{width:"5%"},children:"No"}),l.jsx("th",{style:{width:"15%"},children:"Tanggal"}),l.jsx("th",{style:{width:"10%"},children:"NIS"}),l.jsx("th",{style:{width:"25%"},children:"Nama Siswa"}),l.jsx("th",{className:"text-center",style:{width:"15%"},children:"Status"}),l.jsx("th",{className:"text-center",style:{width:"10%"},children:"Aksi"})]})}),l.jsx("tbody",{children:x.map(((e,a)=>l.jsxs("tr",{className:"attendance-change",children:[l.jsx("td",{className:"text-center align-middle",children:a+1}),l.jsxs("td",{className:"align-middle",children:[l.jsx("div",{className:"fw-bold",children:j(e.date)}),l.jsx("small",{className:"text-muted",children:new Date(e.date).toLocaleDateString("id-ID")})]}),l.jsx("td",{className:"align-middle",children:e.nis}),l.jsx("td",{className:"align-middle fw-bold",children:e.student_name}),l.jsx("td",{className:"text-center align-middle",children:b(e.note)}),l.jsx("td",{className:"text-center align-middle",children:l.jsx("button",{className:"btn btn-sm btn-outline-primary",title:"Lihat Detail",disabled:!0,children:l.jsx("i",{className:"bi bi-eye"})})})]},e.id)))})]})}):l.jsxs("div",{className:"text-center py-5 empty-state",children:[l.jsx("div",{className:"mb-3",children:l.jsx("i",{className:"bi bi-calendar-x display-1 text-muted"})}),l.jsx("h5",{className:"fw-bold text-muted mb-2",children:"Data Tidak Tersedia"}),l.jsx("p",{className:"text-muted mb-0",children:i?`Tidak ada data presensi untuk tanggal ${j(i)}`:"Tidak ada data presensi yang tersedia"})]})]})]}):l.jsxs("div",{className:"text-center py-5 empty-state",children:[l.jsx("div",{className:"mb-3",children:l.jsx("i",{className:"bi bi-clock-history display-1 text-muted"})}),l.jsx("h5",{className:"fw-bold text-muted mb-2",children:"Pilih Data Presensi"}),l.jsx("p",{className:"text-muted mb-0",children:"Silakan pilih mata pelajaran dan kelas terlebih dahulu"})]})},u=()=>{var e;const{user:a}=n((e=>e.auth)),{data:s}=r({page:"",limit:"",search:""}),[t,i]=m.useState(""),[d,c]=m.useState(""),[o,u]=m.useState("daily"),p=null==(e=null==a?void 0:a.subjects)?void 0:e.map((e=>({value:e.id,label:e.name}))),g=null==s?void 0:s.map((e=>({value:e.id,label:e.name})));return l.jsxs(h,{title:"Presensi Siswa",levels:["teacher"],children:[l.jsxs("div",{className:"card mb-4",children:[l.jsx("div",{className:"card-header bg-primary text-white",children:l.jsxs("h5",{className:"card-title mb-0",children:[l.jsx("i",{className:"bi bi-funnel me-2"}),"Filter Data Presensi"]})}),l.jsx("div",{className:"card-body",children:l.jsxs("div",{className:"row g-3",children:[l.jsxs("div",{className:"col-12 col-lg-6",children:[l.jsxs("label",{className:"form-label fw-bold",children:[l.jsx("i",{className:"bi bi-book me-2"}),"Mata Pelajaran:"]}),l.jsx(x,{options:p,isSearchable:!0,placeholder:"Pilih Mata Pelajaran",onChange:e=>c(e.value),className:"react-select-container",classNamePrefix:"react-select",menuPortalTarget:document.body,menuPosition:"fixed",styles:{menuPortal:e=>({...e,zIndex:1})}})]}),l.jsxs("div",{className:"col-12 col-lg-6",children:[l.jsxs("label",{className:"form-label fw-bold",children:[l.jsx("i",{className:"bi bi-people me-2"}),"Kelas:"]}),l.jsx(x,{options:g,isSearchable:!0,placeholder:"Pilih Kelas",onChange:e=>i(e.value),className:"react-select-container",classNamePrefix:"react-select",menuPortalTarget:document.body,menuPosition:"fixed",styles:{menuPortal:e=>({...e,zIndex:1})}})]})]})})]}),t&&d&&l.jsxs("div",{className:"card mb-4",children:[l.jsx("div",{className:"card-header",children:l.jsxs("ul",{className:"nav nav-tabs card-header-tabs",role:"tablist",children:[l.jsx("li",{className:"nav-item",role:"presentation",children:l.jsxs("button",{className:"nav-link "+("daily"===o?"active":""),type:"button",role:"tab",onClick:()=>u("daily"),children:[l.jsx("i",{className:"bi bi-calendar-day me-2"}),"Presensi Harian"]})}),l.jsx("li",{className:"nav-item",role:"presentation",children:l.jsxs("button",{className:"nav-link "+("history"===o?"active":""),type:"button",role:"tab",onClick:()=>u("history"),children:[l.jsx("i",{className:"bi bi-clock-history me-2"}),"Riwayat Presensi"]})}),l.jsx("li",{className:"nav-item",role:"presentation",children:l.jsxs("button",{className:"nav-link "+("summary"===o?"active":""),type:"button",role:"tab",onClick:()=>u("summary"),children:[l.jsx("i",{className:"bi bi-calendar-month me-2"}),"Rangkuman Bulanan"]})})]})}),l.jsx("div",{className:"card-body",children:l.jsxs("div",{className:"tab-content",children:[l.jsx("div",{className:"tab-pane fade "+("daily"===o?"show active":""),children:l.jsx(j,{classid:t,subjectid:d})}),l.jsx("div",{className:"tab-pane fade "+("history"===o?"show active":""),children:l.jsx(N,{classid:t,subjectid:d})}),l.jsx("div",{className:"tab-pane fade "+("summary"===o?"show active":""),children:l.jsx(b,{classid:t,subjectid:d})})]})})]}),(!t||!d)&&l.jsxs("div",{className:"text-center py-5",children:[l.jsx("div",{className:"mb-3",children:l.jsx("i",{className:"bi bi-clipboard2-check display-1 text-muted"})}),l.jsx("h5",{className:"fw-bold text-muted mb-2",children:"Pilih Data Presensi"}),l.jsx("p",{className:"text-muted mb-0",children:"Silakan pilih mata pelajaran dan kelas terlebih dahulu untuk melihat data presensi"})]})]})};export{u as default};
//# sourceMappingURL=TeacherPresensi-DDTtept6.js.map
