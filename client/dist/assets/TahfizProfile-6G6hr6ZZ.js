import{u as s,a,a2 as e,x as l,s as i,V as r,j as c}from"./index-C0Vkf_Fr.js";import{b as n}from"./vendor-BYWiIb5-.js";import{L as d}from"./Layout-DvlfxgHJ.js";const o=()=>{const o=s(),{user:m}=a((s=>s.auth)),[t,h]=n.useState(!1),[b,x]=n.useState({oldPassword:!1,newPassword:!1,confirmPassword:!1}),[j,u]=n.useState({name:"",email:"",phone:"",oldPassword:"",newPassword:"",confirmPassword:""}),[N,{isLoading:p,isSuccess:w,isError:v,reset:f}]=e(),[P]=l(),g=s=>{const{name:a,value:e}=s.target;if("phone"===a){const s=e.replace(/\D/g,""),l=s.startsWith("0")?"62"+s.substring(1):s;u((s=>({...s,[a]:l})))}else u((s=>({...s,[a]:e})))},y=s=>{if(s.preventDefault(),j.newPassword||j.confirmPassword||j.oldPassword){if(j.newPassword!==j.confirmPassword)return void r.error("Password baru tidak cocok!");if(!j.oldPassword)return void r.error("Password lama harus diisi!")}const a={name:j.name,email:j.email,phone:j.phone};j.newPassword&&(a.oldPassword=j.oldPassword,a.newPassword=j.newPassword),r.promise(N(a).unwrap().then((s=>s.message)),{loading:"Memperbarui profil...",success:s=>s,error:s=>s.data.message})},k=s=>{x((a=>({...a,[s]:!a[s]})))};return n.useEffect((()=>{w&&(u({name:"",email:"",phone:"",oldPassword:"",newPassword:"",confirmPassword:""}),h(!1),f(),P().unwrap().then((s=>{o(i(s))})).catch((s=>{r.error("Gagal memuat data pengguna"),console.error("Error: ",s)}))),v&&f()}),[w,v,o,P]),n.useEffect((()=>{m&&u({name:(null==m?void 0:m.name)||"",email:(null==m?void 0:m.email)||"",phone:(null==m?void 0:m.phone)||"",oldPassword:"",newPassword:"",confirmPassword:""})}),[m]),c.jsx(d,{title:"Profile",levels:["tahfiz"],children:c.jsx("div",{className:"container-fluid",children:c.jsxs("div",{className:"row justify-content-center",children:[c.jsx("div",{className:"col-md-6 col-12",children:c.jsxs("div",{className:"card shadow mb-4",children:[c.jsxs("div",{className:"card-header bg-info d-flex justify-content-between align-items-center",children:[c.jsxs("h4",{className:"mb-0",children:[c.jsx("i",{className:"bi bi-person-circle me-2"}),"Informasi Profile"]}),c.jsxs("button",{className:"btn btn-light btn-sm",onClick:()=>h(!t),children:[c.jsx("i",{className:`bi bi-${t?"x-lg":"pencil"} me-1`}),t?"Cancel":"Edit Profile"]})]}),c.jsxs("div",{className:"card-body",children:[c.jsxs("div",{className:"row mb-4",children:[c.jsx("div",{className:"col-md-4 d-flex justify-content-center align-items-center",children:c.jsx("div",{style:{width:100,height:100},className:"rounded-circle bg-light d-flex justify-content-center align-items-center",children:c.jsx("i",{className:"bi bi-person-badge display-5 text-info"})})}),c.jsx("div",{className:"col-md-8",children:t?c.jsxs("form",{onSubmit:y,children:[c.jsxs("div",{className:"mb-3",children:[c.jsx("label",{className:"form-label",children:"Name"}),c.jsx("input",{type:"text",className:"form-control",name:"name",value:j.name,onChange:g})]}),c.jsxs("div",{className:"mb-3",children:[c.jsx("label",{className:"form-label",children:"Email"}),c.jsx("input",{type:"email",className:"form-control",name:"email",value:j.email,onChange:g})]}),c.jsxs("div",{className:"mb-3",children:[c.jsx("label",{className:"form-label",children:"Whatsapp"}),c.jsx("input",{type:"text",className:"form-control",name:"phone",value:j.phone,onChange:g})]}),c.jsxs("button",{type:"submit",className:"btn btn-info",disabled:p,children:[c.jsx("i",{className:"bi bi-save me-1"}),p?"Loading...":"Simpan Perubahan"]})]}):c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:"mb-3",children:null==m?void 0:m.name}),c.jsxs("span",{className:"badge bg-success mb-2",children:[c.jsx("i",{className:"bi bi-check-circle me-1"}),null==m?void 0:m.level]}),(null==m?void 0:m.isactive)?c.jsxs("span",{className:"badge bg-success ms-2",children:[c.jsx("i",{className:"bi bi-check-circle me-1"}),"Aktif"]}):c.jsxs("span",{className:"badge bg-danger ms-2",children:[c.jsx("i",{className:"bi bi-x-circle me-1"}),"Nonaktif"]})]})})]}),!t&&c.jsxs("div",{className:"row",children:[c.jsx("div",{className:"col-md-6 mb-3",children:c.jsx("div",{className:"card h-100",children:c.jsxs("div",{className:"card-body",children:[c.jsxs("h5",{className:"card-title",children:[c.jsx("i",{className:"bi bi-envelope me-2 text-primary"}),"Email"]}),c.jsx("p",{className:"card-text",children:null==m?void 0:m.email})]})})}),c.jsx("div",{className:"col-md-6 mb-3",children:c.jsx("div",{className:"card h-100",children:c.jsxs("div",{className:"card-body",children:[c.jsxs("h5",{className:"card-title",children:[c.jsx("i",{className:"bi bi-telephone me-2 text-primary"}),"Whatsapp"]}),c.jsx("p",{className:"card-text",children:null==m?void 0:m.phone})]})})}),c.jsx("div",{className:"col-md-6 mb-3",children:c.jsx("div",{className:"card h-100",children:c.jsxs("div",{className:"card-body",children:[c.jsxs("h5",{className:"card-title",children:[c.jsx("i",{className:"bi bi-building me-2 text-primary"}),"Satuan"]}),c.jsx("p",{className:"card-text",children:null==m?void 0:m.homebase})]})})}),c.jsx("div",{className:"col-md-6 mb-3",children:c.jsx("div",{className:"card h-100",children:c.jsxs("div",{className:"card-body",children:[c.jsxs("h5",{className:"card-title",children:[c.jsx("i",{className:"bi bi-key me-2 text-primary"}),"Activation ID"]}),c.jsx("p",{className:"card-text small",children:null==m?void 0:m.activation})]})})})]})]})]})}),c.jsx("div",{className:"col-md-6 col-12",children:c.jsxs("div",{className:"card shadow",children:[c.jsx("div",{className:"card-header bg-warning text-dark",children:c.jsxs("h4",{className:"mb-0",children:[c.jsx("i",{className:"bi bi-shield-lock me-2"}),"Ubah Password"]})}),c.jsx("div",{className:"card-body",children:c.jsxs("form",{onSubmit:y,children:[c.jsxs("div",{className:"mb-3",children:[c.jsx("label",{className:"form-label",children:"Password Lama"}),c.jsxs("div",{className:"input-group",children:[c.jsx("input",{type:b.oldPassword?"text":"password",className:"form-control",name:"oldPassword",value:j.oldPassword,onChange:g,placeholder:"Masukkan password lama"}),c.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>k("oldPassword"),children:c.jsx("i",{className:"bi bi-eye"+(b.oldPassword?"-slash":"")})})]})]}),c.jsxs("div",{className:"mb-3",children:[c.jsx("label",{className:"form-label",children:"Password Baru"}),c.jsxs("div",{className:"input-group",children:[c.jsx("input",{type:b.newPassword?"text":"password",className:"form-control",name:"newPassword",value:j.newPassword,onChange:g,placeholder:"Masukkan password baru"}),c.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>k("newPassword"),children:c.jsx("i",{className:"bi bi-eye"+(b.newPassword?"-slash":"")})})]})]}),c.jsxs("div",{className:"mb-3",children:[c.jsx("label",{className:"form-label",children:"Konfirmasi Password Baru"}),c.jsxs("div",{className:"input-group",children:[c.jsx("input",{type:b.confirmPassword?"text":"password",className:"form-control",name:"confirmPassword",value:j.confirmPassword,onChange:g,placeholder:"Konfirmasi password baru"}),c.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>k("confirmPassword"),children:c.jsx("i",{className:"bi bi-eye"+(b.confirmPassword?"-slash":"")})})]})]}),c.jsxs("button",{type:"submit",className:"btn btn-warning",children:[c.jsx("i",{className:"bi bi-key me-1"}),"Ubah Password"]})]})})]})})]})})})};export{o as default};
//# sourceMappingURL=TahfizProfile-6G6hr6ZZ.js.map
