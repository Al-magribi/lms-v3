import{i as e,k as a,l as s,s as i,j as t,m as l,n,I as r,B as d,o,p as m,q as c,r as u,h as p,F as h,t as j}from"./index-DQzW7PZe.js";import{c as x}from"./vendor-BcjG7WjF.js";import{A as b}from"./Add-C7-bik8Z.js";import{C as g,S as v}from"./Cancel-CGTn8B39.js";import{S as f}from"./Pagination-DC8rVK_V.js";import{T as k}from"./TableLayout-B4uFNFKv.js";import{D as y}from"./Table-BMframHx.js";import{P as S}from"./index-BHcxZgCm.js";import{R as C}from"./DeleteOutlined-BIucr4kP.js";import"./SaveOutlined-ULDwMm9Z.js";import"./index-Da7kcvRt.js";const w=({title:d,open:o,setOpen:m,admin:c,setAdmin:u})=>{const{data:p,isLoading:h}=e({page:"",limit:"",search:""}),[j,{isLoading:b,data:k,error:y,isSuccess:S}]=a(),[C]=s.useForm(),w=s.useWatch("level",C),A=()=>{m(!1),u(),C.resetFields()},L=p?.map(e=>({value:e.id,label:e.name}));return x.useEffect(()=>{c?C.setFieldsValue({level:c.level,home:c.homebase,name:c.username,email:c.email,phone:c.phone}):C.resetFields()},[c]),x.useEffect(()=>{S&&(A(),i.success(k.message)),y&&i.error(y.data.message)},[S,k,y]),t.jsx(l,{title:d,open:o,onCancel:A,destroyOnHidden:!0,footer:[t.jsx(g,{disabled:b,onClick:A},"reset"),t.jsx(v,{disabled:b,onClick:()=>C.submit()},"add")],style:{top:20},children:t.jsx(n,{tip:"Memporses data..",spinning:b,children:t.jsxs(s,{form:C,layout:"vertical",onFinish:e=>{if(c){const a={...e,id:c.id};j(a)}else j(e)},validateMessages:{required:"${label} wajib diisi!",types:{email:"${label} tidak valid!",number:"${label} tidak valid!"}},children:[t.jsx(s.Item,{name:"level",label:"Level",rules:[{required:!0}],children:t.jsx(f,{placeholder:"Pilih Level",onChange:e=>{switch(e){case"pusat":C.setFieldsValue({level:"center"});break;case"admin":C.setFieldsValue({level:"admin"});break;case"tahfiz":C.setFieldsValue({level:"tahfiz"});break;case"cms":C.setFieldsValue({level:"cms"})}},options:[{value:"center",label:"Pusat"},{value:"admin",label:"Admin Satuan"},{value:"tahfiz",label:"Tahfiz"},{value:"cms",label:"Konten"}],showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),"admin"===w&&t.jsx(s.Item,{name:"home",label:"Satuan",rules:[{required:!0}],children:t.jsx(f,{placeholder:"Pilih Satuan",options:L,loading:h,showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),t.jsx(s.Item,{name:"name",label:"Username",rules:[{required:!0}],children:t.jsx(r,{placeholder:"Username"})}),t.jsx(s.Item,{name:"email",label:"Email",rules:[{required:!0,type:"email"}],children:t.jsx(r,{placeholder:"Email yang aktif"})}),t.jsx(s.Item,{name:"phone",label:"Whatsapp",rules:[{required:!0,message:"Whatsapp wajib diisi!"},{pattern:/^(62|0)[0-9]{9,15}$/,message:"Nomor Whatsapp tidak valid!"}],children:t.jsx(r,{placeholder:"62*******",type:"tel"})}),t.jsx(s.Item,{name:"password",label:"Password",rules:[{required:!0,type:"password"}],children:t.jsx(r.Password,{placeholder:"Password"})})]})})})},A=({onClick:e})=>t.jsx(d,{icon:t.jsx(o,{}),type:"default",onClick:e,children:"Sunting"}),{Search:L}=r,{Text:I}=u,P=({onEdit:e})=>{const[a,s]=x.useState(1),[l,n]=x.useState(10),[r,o]=x.useState(""),{data:u,isLoading:p}=m({page:a,limit:l,search:r}),[h,{isLoading:j,isSuccess:b,data:g,error:v}]=c();x.useEffect(()=>{b&&i.success(g.message),v&&i.error(v.data.message)},[b,g,v]);const f=[{title:"No",key:"nomor",render:(e,s,i)=>(a-1)*l+i+1},{title:"Username",dataIndex:"username",key:"username",render:(e,a)=>t.jsx(I,{strong:!0,type:a.isactive?"success":"danger",children:e})},{title:"Email",dataIndex:"email",key:"email"},{title:"Level",dataIndex:"level",key:"level"},{title:"Homebase",dataIndex:"homebase",key:"homebase"},{title:"Aksi",key:"action",render:a=>t.jsx(y.Button,{menu:{items:[{key:"edit",label:t.jsx(A,{onClick:()=>(a=>{e(a)})(a),children:"Edit"})},{key:"delete",label:t.jsx(S,{title:"Apakah Anda yakin ingin menghapus data ini?",okText:"Ya",cancelText:"Batal",onConfirm:()=>{return e=a.id,void h(e);var e},children:t.jsx(d,{danger:!0,icon:t.jsx(C,{}),children:"Hapus"})})}]},children:"Pilihan Aksi"})}];return t.jsx(k,{onSearch:e=>{o(e),s(1)},isLoading:p||j,columns:f,source:u?.admin,rowKey:"id",page:a,limit:l,totalData:u?.totalData,onChange:e=>{s(e.current),n(e.pageSize)}})},{Title:E}=j,F=()=>{const[e,a]=x.useState(!1),[s,i]=x.useState({}),[l,n]=x.useState(!1);return t.jsxs(p,{title:"Managemen Administrasi",levels:["center"],children:[t.jsxs(h,{vertical:!0,gap:"middle",children:[t.jsxs(h,{justify:"space-between",children:[t.jsx(E,{level:5,style:{margin:0},children:"Mangemen Administrasi"}),t.jsx(b,{onClick:()=>a(!0)})]}),t.jsx(P,{onEdit:e=>{i(e),n(!0),a(!0)}})]}),t.jsx(w,{title:l?"Edit data Admin":"Tambah Admin",open:e,setOpen:()=>a(!1),admin:s,setAdmin:()=>i({})})]})};export{F as default};
