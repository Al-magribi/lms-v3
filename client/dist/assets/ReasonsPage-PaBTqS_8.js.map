{"version":3,"file":"ReasonsPage-PaBTqS_8.js","sources":["../../src/page/cms/Reasons/ReasonsPage.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Layout from \"../layout/Layout\";\r\nimport CmsModal from \"../components/CmsModal\";\r\nimport CmsForm from \"../components/CmsForm\";\r\nimport { motion } from \"framer-motion\";\r\nimport * as FaIcons from \"react-icons/fa\";\r\nimport * as Fa6Icons from \"react-icons/fa6\";\r\nimport {\r\n  useGetReasonsQuery,\r\n  useAddReasonMutation,\r\n  useDeleteReasonMutation,\r\n} from \"../../../controller/api/cms/ApiReason\";\r\nimport { toast } from \"react-hot-toast\";\r\nimport Table from \"../../../components/table/Table\";\r\n\r\nconst ReasonsPage = () => {\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [modalType, setModalType] = useState(\"add\");\r\n  const [selectedReason, setSelectedReason] = useState(null);\r\n  const [page, setPage] = useState(1);\r\n  const [limit, setLimit] = useState(10);\r\n  const [search, setSearch] = useState(\"\");\r\n  const [formKey, setFormKey] = useState(0);\r\n\r\n  const { data, isLoading, refetch } = useGetReasonsQuery({\r\n    page,\r\n    limit,\r\n    search,\r\n  });\r\n  const { reasons, totalData, totalPage } = data || {};\r\n\r\n  const [\r\n    addReason,\r\n    { isSuccess, error, isLoading: addLoading, data: msg, reset },\r\n  ] = useAddReasonMutation();\r\n  const [deleteReason] = useDeleteReasonMutation();\r\n\r\n  const handleAdd = () => {\r\n    setModalType(\"add\");\r\n    setSelectedReason(null);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleEdit = (reason) => {\r\n    setModalType(\"edit\");\r\n    setSelectedReason(reason);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    if (window.confirm(\"Are you sure you want to delete this reason?\")) {\r\n      try {\r\n        await deleteReason(id).unwrap();\r\n        toast.success(\"Reason deleted successfully\");\r\n        refetch();\r\n      } catch (error) {\r\n        toast.error(error.data?.message || \"Failed to delete reason\");\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (formData) => {\r\n    try {\r\n      await addReason(formData).unwrap();\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setSelectedReason(null);\r\n    setIsModalOpen(false);\r\n    setFormKey((prev) => prev + 1);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isSuccess) {\r\n      toast.success(msg.message);\r\n      setIsModalOpen(false);\r\n      refetch();\r\n      setSelectedReason(null);\r\n      setFormKey((prev) => prev + 1);\r\n      reset();\r\n    }\r\n    if (error) {\r\n      toast.error(error.data?.message);\r\n      reset();\r\n    }\r\n  }, [isSuccess, error, msg, reset, refetch]);\r\n\r\n  const handleCloseModal = () => {\r\n    setIsModalOpen(false);\r\n    setSelectedReason(null);\r\n    setFormKey((prev) => prev + 1);\r\n  };\r\n\r\n  const formFields = [\r\n    {\r\n      name: \"name\",\r\n      label: \"Alasan\",\r\n      type: \"text\",\r\n      required: true,\r\n      placeholder: \"Masukkan alasan\",\r\n    },\r\n    {\r\n      name: \"description\",\r\n      label: \"Deskripsi\",\r\n      type: \"textarea\",\r\n      required: true,\r\n      placeholder: \"Masukkan deskripsi lengkap\",\r\n      rows: 4,\r\n    },\r\n    {\r\n      name: \"icon\",\r\n      label: \"Icon\",\r\n      type: \"text\",\r\n      required: true,\r\n      placeholder: \"Masukkan nama icon\",\r\n      helpText: (\r\n        <>\r\n          Gunakan icon dari library{\" \"}\r\n          <a\r\n            href=\"https://react-icons.github.io/react-icons/\"\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n            className=\"text-primary\"\r\n          >\r\n            react-icons\r\n          </a>{\" \"}\r\n          FontAwesome 5 atau FontAwesome 6\r\n        </>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <Layout>\r\n      <div className=\"container-fluid py-3 py-md-4\">\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ duration: 0.5 }}\r\n        >\r\n          <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n            <div className=\"d-flex align-items-center\">\r\n              <div className=\"bg-primary bg-opacity-10 p-3 rounded me-3\">\r\n                <i className=\"bi bi-lightbulb text-primary fs-4\"></i>\r\n              </div>\r\n              <h4 className=\"mb-0\">Alasan</h4>\r\n            </div>\r\n            <button className=\"btn btn-sm btn-primary\" onClick={handleAdd}>\r\n              <i className=\"bi bi-plus-circle\"></i>\r\n              <span className=\"ms-2\">Tambah Alasan</span>\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"card border-0 shadow-sm\">\r\n            <div className=\"card-body\">\r\n              <Table\r\n                isLoading={isLoading}\r\n                page={page}\r\n                setPage={setPage}\r\n                totalPages={totalPage}\r\n                limit={limit}\r\n                setLimit={setLimit}\r\n                setSearch={setSearch}\r\n                totalData={totalData}\r\n              >\r\n                <table className=\"mb-0 table table-bordered table-striped table-hover\">\r\n                  <thead>\r\n                    <tr>\r\n                      <th className=\"text-center align-middle\">No</th>\r\n                      <th className=\"text-center align-middle\">Icon</th>\r\n                      <th className=\"text-center align-middle\">Alasan</th>\r\n                      <th className=\"text-center align-middle\">Deskripsi</th>\r\n                      <th className=\"text-center align-middle\">Aksi</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {reasons?.map((reason, index) => {\r\n                      const isFa6 = reason?.icon?.startsWith(\"Fa6\");\r\n                      const IconComponent = isFa6\r\n                        ? Fa6Icons[reason.icon] || Fa6Icons.FaRegLightbulb\r\n                        : FaIcons[reason.icon] || FaIcons.FaLightbulb;\r\n\r\n                      return (\r\n                        <tr key={reason.id}>\r\n                          <td className=\"text-center align-middle\">\r\n                            {(page - 1) * limit + index + 1}\r\n                          </td>\r\n                          <td className=\"text-center align-middle\">\r\n                            <div className=\"rounded-circle bg-primary bg-opacity-10 p-3 me-3 text-primary\">\r\n                              <IconComponent className=\"fs-2\" />\r\n                            </div>\r\n                          </td>\r\n                          <td className=\"align-middle\">{reason.name}</td>\r\n                          <td className=\"align-middle\">{reason.description}</td>\r\n                          <td className=\"text-center align-middle\">\r\n                            <div className=\"d-flex align-items-center justify-content-center gap-2\">\r\n                              <button\r\n                                className=\"btn btn-sm btn-warning\"\r\n                                onClick={() => handleEdit(reason)}\r\n                              >\r\n                                <i className=\"bi bi-pencil-square\"></i>\r\n                              </button>\r\n                              <button\r\n                                className=\"btn btn-sm btn-danger\"\r\n                                onClick={() => handleDelete(reason.id)}\r\n                              >\r\n                                <i className=\"bi bi-trash\"></i>\r\n                              </button>\r\n                            </div>\r\n                          </td>\r\n                        </tr>\r\n                      );\r\n                    })}\r\n                  </tbody>\r\n                </table>\r\n              </Table>\r\n            </div>\r\n          </div>\r\n        </motion.div>\r\n      </div>\r\n\r\n      <CmsModal\r\n        isOpen={isModalOpen}\r\n        onClose={handleCloseModal}\r\n        title={modalType === \"add\" ? \"Tambah Alasan\" : \"Edit Alasan\"}\r\n      >\r\n        <CmsForm\r\n          key={formKey}\r\n          fields={formFields}\r\n          initialValues={\r\n            selectedReason || {\r\n              name: \"\",\r\n              description: \"\",\r\n              icon: \"\",\r\n            }\r\n          }\r\n          onSubmit={handleSubmit}\r\n          onCancel={handleCancel}\r\n          submitButtonText={\r\n            modalType === \"add\" ? \"Tambah Alasan\" : \"Ubah Alasan\"\r\n          }\r\n          cancelButtonText=\"Batal\"\r\n          isLoading={addLoading}\r\n        />\r\n      </CmsModal>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default ReasonsPage;\r\n"],"names":["ReasonsPage","isModalOpen","setIsModalOpen","useState","modalType","setModalType","selectedReason","setSelectedReason","page","setPage","limit","setLimit","search","setSearch","formKey","setFormKey","data","isLoading","refetch","useGetReasonsQuery","reasons","totalData","totalPage","addReason","isSuccess","error","addLoading","msg","reset","useAddReasonMutation","deleteReason","useDeleteReasonMutation","useEffect","c","success","message","prev","toast","_a","formFields","name","label","type","required","placeholder","rows","helpText","jsxRuntimeExports","jsxs","Fragment","children","jsx","href","target","rel","className","Layout","motion","div","initial","opacity","y","animate","transition","duration","onClick","Table","totalPages","map","reason","index","IconComponent","icon","startsWith","Fa6Icons","Fa6Icons.FaRegLightbulb","FaIcons","FaIcons.FaLightbulb","description","handleEdit","async","id","window","confirm","unwrap","handleDelete","CmsModal","isOpen","onClose","title","CmsForm","fields","initialValues","onSubmit","formData","console","log","onCancel","submitButtonText","cancelButtonText"],"mappings":"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"}