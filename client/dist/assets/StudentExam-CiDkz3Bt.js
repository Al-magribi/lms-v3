import{a2 as e,a3 as a,as as i,ay as s,az as t,j as n,m as r,F as l,t as o,I as d,s as c,aA as m,a as u,b as j,ap as x,B as h,aB as g,a0 as p,h as k}from"./index-DQzW7PZe.js";import{c as f,i as v}from"./vendor-BcjG7WjF.js";import{A as y}from"./index-CRpkii3Z.js";import{R as S}from"./InfoCircleOutlined-Dt0mBVl3.js";import{S as T}from"./index-Da7kcvRt.js";import{G as C}from"./index-D8nXYbn6.js";import{L as w}from"./index-DsGfmX04.js";import{R as U}from"./ClockCircleOutlined-CYwgD9VW.js";import{R as b}from"./CheckCircleOutlined-D1qSfdtf.js";import{R as A}from"./CloseCircleOutlined-BhRZVOGl.js";import{E as z,P as D}from"./Pagination-DC8rVK_V.js";var I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5l-41.1 41.1-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-44.9 44.9-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-65.3 65.3a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6A304.06 304.06 0 00608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644c-60.9 0-118.2-23.7-161.2-66.8-43.1-43-66.8-100.3-66.8-161.2 0-60.9 23.7-118.2 66.8-161.2 43-43.1 100.3-66.8 161.2-66.8 60.9 0 118.2 23.7 161.2 66.8 43.1 43 66.8 100.3 66.8 161.2 0 60.9-23.7 118.2-66.8 161.2z"}}]},name:"key",theme:"outlined"},O=function(i,s){return f.createElement(e,a({},i,{ref:s,icon:I}))},R=f.forwardRef(O);const{Text:B,Title:E}=o,L=({open:e,onClose:a,exam:o})=>{const[m,u]=v(),[j,x]=f.useState(""),{user:h}=i(e=>e.auth),{data:g,isLoading:p}=s({exam:o.id,student:h?.id},{skip:!o.id||!h?.id}),[k,{isLoading:C}]=t(),w=async()=>{if(!o||!o.id)return void c.error("Ujian tidak ditemukan");if(!h||!h?.id)return void c.error("Data pengguna tidak valid");if(j!==o.token)return c.error("Token Salah"),void x("");if(g&&g.ispenalty)return c.error("Anda melanggar ketentuan"),void x("");if(g&&g.isactive)return c.error("Anda sedang mengikuti ujian"),void x("");if(g&&g.isdone)return c.error("Anda sudah mengikuti ujian"),void x("");const e={exam:o.id.toString(),student:h?.id.toString()};try{await k(e).unwrap(),x(""),u({onExam:!0,name:o.name?.replace(/\s+/g,"-"),examid:o?.id,token:o?.token}),localStorage.removeItem("questions"),a()}catch(i){c.error(i.data?.message||"Terjadi kesalahan")}};return n.jsx(r,{title:n.jsxs(l,{align:"center",gap:"small",children:[n.jsx(R,{}),"Konfirmasi Token Ujian"]}),open:e,onCancel:()=>{x(""),a()},okText:"Mulai Ujian",cancelText:"Batal",destroyOnHidden:!0,confirmLoading:p||C,onOk:w,children:n.jsxs(l,{vertical:!0,gap:"large",children:[n.jsx(y,{message:"Perhatian",description:"Masukkan token yang diberikan oleh pengawas untuk memulai. Pastikan Anda sudah siap sebelum menekan 'Mulai Ujian'.",type:"info",showIcon:!0,icon:n.jsx(S,{})}),n.jsxs(l,{vertical:!0,children:[n.jsx(B,{type:"secondary",children:"Anda akan mengerjakan:"}),n.jsx(E,{level:4,style:{margin:0},children:o.name||"Nama Ujian Tidak Tersedia"})]}),n.jsxs(T,{direction:"vertical",style:{width:"100%"},children:[n.jsx(B,{strong:!0,children:"Token Ujian"}),n.jsx(d,{size:"large",placeholder:"Ketik token di sini",value:j,onChange:e=>x(e.target.value),onPressEnter:w,prefix:n.jsx(R,{style:{color:"rgba(0,0,0,.25)"}})})]})]})})},{useBreakpoint:M}=C,{Title:P,Text:K}=o,{Search:$}=d,_=({classid:e})=>{const[a,i]=f.useState(1),[s,t]=f.useState(9),[r,o]=f.useState(""),[d,c]=f.useState(""),[k,v]=f.useState(""),[y,S]=f.useState(!1),C=M(),{data:I,isLoading:O,isFetching:R}=m({classid:e,page:a,limit:s,search:d},{skip:!e});f.useEffect(()=>{const e=setTimeout(()=>{c(r),i(1)},500);return()=>clearTimeout(e)},[r]);const B=O||R;return n.jsxs(T,{direction:"vertical",size:"large",style:{width:"100%"},children:[n.jsxs(l,{vertical:!C.sm,justify:"space-between",align:C.sm?"center":"stretch",gap:C.sm?16:8,children:[n.jsx(P,{level:5,style:{margin:0},children:"Daftar Ujian Tersedia"}),n.jsx($,{placeholder:"Cari nama ujian...",allowClear:!0,onSearch:e=>o(e),onChange:e=>o(e.target.value),style:{width:C.sm?250:"100%"},value:r})]}),n.jsx(w,{loading:B,grid:{gutter:16,xs:1,sm:2,md:2,lg:3,xl:3,xxl:3},dataSource:I?.exams,locale:{emptyText:n.jsx(z,{description:"Tidak ada ujian yang ditemukan"})},renderItem:e=>n.jsx(w.Item,{children:n.jsx(u,{hoverable:!0,title:n.jsxs(l,{justify:"space-between",align:"center",gap:8,children:[n.jsx(x,{title:e.name,children:n.jsx(K,{style:{fontWeight:"bold"},ellipsis:!0,children:e.name})}),n.jsx(p,{icon:e.isactive?n.jsx(b,{}):n.jsx(A,{}),color:e.isactive?"success":"error",children:e.isactive?"Aktif":"Selesai"})]}),actions:[n.jsx(x,{title:e.isactive?"Masuk ke ruang ujian":"Ujian ini tidak sedang aktif",children:n.jsx(h,{type:"primary",icon:n.jsx(g,{}),disabled:!e.isactive,style:{width:"90%"},onClick:()=>(v(e),void S(!0)),children:"Ikuti Ujian"})},"take-exam")],children:n.jsxs(T,{direction:"vertical",style:{width:"100%"},children:[n.jsxs(K,{type:"secondary",children:[n.jsx(j,{style:{marginRight:8}}),e.teacher_name]}),n.jsxs(K,{type:"secondary",children:[n.jsx(U,{style:{marginRight:8}}),"Durasi: ",e.duration," menit"]})]})})})}),!B&&I?.totalData>0&&n.jsx(l,{justify:"center",children:n.jsx(D,{simple:C.xs,current:a,pageSize:s,total:I?.totalData||0,onChange:(e,a)=>{i(e),t(a)},showSizeChanger:!C.xs,showTotal:C.xs?void 0:(e,a)=>`${a[0]}-${a[1]} dari ${e} Ujian`})}),n.jsx(L,{open:y,onClose:()=>{v(""),S(!1)},exam:k})]})},F=()=>{const{user:e}=i(e=>e.auth);return n.jsx(k,{title:`Daftr Ujian Kelas ${e?.class}`,levels:["student"],children:n.jsx(_,{classid:e?.class_id})})};export{F as default};
