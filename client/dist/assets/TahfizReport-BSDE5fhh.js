import{j as e,bQ as s,bR as a,e as l,bp as d,bF as i}from"./index-DFhdulld.js";import{b as t,u as c}from"./vendor-CnnDPxwB.js";import{L as r}from"./Layout-GZnRoUIy.js";import{T as n}from"./Table-CpyGbvYh.js";import{C as m,b as h,L as x,B as o,c as j,p as b,a as g,d as N}from"./index-BQoB5aE1.js";import{L as p,M as v,e as u,N as y,O as f}from"./index-B8CuzAwO.js";import"./index-g0LoU_Ie.js";const w=({detail:s,setDetail:a,id:l})=>{var d,i;const c=t.useRef(null),r=()=>{a("")};return e.jsx("div",{ref:c,className:"modal fade",id:`modal-${l}`,"data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-primary text-white",children:[e.jsx("h1",{className:"modal-title fs-5",id:"staticBackdropLabel",children:null==s?void 0:s.name}),e.jsx("button",{type:"button",className:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close",onClick:r})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row g-2 mb-3",children:[e.jsx("div",{className:"col-lg-3 col-6",children:e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body p-2",children:[e.jsx("small",{className:"text-muted",children:"Jenis Penilaian"}),e.jsx("p",{className:"mb-0",children:null==s?void 0:s.type})]})})}),e.jsx("div",{className:"col-lg-3 col-6",children:e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body p-2",children:[e.jsx("small",{className:"text-muted",children:"Penguji"}),e.jsx("p",{className:"mb-0",children:null==s?void 0:s.examiner})]})})}),e.jsx("div",{className:"col-lg-3 col-6",children:e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body p-2",children:[e.jsx("small",{className:"text-muted",children:"Nilai"}),e.jsx("p",{className:"mb-0",children:null==s?void 0:s.totalPoints})]})})}),e.jsx("div",{className:"col-lg-3 col-6",children:e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body p-2",children:[e.jsx("small",{className:"text-muted",children:"Tanggal"}),e.jsx("p",{className:"mb-0",children:new Date(null==s?void 0:s.date).toLocaleDateString()})]})})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"m-0 h6",children:"Detail Penilaian"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-bordered table-hover table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center",children:"Kategori"}),e.jsx("th",{className:"text-center",children:"Nilai"}),e.jsx("th",{className:"text-center",children:"Indikator"})]})}),e.jsx("tbody",{children:null==(d=null==s?void 0:s.scores)?void 0:d.map(((s,a)=>{var l;return e.jsxs("tr",{children:[e.jsx("td",{className:"align-middle",children:s.category}),e.jsx("td",{className:"text-center align-middle",children:s.poin}),e.jsx("td",{children:(null==(l=s.indicators)?void 0:l.length)>0?e.jsx("table",{className:"table table-sm mb-0",children:e.jsx("tbody",{children:s.indicators.map(((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:s.indicator}),e.jsx("td",{className:"text-center",children:s.poin||"-"})]},a)))})}):e.jsx("div",{className:"text-center",children:"-"})})]},a)}))})]})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"m-0 h6",children:"Daftar Surah"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-bordered table-hover table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Surah"}),e.jsx("th",{children:"Ayat"}),e.jsx("th",{children:"Baris"})]})}),e.jsx("tbody",{children:null==(i=null==s?void 0:s.surahs)?void 0:i.map(((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:s.name}),e.jsx("td",{children:`${s.from_ayat} - ${s.to_ayat}`}),e.jsx("td",{children:`${s.from_line} - ${s.to_line}`})]},a)))})]})})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:r,children:"Tutup"})})]})})})},k=({type:d})=>{const[i,c]=t.useState(1),[r,m]=t.useState(10),[h,x]=t.useState(""),[o,j]=t.useState(""),[b,g]=t.useState(""),{data:N={},isLoading:p}=s({page:i,limit:r,search:h,type:d}),{report:v=[],totalData:u,totalPages:y}=N,[f,{isLoading:k}]=a();return e.jsxs(n,{isLoading:p,totalData:u,totalPages:y,page:i,setPage:c,limit:r,setLimit:m,setSearch:x,children:[e.jsxs("table",{className:"table table-striped table-hover table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"align-middle text-center",children:"No"}),e.jsx("th",{className:"align-middle text-center",children:"Tanggal"}),e.jsx("th",{className:"align-middle text-center",children:"NIS"}),e.jsx("th",{className:"align-middle text-center",children:"Nama Siswa"}),e.jsx("th",{className:"align-middle text-center",children:"Tingkat"}),e.jsx("th",{className:"align-middle text-center",children:"Kelas"}),e.jsx("th",{className:"align-middle text-center",children:"Jenis Penilaian"}),e.jsx("th",{className:"align-middle text-center",children:"Nilai"}),e.jsx("th",{className:"align-middle text-center",children:"Penguji"}),e.jsx("th",{className:"align-middle text-center",children:"Aksi"})]})}),0===(null==v?void 0:v.length)?e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:11,children:"Belum ada data"})})}):p?e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{children:"Loading.."})})}):e.jsx("tbody",{children:null==v?void 0:v.map(((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-center align-middle",children:a+1}),e.jsx("td",{className:"text-center align-middle",children:new Date(s.date).toLocaleDateString()}),e.jsx("td",{className:"text-center align-middle",children:s.nis}),e.jsx("td",{className:"text-start align-middle",children:s.name}),e.jsx("td",{className:"text-center align-middle",children:s.grade}),e.jsx("td",{className:"text-center align-middle",children:s.class}),e.jsx("td",{className:"text-center align-middle",children:s.type}),e.jsx("td",{className:"text-center align-middle",children:s.totalPoints}),e.jsx("td",{className:"text-center align-middle",children:s.examiner}),e.jsx("td",{className:"align-middle",children:e.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[e.jsx("button",{className:"btn btn-sm btn-primary","data-bs-toggle":"modal","data-bs-target":`#modal-${s.id}`,onClick:()=>((e,s)=>{j(e),g(s)})(s,s.id),title:"Lihat Detail",children:e.jsx("i",{className:"bi bi-eye-fill"})}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>{return e=s.userid,a=s.type_id,d=new Date(s.date).toLocaleDateString(),void(window.confirm("Apakah anda yakin ingin menghapus data ini?")&&l.promise(f({userid:e,typeId:a,createdat:d}).unwrap().then((e=>e.message)),{loading:"Menghapus data...",success:e=>e,error:e=>e.data.message}));var e,a,d},children:e.jsx("i",{className:"bi bi-trash"})})]})})]},a)))})]}),null==v?void 0:v.map(((s,a)=>e.jsx(w,{detail:s.id===b?o:null,setDetail:j,id:s.id},a)))]})},S=({students:s,gradename:a})=>{const l=c(),[d,i]=t.useState(null),[r,n]=t.useState("progress"),m=e=>e>=100?"bg-success":e>=75?"bg-info":e>=50?"bg-warning":"bg-danger";return e.jsx("div",{className:"modal fade",id:"detail-student","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-primary text-white",children:[e.jsxs("h1",{className:"modal-title fs-5",id:"staticBackdropLabel",children:[e.jsx(p,{className:"me-2"}),"Tingkat - ",a]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title",children:[e.jsx(v,{className:"me-2"}),"Informasi Kelas"]}),e.jsxs("p",{className:"card-text",children:["Total Siswa: ",s.length," | Tingkat: ",a]})]})})})}),e.jsx("div",{className:"row g-3",children:s.map(((s,a)=>e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card "+(d===a?"border-primary":""),style:{cursor:"pointer"},onClick:()=>i(a),children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"card-title mb-1",children:s.name}),e.jsxs("p",{className:"card-subtitle text-muted",children:["NIS: ",s.nis," | Kelas: ",s.class]})]}),e.jsxs("button",{className:"btn btn-outline-primary btn-sm",onClick:()=>((e,s)=>{const a=document.querySelector('[data-bs-dismiss="modal"]');a&&a.click();const d=s.replace(/\s+/g,"-");l(`/tahfiz-laporan-siswa/${e}/${d}`)})(s.userid,s.name),children:[e.jsx(u,{className:"me-1"}),"Detail"]})]}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h6",{className:"card-title",children:[e.jsx(y,{className:"me-2"}),"Progress Target"]}),e.jsx("div",{className:"d-flex flex-column gap-2",children:s.progress.map(((s,a)=>e.jsxs("div",{className:"progress-item",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsxs("span",{className:"badge bg-secondary",children:["Juz ",s.juz]}),e.jsxs("span",{className:"badge bg-primary",children:[s.persentase,"%"]})]}),e.jsx("div",{className:"progress",style:{height:"8px"},children:e.jsx("div",{className:`progress-bar ${m(s.persentase)}`,role:"progressbar",style:{width:`${s.persentase}%`},"aria-valuenow":s.persentase,"aria-valuemin":"0","aria-valuemax":"100"})})]},a)))})]})})}),e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h6",{className:"card-title",children:[e.jsx(f,{className:"me-2"}),"Progress Melebihi Target"]}),s.exceed&&s.exceed.length>0?e.jsx("div",{className:"d-flex flex-column gap-2",children:s.exceed.map(((s,a)=>e.jsxs("div",{className:"progress-item",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsxs("span",{className:"badge bg-success",children:["Juz ",s.juz]}),e.jsxs("span",{className:"badge bg-info",children:[s.persentase,"%"]})]}),e.jsx("div",{className:"progress",style:{height:"8px"},children:e.jsx("div",{className:`progress-bar ${m(s.persentase)}`,role:"progressbar",style:{width:`${s.persentase}%`},"aria-valuenow":s.persentase,"aria-valuemin":"0","aria-valuemax":"100"})}),e.jsxs("div",{className:"d-flex justify-content-between mt-1",children:[e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-book-open me-1"}),"Ayat: ",s.verses.completed,"/",s.verses.target]}),e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-align-left me-1"}),"Baris: ",s.lines.completed,"/",s.lines.target]})]})]},a)))}):e.jsx("div",{className:"alert alert-info py-2 mb-0",children:e.jsxs("small",{children:[e.jsx("i",{className:"fas fa-info-circle me-1"}),"Belum ada hafalan melebihi target"]})})]})})})]})]})})},a)))}),null!==d&&e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("ul",{className:"nav nav-tabs card-header-tabs",children:[e.jsx("li",{className:"nav-item",children:e.jsx("button",{className:"nav-link "+("progress"===r?"active":""),onClick:()=>n("progress"),children:"Progress"})}),e.jsx("li",{className:"nav-item",children:e.jsx("button",{className:"nav-link "+("statistics"===r?"active":""),onClick:()=>n("statistics"),children:"Statistik"})})]})}),e.jsxs("div",{className:"card-body",children:["progress"===r&&e.jsxs("div",{className:"student-detail-content",children:[e.jsx("h5",{className:"mb-3",children:"Detail Progress Siswa"}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{children:"Target Hafalan"}),s[d].progress.map(((s,a)=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("span",{children:["Juz ",s.juz]}),e.jsxs("span",{className:"badge bg-primary",children:[s.persentase,"%"]})]}),e.jsx("div",{className:"progress mt-1",style:{height:"10px"},children:e.jsx("div",{className:`progress-bar ${m(s.persentase)}`,style:{width:`${s.persentase}%`}})})]},a)))]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{children:"Hafalan Melebihi Target"}),s[d].exceed&&s[d].exceed.length>0?s[d].exceed.map(((s,a)=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("span",{children:["Juz ",s.juz]}),e.jsxs("span",{className:"badge bg-success",children:[s.persentase,"%"]})]}),e.jsx("div",{className:"progress mt-1",style:{height:"10px"},children:e.jsx("div",{className:`progress-bar ${m(s.persentase)}`,style:{width:`${s.persentase}%`}})}),e.jsx("div",{className:"mt-2",children:e.jsxs("small",{className:"text-muted",children:["Ayat: ",s.verses.completed,"/",s.verses.target," | Baris:"," ",s.lines.completed,"/",s.lines.target]})})]},a))):e.jsx("div",{className:"alert alert-info",children:"Belum ada hafalan melebihi target"})]})]})]}),"statistics"===r&&e.jsxs("div",{className:"student-detail-content",children:[e.jsx("h5",{className:"mb-3",children:"Statistik Hafalan"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h6",{className:"card-title",children:"Rata-rata Progress"}),e.jsxs("p",{className:"card-text",children:[(s[d].progress.reduce(((e,s)=>e+s.persentase),0)/s[d].progress.length).toFixed(1),"%"]})]})})}),e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h6",{className:"card-title",children:"Juz Terbanyak"}),e.jsxs("p",{className:"card-text",children:["Juz"," ",s[d].progress.reduce(((e,s)=>s.persentase>e.persentase?s:e),s[d].progress[0]).juz]})]})})})]})]})]})]})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Tutup"}),e.jsxs("button",{type:"button",className:"btn btn-primary",children:[e.jsx("i",{className:"fas fa-download me-1"}),"Export Data"]})]})]})})})};m.register(h,x,o,j,b,g);const T=()=>{const{data:s,isLoading:a}=d(),[l,i]=t.useState({students:[],gradeName:""});if(console.log(s),a||!s)return e.jsx("div",{children:"Loading..."});const c={responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"Capaian Hafalan Per Tingkat"}},scales:{y:{beginAtZero:!0,max:100}}};return e.jsxs("div",{className:"container-fluid p-0",children:[s.map(((s,a)=>e.jsxs("div",{className:"card mb-4",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h4",{children:s.periode}),e.jsx("small",{className:"text-muted",children:s.homebase})]}),e.jsxs("div",{className:"card-body",children:[s.grade.map(((s,a)=>e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{children:s.name}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"card mb-3",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h6",{children:"Target Hafalan"}),s.target.map(((s,a)=>e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"badge bg-success",children:s.juz}),e.jsxs("small",{className:"badge bg-danger",children:[s.verses," Ayat | ",s.lines," Baris"]})]})},a)))]})})}),e.jsxs("div",{className:"col-md-8",children:[e.jsx("div",{className:"card mb-3",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h6",{children:"Pencapaian Target hafalan"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[e.jsx("span",{children:"Progress Ketuntasan"}),e.jsxs("span",{children:[s.achievement,"%"]})]}),e.jsx("div",{className:"progress",children:e.jsxs("div",{className:"progress-bar "+(s.achievement>=75?"bg-success":s.achievement>=50?"bg-warning":"bg-danger"),role:"progressbar",style:{width:`${s.achievement}%`},"aria-valuenow":s.achievement,"aria-valuemin":"0","aria-valuemax":"100",children:[s.achievement,"%"]})})]}),e.jsxs("div",{className:"row text-center",children:[e.jsxs("div",{className:"col",children:[e.jsx("div",{className:"h5 mb-0",children:s.completed}),e.jsx("small",{className:"text-success",children:"Tuntas"})]}),e.jsxs("div",{className:"col",children:[e.jsx("div",{className:"h5 mb-0",children:s.uncompleted}),e.jsx("small",{className:"text-danger",children:"Belum Tuntas"})]})]})]})}),e.jsx("div",{className:"card mb-3",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h6",{children:"Pencapaian Melebihi Target"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[e.jsx("span",{children:"Progress Ketuntasan"}),e.jsxs("span",{children:[s.exceed_achievement,"%"]})]}),e.jsx("div",{className:"progress",children:e.jsxs("div",{className:"progress-bar "+(s.exceed_achievement>=75?"bg-success":s.exceed_achievement>=50?"bg-warning":"bg-danger"),role:"progressbar",style:{width:`${s.exceed_achievement}%`},"aria-valuenow":s.exceed_achievement,"aria-valuemin":"0","aria-valuemax":"100",children:[s.exceed_achievement,"%"]})})]}),e.jsxs("div",{className:"row text-center",children:[e.jsxs("div",{className:"col",children:[e.jsx("div",{className:"h5 mb-0",children:s.exceed_completed}),e.jsx("small",{className:"text-success",children:"Melebihi Target"})]}),e.jsxs("div",{className:"col",children:[e.jsx("div",{className:"h5 mb-0",children:s.exceed_uncompleted}),e.jsx("small",{className:"text-danger",children:"Belum Melebihi"})]})]}),e.jsx("div",{className:"text-center mt-3",children:e.jsx("button",{className:"btn btn-sm btn-primary","data-bs-toggle":"modal","data-bs-target":"#detail-student",onClick:()=>i({students:s.students,gradeName:s.name}),children:"Lihat Detail Siswa"})})]})})]})]})]},a))),e.jsx("div",{className:"mt-4",children:e.jsx(N,{options:c,data:{labels:s.grade.map((e=>e.name)),datasets:[{label:"Pencapaian Target (%)",data:s.grade.map((e=>e.achievement)),backgroundColor:"rgba(53, 162, 235, 0.5)"},{label:"Siswa Tuntas Target",data:s.grade.map((e=>e.completed)),backgroundColor:"rgba(75, 192, 192, 0.5)"},{label:"Siswa Belum Tuntas Target",data:s.grade.map((e=>e.uncompleted)),backgroundColor:"rgba(255, 99, 132, 0.5)"},{label:"Pencapaian Melebihi Target (%)",data:s.grade.map((e=>e.exceed_achievement)),backgroundColor:"rgba(255, 159, 64, 0.5)"},{label:"Siswa Melebihi Target",data:s.grade.map((e=>e.exceed_completed)),backgroundColor:"rgba(153, 102, 255, 0.5)"},{label:"Siswa Belum Melebihi Target",data:s.grade.map((e=>e.exceed_uncompleted)),backgroundColor:"rgba(255, 205, 86, 0.5)"}]}})})]})]},a))),e.jsx(S,{students:l.students,gradename:l.gradeName})]})},C=()=>{const[s,a]=t.useState(""),[l,d]=t.useState(!1),{data:c}=i({page:"",limit:"",search:""});return e.jsxs(r,{title:"Laporan Hafalan Siswa",levels:["tahfiz"],children:[e.jsx("div",{className:"container-fluid card p-2 mb-2",children:e.jsx("div",{className:"card-body p-0 text-end",children:e.jsxs("div",{className:"btn-group",children:[null==c?void 0:c.map((l=>e.jsx("button",{className:"btn btn-sm "+(s===l.id?"btn-secondary":"btn-outline-secondary"),onClick:()=>a(l.id),children:l.name},l.id))),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>a(""),children:e.jsx("i",{className:"bi bi-recycle"})}),e.jsx("button",{className:"btn btn-sm btn-success",onClick:()=>d(!l),children:l?"Laporan":"Capaian"})]})})}),l?e.jsx(T,{}):e.jsx(k,{type:s})]})};export{C as default};
//# sourceMappingURL=TahfizReport-BSDE5fhh.js.map
