import{a2 as e,a3 as a,l as s,ab as t,ac as r,s as n,j as i,m as l,I as o,B as c,a as d,R as u,C as m,t as h,a0 as j,aa as x,D as g,b as p,ad as y,ae as b,af as v,F as f,ag as k,o as S,ah as C,H as T,ai as w,aj as F,ak as L,al as P,am as I,n as O,an as M,ao as R,ap as E,Z as z,aq as K,h as N,y as A}from"./index-BEdDmCLf.js";import{c as B}from"./vendor-BcjG7WjF.js";import{A as G}from"./Add-tt8mkNHW.js";import{S as D,E as H,P as q}from"./Pagination-B_aQ4HIE.js";import{U as $,R as V}from"./InboxOutlined-C9j-65Yh.js";import{S as _}from"./index-BHMyaDsb.js";import{R as U}from"./InfoCircleOutlined-DuoXnqet.js";import{R as W}from"./BookOutlined-BZg_4GkG.js";import{S as J}from"./index--yz9SaDy.js";import{R as Y}from"./ContainerOutlined-DtE1LAS1.js";import{R as Q}from"./FileTextOutlined-CEmGnz1c.js";import{R as Z}from"./CheckCircleOutlined-BS7bf0Dk.js";import{A as X}from"./index-o2YcaBQV.js";import{R as ee}from"./CloseCircleOutlined-DPIJD4qQ.js";import{R as ae}from"./TeamOutlined-Cbb34YxN.js";import{R as se}from"./DeleteOutlined-D1LT4f_g.js";import{C as te,F as re,D as ne}from"./Table-CdmoA8b3.js";import{P as ie}from"./progress-C5QDlxa-.js";import{T as le}from"./TableLayout-DT_K4LRC.js";import{R as oe}from"./FileAddOutlined-sotM9N2w.js";var ce={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M938 458.8l-29.6-312.6c-1.5-16.2-14.4-29-30.6-30.6L565.2 86h-.4c-3.2 0-5.7 1-7.6 2.9L88.9 557.2a9.96 9.96 0 000 14.1l363.8 363.8c1.9 1.9 4.4 2.9 7.1 2.9s5.2-1 7.1-2.9l468.3-468.3c2-2.1 3-5 2.8-8zM459.7 834.7L189.3 564.3 589 164.6 836 188l23.4 247-399.7 399.7zM680 256c-48.5 0-88 39.5-88 88s39.5 88 88 88 88-39.5 88-88-39.5-88-88-88zm0 120c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"}}]},name:"tag",theme:"outlined"},de=function(s,t){return B.createElement(e,a({},s,{ref:t,icon:ce}))},ue=B.forwardRef(de),me={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"},he=function(s,t){return B.createElement(e,a({},s,{ref:t,icon:me}))},je=B.forwardRef(he);const xe=({open:e,onClose:a,title:d,subject:u})=>{const[m]=s.useForm(),[h,j]=B.useState(null),[x,g]=B.useState(null),[p,y]=B.useState(null),[b,{data:v,isLoading:f,isSuccess:k,error:S,reset:C}]=t(),{data:T,isLoading:w}=r({page:"",limit:"",search:""}),F=T?.map(e=>({value:e.id,label:e.name}))||[],L=B.useMemo(()=>{if(!p||!T)return[];const e=T.find(e=>e.id===p);return e&&e.branches?e.branches.map(e=>({value:e.id,label:e.name})):[]},[p,T]);B.useEffect(()=>{e&&(m.resetFields(),j(null),g(null),y(null),u&&(y(u.category_id),m.setFieldsValue({name:u.name,categoryid:{value:u.category_id,label:u.category_name},branchid:{value:u.branch_id,label:u.branch_name}}),g(u.cover||null)))},[u,m,e]),B.useEffect(()=>{k&&(n.success(v.message),a(),C()),S&&(n.error(S?.data?.message||"Terjadi kesalahan"),C())},[k,S,v,a,C]);const P={beforeUpload:e=>(e.type.startsWith("image/")?(j(e),g(URL.createObjectURL(e))):n.error("Anda hanya bisa mengunggah file gambar!"),!1),onRemove:()=>{j(null),g(u?u.cover:null)},showUploadList:!1};return i.jsx(l,{title:d,open:e,onCancel:a,destroyOnHidden:!0,okText:"Simpan",cancelText:"Tutup",confirmLoading:f,onOk:()=>m.submit(),children:i.jsxs(s,{form:m,layout:"vertical",onFinish:e=>{const a=new FormData;a.append("name",e.name),e.categoryid&&a.append("categoryid",e.categoryid.value),e.branchid&&a.append("branchid",e.branchid.value),h&&a.append("cover",h),u&&a.append("id",u.id),b(a)},style:{marginTop:24},children:[i.jsx(s.Item,{name:"categoryid",label:"Pilih Kategori",rules:[{required:!0,message:"Kategori wajib dipilih"}],children:i.jsx(D,{allowClear:!0,placeholder:"Pilih Kategori",options:F,loading:w,labelInValue:!0,showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),onChange:e=>{y(e?e.value:null),m.setFieldsValue({branchid:null})},getPopupContainer:e=>e.parentNode,virtual:!1})}),i.jsx(s.Item,{name:"branchid",label:"Pilih Rumpun",children:i.jsx(D,{allowClear:!0,placeholder:"Pilih Rumpun",options:L,disabled:!p,loading:w,labelInValue:!0,showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),i.jsx(s.Item,{name:"name",label:"Nama Pelajaran",rules:[{required:!0,message:"Nama pelajaran tidak boleh kosong!"}],children:i.jsx(o,{placeholder:"Contoh: Matematika"})}),i.jsxs(s.Item,{label:"Cover Gambar",children:[i.jsx($.Dragger,{...P,children:x?i.jsx("img",{src:x,alt:"Preview",style:{width:"100%",maxHeight:"180px",objectFit:"contain"}}):i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"ant-upload-drag-icon",children:i.jsx(V,{})}),i.jsx("p",{className:"ant-upload-text",children:"Klik atau seret file ke area ini"})]})}),x&&i.jsx(c,{type:"text",danger:!0,onClick:P.onRemove,style:{marginTop:8,padding:0},children:"Hapus atau Ganti Gambar"})]})]})})},{Title:ge,Text:pe}=h,ye=({open:e,onClose:a,title:s,teachers:t})=>i.jsx(l,{title:i.jsxs(_,{children:[i.jsx(y,{}),`Detail Guru ${s}`]}),open:e,onCancel:a,width:850,footer:[i.jsx(c,{onClick:a,icon:i.jsx(ee,{}),children:"Tutup"},"close")],children:t&&t.length>0?i.jsx("div",{style:{maxHeight:"60vh",overflowY:"auto",paddingRight:"10px"},children:i.jsx(_,{direction:"vertical",size:"large",style:{width:"100%"},children:t.map((e,a)=>i.jsxs(d,{title:i.jsxs(_,{children:[i.jsx(p,{}),i.jsx(pe,{strong:!0,children:e.name})]}),bordered:!1,style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.09)"},children:[i.jsxs(u,{gutter:[24,24],children:[i.jsx(m,{xs:24,md:12,children:i.jsxs(_,{direction:"vertical",style:{width:"100%"},children:[i.jsxs(ge,{level:5,type:"secondary",children:[i.jsx(U,{})," Informasi Guru"]}),i.jsxs("div",{children:[i.jsx(pe,{strong:!0,children:"Nama:"})," ",i.jsx(pe,{children:e.name})]}),i.jsxs("div",{children:[i.jsx(pe,{strong:!0,children:"Kelas yang diajar:"}),i.jsx("div",{style:{marginTop:"8px"},children:e.class&&e.class.length>0?i.jsxs(i.Fragment,{children:[e.class.map((e,a)=>i.jsx(j,{color:"blue",children:e.name},a)),i.jsx("br",{}),i.jsxs(pe,{type:"secondary",style:{fontSize:"12px"},children:["Total: ",e.class.length," kelas"]})]}):i.jsxs(pe,{type:"secondary",children:[i.jsx(x,{})," Belum ditugaskan ke kelas"]})})]})]})}),i.jsx(m,{xs:24,md:12,children:i.jsxs(_,{direction:"vertical",style:{width:"100%"},children:[i.jsxs(ge,{level:5,type:"secondary",children:[i.jsx(W,{})," Statistik Materi"]}),i.jsxs(u,{gutter:16,children:[i.jsx(m,{span:12,children:i.jsx(d,{size:"small",children:i.jsx(J,{title:"Chapter",value:e.chapters||0,prefix:i.jsx(Y,{})})})}),i.jsx(m,{span:12,children:i.jsx(d,{size:"small",children:i.jsx(J,{title:"Materi",value:e.contents||0,prefix:i.jsx(Q,{}),valueStyle:{color:"#389e0d"}})})})]}),(e.chapters>0||e.contents>0)&&i.jsx(j,{icon:i.jsx(Z,{}),color:"success",children:"Guru aktif mengunggah materi"})]})})]}),i.jsx(g,{}),i.jsxs("div",{children:[i.jsxs(ge,{level:5,type:"secondary",children:[i.jsx(je,{})," Detail Chapter dan Materi"]}),e.chapters>0||e.contents>0?i.jsx(X,{message:i.jsx(pe,{strong:!0,children:"Materi Sudah Tersedia"}),description:i.jsxs(_,{children:[i.jsxs(j,{color:"cyan",children:["Total Chapter: ",e.chapters]}),i.jsxs(j,{color:"green",children:["Total Materi: ",e.contents]})]}),type:"success",showIcon:!0}):i.jsx(X,{message:"Belum Ada Materi yang Tersedia",description:"Guru ini belum mengunggah chapter atau materi untuk mata pelajaran ini.",type:"warning",showIcon:!0,icon:i.jsx(x,{})})]})]},a))})}):i.jsx(H,{image:i.jsx(x,{style:{fontSize:64,color:"#faad14"}}),imageStyle:{height:80},description:i.jsxs(i.Fragment,{children:[i.jsx(ge,{level:5,children:"Tidak Ada Data Guru"}),i.jsx(pe,{type:"secondary",children:"Belum ada guru yang ditugaskan untuk mata pelajaran ini."})]})})}),{Meta:be}=d,{confirm:ve}=l,{Text:fe}=h,ke=()=>{const[e,a]=B.useState(1),[s,t]=B.useState(8),[r,l]=B.useState(""),[c,j]=B.useState(""),[x,g]=B.useState(!1),[y,T]=B.useState(!1),[w,F]=B.useState(null),[L,P]=B.useState(!1),[I,O]=B.useState([]),[M,R]=B.useState(""),{data:E,isLoading:z}=b({page:e,limit:s,search:r}),[K]=v();B.useEffect(()=>{const e=setTimeout(()=>{l(c),a(1)},500);return()=>clearTimeout(e)},[c]);return i.jsxs(f,{vertical:!0,gap:"large",children:[i.jsxs(f,{justify:"space-between",align:"center",children:[i.jsxs(f,{vertical:!0,gap:4,children:[i.jsx(h.Title,{level:4,style:{margin:0},children:"Manajemen Pelajaran"}),i.jsx(o.Search,{placeholder:"Cari pelajaran...",value:c,onChange:e=>j(e.target.value),allowClear:!0,style:{width:250}})]}),i.jsx(G,{onClick:()=>g(!0)})]}),z?i.jsx(u,{gutter:[16,16],children:Array.from({length:s}).map((e,a)=>i.jsx(m,{xs:24,sm:12,md:8,lg:6,children:i.jsx(d,{children:i.jsx(C,{active:!0,avatar:{size:"large"}})})},a))}):E?.subjects&&E.subjects.length>0?i.jsxs(f,{vertical:!0,gap:"large",children:[i.jsx(u,{gutter:[16,24],children:E.subjects.map(e=>i.jsx(m,{xs:24,sm:12,md:8,lg:6,children:i.jsx(d,{hoverable:!0,cover:i.jsx("img",{alt:e.name,src:e.cover||"/logo.png",style:{height:200,objectFit:"cover"}}),actions:[i.jsx(p,{onClick:()=>{return a=e.teachers,s=e.name,O(a),R(s),void P(!0);var a,s}},"teachers"),i.jsx(S,{onClick:()=>(F(e),T(!0),void g(!0))},"edit"),i.jsx(se,{onClick:()=>{return a=e.id,void ve({title:"Konfirmasi Hapus Data",content:"Apakah Anda yakin akan menghapus data ini?",okText:"Ya, Hapus",okType:"danger",cancelText:"Batal",onOk:async()=>{try{await K(a).unwrap(),n.success("Pelajaran berhasil dihapus")}catch(e){n.error("Gagal menghapus pelajaran")}}});var a}},"delete")],children:i.jsx(be,{title:i.jsx(h.Title,{level:5,ellipsis:{rows:2},children:e.name}),description:i.jsxs(f,{vertical:!0,gap:8,style:{marginTop:8},children:[i.jsxs(f,{align:"center",gap:6,children:[i.jsx(ue,{style:{color:"#1890ff"}}),i.jsx(fe,{type:"secondary",children:"Kategori:"}),i.jsx(fe,{strong:!0,children:e.category_name||"-"})]}),i.jsxs(f,{align:"center",gap:6,children:[i.jsx(k,{style:{color:"#52c41a"}}),i.jsx(fe,{type:"secondary",children:"Rumpun:"}),i.jsx(fe,{strong:!0,children:e.branch_name||"-"})]}),i.jsxs(f,{align:"center",gap:6,children:[i.jsx(ae,{style:{color:"#faad14"}}),i.jsx(fe,{type:"secondary",children:"Pengajar:"}),i.jsxs(fe,{strong:!0,children:[e.teachers?.length||0," Guru"]})]})]})})})},e.id))}),i.jsx(q,{align:"center",current:e,pageSize:s,total:E?.totalData,onChange:(e,s)=>{a(e),t(s)},showSizeChanger:!0,showTotal:(e,a)=>`${a[0]}-${a[1]} dari ${e} data`})]}):i.jsx(f,{justify:"center",style:{padding:"50px 0"},children:i.jsx(H,{description:"Tidak ada pelajaran yang ditemukan."})}),i.jsx(xe,{title:y?"Edit Pelajaran":"Tambah Pelajaran",open:x,onClose:()=>{g(!1),T(!1),F(null)},subject:w}),i.jsx(ye,{open:L,onClose:()=>{O([]),R(""),P(!1)},teachers:I,title:M})]})},{Option:Se}=D,Ce=({title:e,open:a,onClose:t,teacher:r})=>{const{data:c,isLoading:d}=T({page:"",limit:"",search:""}),{data:u,isLoading:m}=b({page:"",limit:"",search:""}),[h,{isLoading:j,data:x,isSuccess:g,error:p}]=w(),[y]=s.useForm(),v=s.useWatch("homeroom",y),f=c?.map(e=>({label:e.name,value:e.id})),k=u?.map(e=>({label:e.name,value:e.id}));return B.useEffect(()=>{g&&(n.success(x.message),y.resetFields(),t()),p&&n.error(p.data.message)},[x,g,p]),B.useEffect(()=>{a&&(y.resetFields(),r&&y.setFieldsValue({id:r.id,username:r.username||"",name:r.name||"",gender:r.gender||void 0,homeroom:r.homeroom||!1,classid:r.class||void 0,subjects:r.subjects?.map(e=>({value:e.id,label:e.name}))||[]}))},[a,r,y]),i.jsx(l,{title:e,open:a,onCancel:t,okText:"Simpan",cancelText:"Tutup",confirmLoading:j,loading:j,onOk:()=>y.submit(),destroyOnHidden:!0,children:i.jsxs(s,{form:y,layout:"vertical",name:"teacherForm",style:{marginTop:24},onFinish:async()=>{const e={...await y.validateFields()};e.subjects&&(e.subjects=e.subjects.map(e=>({value:e.value}))),h(e)},children:[i.jsx(s.Item,{name:"id",hidden:!0,children:i.jsx(o,{})}),i.jsx(s.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Username is required"}],children:i.jsx(o,{placeholder:"Enter username"})}),i.jsx(s.Item,{name:"name",label:"Nama Guru",rules:[{required:!0,message:"Name is required"}],children:i.jsx(o,{placeholder:"Enter teacher's name"})}),i.jsx(s.Item,{name:"gender",label:"Jenis Kelamin",rules:[{required:!0,message:"Gender is required"}],children:i.jsxs(D,{placeholder:"Select gender",children:[i.jsx(Se,{value:"L",children:"Laki-laki"}),i.jsx(Se,{value:"P",children:"Perempuan"})]})}),i.jsx(s.Item,{name:"subjects",label:"Mata Pelajaran",children:i.jsx(D,{mode:"multiple",allowClear:!0,placeholder:"Select subjects",options:k,loading:m,labelInValue:!0,showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),i.jsx(s.Item,{name:"homeroom",valuePropName:"checked",children:i.jsx(te,{children:"Wali Kelas"})}),v&&i.jsx(s.Item,{name:"classid",label:"Kelas Wali",rules:[{required:!0,message:"Class is required for a homeroom teacher"}],children:i.jsx(D,{placeholder:"Select class",options:f,loading:d,showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})})]})})},{Meta:Te}=d,{confirm:we,info:Fe}=l,Le=()=>{const[e,a]=B.useState(1),[s,t]=B.useState(8),[r,l]=B.useState(""),[c,x]=B.useState(""),[g,y]=B.useState(!1),[b,v]=B.useState(!1),[k,T]=B.useState({}),{data:w,isLoading:I}=F({page:e,limit:s,search:r}),[O,{isLoading:M,data:R,isSuccess:E,error:z}]=L();B.useEffect(()=>{const e=setTimeout(()=>{l(c),a(1)},500);return()=>clearTimeout(e)},[c]),B.useEffect(()=>{E&&n.success(R.message),z&&n.error(z.data.message)},[E,R,z]);return i.jsxs(f,{vertical:!0,gap:"large",children:[i.jsxs(f,{align:"center",justify:"space-between",children:[i.jsxs(_,{direction:"vertical",size:"small",children:[i.jsx(h.Title,{style:{margin:0},level:5,children:"Manajemen Guru"}),i.jsx(o.Search,{placeholder:"Cari guru...",value:c,onChange:e=>x(e.target.value),enterButton:!0,loading:I&&c.length>0,style:{width:250}})]}),i.jsx(G,{onClick:()=>y(!0)})]}),i.jsx(u,{gutter:[16,16],children:I?Array.from({length:s}).map((e,a)=>i.jsx(m,{xs:24,sm:12,md:8,lg:6,children:i.jsx(d,{style:{width:"100%"},children:i.jsx(C,{active:!0,avatar:!0,paragraph:{rows:2}})})},a)):w&&0!==w.teachers.length?w.teachers.map(e=>i.jsx(m,{xs:24,sm:12,md:8,lg:6,children:i.jsxs(d,{hoverable:!0,loading:I||M,style:{width:"100%"},actions:[i.jsx(S,{onClick:()=>(T(e),v(!0),void y(!0))},"edit"),i.jsx(se,{onClick:()=>{return a=e.id,void we({title:"Konfirmasi Hapus Guru",content:"Apakah Anda yakin akan menghapus guru ini?",okText:"Ya, Hapus",okType:"danger",cancelText:"Batal",onOk:()=>{O(a)}});var a}},"delete")],children:[i.jsx(Te,{avatar:i.jsx(P,{src:e.img,icon:i.jsx(p,{})}),title:e.name,description:e.homebase}),i.jsxs(f,{vertical:!0,gap:"small",style:{marginTop:"1rem"},children:[i.jsxs(_,{children:[i.jsx("strong",{children:"Wali Kelas:"}),e.homeroom?i.jsx(j,{color:"green",children:e.class_name}):i.jsx(j,{color:"magenta",children:i.jsx(ee,{})})]}),i.jsx(j,{color:"cyan",onClick:()=>{return a=e.subjects,void Fe({title:"Pelajaran yang diampu",content:i.jsx(i.Fragment,{children:a?.map(e=>i.jsx(j,{color:"blue",style:{marginBottom:4},children:e.name},e.id))}),okText:"Tutup"});var a},children:"Mata Pelajaran"})]})]})},e.id)):i.jsx(m,{span:24,style:{textAlign:"center",marginTop:"50px"},children:i.jsx(H,{description:"Tidak ada data guru yang ditemukan."})})}),i.jsx(q,{current:e,pageSize:s,total:w?.totalData,onChange:(e,s)=>{a(e),t(s)},align:"center",showSizeChanger:!0,showTotal:(e,a)=>`${a[0]}-${a[1]} dari ${e} data`}),i.jsx(Ce,{title:b?"Edit Guru":"Tambah Guru",open:g,onClose:()=>{y(!1),v(!1),T({})},teacher:k})]})},Pe=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],Ie=()=>{const[e,a]=B.useState(1),[s,t]=B.useState(10),[n,l]=B.useState(""),[c,d]=B.useState(""),[u,m]=B.useState(null),[x,g]=B.useState(Pe[(new Date).getMonth()]);B.useEffect(()=>{const e=setTimeout(()=>{d(n),a(1)},500);return()=>clearTimeout(e)},[n]);const{data:p,isError:y,isFetching:b}=I({month:x,page:e,limit:s,search:c,categoryId:u},{skip:!x}),{data:v}=r({page:"",limit:"",search:""}),k=Pe.map(e=>({value:e,label:e})),S=v?.map(e=>({value:e.id,label:e.name})),C=[{title:"Nama Guru",dataIndex:"teacher",key:"teacher"},{title:"Absen",dataIndex:"present",key:"present",render:e=>e?i.jsx(j,{color:"success",children:"Sudah"}):i.jsx(j,{color:"error",children:"Belum"})},{title:"Sumatif",dataIndex:"summative",key:"summative",render:e=>e?i.jsx(j,{color:"success",children:"Sudah"}):i.jsx(j,{color:"error",children:"Belum"})},{title:"Formatif",dataIndex:"formative",key:"formative",render:e=>e?i.jsx(j,{color:"success",children:"Sudah"}):i.jsx(j,{color:"error",children:"Belum"})}],T=p?.statistics||[],w=p?parseFloat(p.completeness):0,F=p?.pagination?.total||0,L=!x;return i.jsxs(f,{vertical:!0,gap:"large",children:[i.jsxs(f,{align:"center",justify:"space-between",children:[i.jsx(h.Title,{style:{margin:0},level:5,children:"Statistik Laporan Bulanan"}),i.jsxs(_,{children:[i.jsx(o.Search,{placeholder:"Cari Guru ...",onChange:e=>l(e.target.value),value:n,allowClear:!0}),i.jsx(D,{style:{width:200},placeholder:"Pilih Kategori",options:S,onChange:e=>{m(e),a(1)},allowClear:!0,value:u,showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1}),i.jsx(D,{style:{width:200},showSearch:!0,allowClear:!0,placeholder:"Pilih Bulan",options:k,onChange:e=>g(e),value:x,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})]})]}),b&&!L&&i.jsx(f,{justify:"center",children:i.jsx(O,{})}),y&&i.jsx(h.Text,{type:"danger",children:"Gagal memuat data."}),L&&i.jsx(h.Text,{type:"secondary",children:"Pilih bulan."}),!L&&!y&&i.jsxs(f,{vertical:!0,gap:"large",children:[i.jsxs(f,{align:"center",gap:"large",children:[i.jsx(h.Text,{children:"Kelengkapan Nilai (Halaman ini):"}),i.jsx(ie,{percent:w,style:{flex:1}})]}),i.jsx(re,{dataSource:T,columns:C,rowKey:"teacher",bordered:!0,loading:b,pagination:{current:e,pageSize:s,total:F},onChange:e=>{a(e.current),t(e.pageSize)},scroll:{x:!0}})]})]})},Oe=({open:e,onClose:a,branch:t,title:r,categoryid:c})=>{const[d]=s.useForm(),[u,{isLoading:m,isSuccess:h,data:j,error:x,reset:g}]=M(),p=()=>{d.resetFields(),a()};return B.useEffect(()=>{e&&(d.resetFields(),t?d.setFieldsValue({name:t.name}):d.resetFields())},[e,t,d]),B.useEffect(()=>{h&&(n.success(j.message),p(),g()),x&&(n.error(x.data.message),g())},[h,j,x]),i.jsx(l,{title:r,open:e,onCancel:p,okText:"Simpan",cancelText:"Tutup",confirmLoading:m,loading:m,onOk:()=>d.submit(),children:i.jsx(O,{spinning:m,tip:"Memperoses data..",children:i.jsx(s,{form:d,layout:"vertical",onFinish:e=>{if(t){const a={...e,categoryid:c,id:t.id};u(a)}else{const a={categoryid:c,...e};u(a)}},children:i.jsx(s.Item,{name:"name",label:"Nama Rumpun",rules:[{required:!0,message:"Nama Wajib diisi"}],children:i.jsx(o,{placeholder:"Nama Rumpun"})})})})})},{confirm:Me}=l,Re=({onEdit:e})=>{const[a,s]=B.useState(1),[t,l]=B.useState(10),[o,c]=B.useState(""),[d,u]=B.useState(!1),[m,h]=B.useState(!1),[x,g]=B.useState(""),[p,y]=B.useState(""),{data:b,isLoading:v}=r({page:a,limit:t,search:o}),[f,{data:k,isLoading:C,isSuccess:T,error:w}]=R(),F=(a,{key:s})=>{switch(s){case"add":g(a),u(!0);break;case"edit":(a=>{e(a)})(a);break;case"delete":t=a.id,Me({title:"Apakah anda yakin menghapus data ini?",icon:i.jsx(z,{}),content:"Data yang dihapus tidak bisa dikembalikan",okText:"Ya, Hapus",okType:"danger",cancelText:"Batal",onOk(){f(t)},onCancel(){n.warning("Aksi dibatalkan")}})}var t};B.useEffect(()=>{T&&n.success(k.message),w&&n.error(w.data.message)},[k,T,w]);const L=[{title:"No",key:"no",render:(e,s,r)=>(a-1)*t+r+1},{title:"Kategori",dataIndex:"name",key:"name"},{title:"Rumpun",dataIndex:"branches",key:"branches",render:(e,a)=>i.jsx(i.Fragment,{children:e?.map(e=>i.jsxs(j,{color:"blue",children:[e.name," ",i.jsx(E,{title:`Edit rumpun ${e.name}`,children:i.jsx(S,{onClick:()=>{return s=a,y(e),g(s),h(!0),void u(!0);var s}})})]},e.id))})},{title:"Aksi",key:"action",render:e=>i.jsx(ne.Button,{menu:{items:[{key:"add",label:"Tambah Rumpun",icon:i.jsx(oe,{})},{key:"edit",label:"Edit",icon:i.jsx(S,{})},{key:"delete",label:"Hapus",icon:i.jsx(se,{}),danger:!0}],onClick:({key:a})=>F(e,{key:a})},children:"Pilihan Aksi"})}];return i.jsxs(i.Fragment,{children:[i.jsx(le,{onSearch:e=>{c(e),s(1)},isLoading:v||C,columns:L,source:b?.categories,rowKey:"id",page:a,limit:t,totalData:b?.totalData,onChange:e=>{s(e.current),l(e.pageSize)}}),i.jsx(Oe,{title:m?`Edit Rumpun ${p.name} di kategori ${x.name}`:`Tambah Rumpun di kategori ${x.name}`,open:d,onClose:()=>{g(""),u(!1),h(!1)},categoryid:x.id,branch:p})]})},Ee=({open:e,onClose:a,category:t,title:r})=>{const[c]=s.useForm(),[d,{isLoading:u,isSuccess:m,data:h,error:j,reset:x}]=K(),g=()=>{c.resetFields(),a()};return B.useEffect(()=>{e&&(c.resetFields(),t?c.setFieldsValue({name:t.name}):c.resetFields())},[e,t,c]),B.useEffect(()=>{m&&(n.success(h.message),g(),x()),j&&(n.error(j.data.message),x())},[m,h,j]),i.jsx(l,{title:r,open:e,onCancel:g,okText:"Simpan",cancelText:"Tutup",confirmLoading:u,loading:u,onOk:()=>c.submit(),children:i.jsx(O,{spinning:u,tip:"Memperoses data..",children:i.jsx(s,{form:c,layout:"vertical",onFinish:e=>{if(t){const a={...e,id:t.id};d(a)}else d(e)},children:i.jsx(s.Item,{name:"name",label:"Nama Kategori",rules:[{required:!0,message:"Nama Wajib diisi"}],children:i.jsx(o,{placeholder:"Nama Kategori"})})})})})},ze=()=>{const[e,a]=B.useState(!1),[s,t]=B.useState(!1),[r,n]=B.useState([]);return i.jsxs(d,{hoverable:!0,title:"Managemen Kategori",extra:i.jsx(G,{onClick:()=>a(!0)}),children:[i.jsx(Re,{onEdit:e=>{n(e),t(!0),a(!0)}}),i.jsx(Ee,{title:s?"Edit Kategori":"Simpan Kategori",open:e,onClose:()=>{n({}),a(!1),t(!1)},category:r})]})},Ke=()=>{const e=[{label:"Kategori",key:"1",children:i.jsx(ze,{})},{label:"Mata Pelajaran",key:"2",children:i.jsx(ke,{})},{label:"Guru",key:"3",children:i.jsx(Le,{})},{label:"Laporan Bulanan",key:"4",children:i.jsx(Ie,{})}];return i.jsx(N,{title:"Management Akademik",levels:["admin"],children:i.jsx(f,{vertical:!0,gap:"middle",children:i.jsx(A,{defaultActiveKey:"1",centered:!0,items:e})})})};export{Ke as default};
