import{a4 as e,a5 as a,at as i,az as s,aA as t,j as n,m as r,F as l,t as o,I as d,s as c,aB as m,a as u,b as j,aq as x,B as h,aC as g,a3 as p,h as k}from"./index-Fj5DVbHb.js";import{c as f,i as v}from"./vendor-BcjG7WjF.js";import{A as y}from"./index-BKYGnTrL.js";import{R as C}from"./InfoCircleOutlined-CXLiL87S.js";import{S}from"./index-DKsWoNNU.js";import{G as T}from"./index-D5e8xr8U.js";import{L as w}from"./index-DGR4umTQ.js";import{R as U}from"./ClockCircleOutlined-DCzA9THd.js";import{R as b}from"./CheckCircleOutlined-DZt8aL_g.js";import{R as A}from"./CloseCircleOutlined-Df1cRux5.js";import{E as z,P as I}from"./Pagination-BnKCvK2K.js";var R={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5l-41.1 41.1-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-44.9 44.9-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-65.3 65.3a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6A304.06 304.06 0 00608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644c-60.9 0-118.2-23.7-161.2-66.8-43.1-43-66.8-100.3-66.8-161.2 0-60.9 23.7-118.2 66.8-161.2 43-43.1 100.3-66.8 161.2-66.8 60.9 0 118.2 23.7 161.2 66.8 43.1 43 66.8 100.3 66.8 161.2 0 60.9-23.7 118.2-66.8 161.2z"}}]},name:"key",theme:"outlined"},D=function(i,s){return f.createElement(e,a({},i,{ref:s,icon:R}))},M=f.forwardRef(D);const{Text:O,Title:B}=o,E=({open:e,onClose:a,exam:o})=>{const[m,u]=v(),[j,x]=f.useState(""),{user:h}=i(e=>e.auth),{data:g,isLoading:p}=s({exam:o.id,student:h?.id},{skip:!o.id||!h?.id}),[k,{isLoading:T}]=t(),w=async()=>{if(!o||!o.id)return void c.error("Ujian tidak ditemukan");if(!h||!h?.id)return void c.error("Data pengguna tidak valid");if(j!==o.token)return c.error("Token Salah"),void x("");if(g&&g.ispenalty)return c.error("Anda melanggar ketentuan"),void x("");if(g&&g.isactive)return c.error("Anda sedang mengikuti ujian"),void x("");if(g&&g.isdone)return c.error("Anda sudah mengikuti ujian"),void x("");const e={exam:o.id.toString(),student:h?.id.toString()};try{await k(e).unwrap(),x(""),u({onExam:!0,name:o.name?.replace(/\s+/g,"-"),examid:o?.id,token:o?.token}),localStorage.removeItem("questions"),a()}catch(i){c.error(i.data?.message||"Terjadi kesalahan")}};return n.jsx(r,{title:n.jsxs(l,{align:"center",gap:"small",children:[n.jsx(M,{}),"Konfirmasi Token Ujian"]}),open:e,onCancel:()=>{x(""),a()},okText:"Mulai Ujian",cancelText:"Batal",destroyOnHidden:!0,confirmLoading:p||T,onOk:w,children:n.jsxs(l,{vertical:!0,gap:"large",children:[n.jsx(y,{message:"Perhatian",description:"Masukkan token yang diberikan oleh pengawas untuk memulai. Pastikan Anda sudah siap sebelum menekan 'Mulai Ujian'.",type:"info",showIcon:!0,icon:n.jsx(C,{})}),n.jsxs(l,{vertical:!0,children:[n.jsx(O,{type:"secondary",children:"Anda akan mengerjakan:"}),n.jsx(B,{level:4,style:{margin:0},children:o.name||"Nama Ujian Tidak Tersedia"})]}),n.jsxs(S,{direction:"vertical",style:{width:"100%"},children:[n.jsx(O,{strong:!0,children:"Token Ujian"}),n.jsx(d,{size:"large",placeholder:"Ketik token di sini",value:j,onChange:e=>x(e.target.value),onPressEnter:w,prefix:n.jsx(M,{style:{color:"rgba(0,0,0,.25)"}})})]})]})})},{useBreakpoint:L}=T,{Title:P,Text:$}=o,{Search:K}=d,q=({classid:e})=>{const[a,i]=f.useState(1),[s,t]=f.useState(9),[r,o]=f.useState(""),[d,c]=f.useState(""),[k,v]=f.useState(""),[y,C]=f.useState(!1),T=L(),{data:R,isLoading:D,isFetching:M}=m({classid:e,page:a,limit:s,search:d},{skip:!e});f.useEffect(()=>{const e=setTimeout(()=>{c(r),i(1)},500);return()=>clearTimeout(e)},[r]);const O=D||M;return n.jsxs(S,{direction:"vertical",size:"large",style:{width:"100%"},children:[n.jsxs(l,{vertical:!T.sm,justify:"space-between",align:T.sm?"center":"stretch",gap:T.sm?16:8,children:[n.jsx(P,{level:5,style:{margin:0},children:"Daftar Ujian Tersedia"}),n.jsx(K,{placeholder:"Cari nama ujian...",allowClear:!0,onSearch:e=>o(e),onChange:e=>o(e.target.value),style:{width:T.sm?250:"100%"},value:r})]}),n.jsx(w,{loading:O,grid:{gutter:16,xs:1,sm:2,md:2,lg:3,xl:3,xxl:3},dataSource:R?.exams,locale:{emptyText:n.jsx(z,{description:"Tidak ada ujian yang ditemukan"})},renderItem:e=>n.jsx(w.Item,{children:n.jsx(u,{hoverable:!0,title:n.jsxs(l,{justify:"space-between",align:"center",gap:8,children:[n.jsx(x,{title:e.name,children:n.jsx($,{style:{fontWeight:"bold"},ellipsis:!0,children:e.name})}),n.jsx(p,{icon:e.isactive?n.jsx(b,{}):n.jsx(A,{}),color:e.isactive?"success":"error",children:e.isactive?"Aktif":"Selesai"})]}),actions:[n.jsx(x,{title:e.isactive?"Masuk ke ruang ujian":"Ujian ini tidak sedang aktif",children:n.jsx(h,{type:"primary",icon:n.jsx(g,{}),disabled:!e.isactive,style:{width:"90%"},onClick:()=>(v(e),void C(!0)),children:"Ikuti Ujian"})},"take-exam")],children:n.jsxs(S,{direction:"vertical",style:{width:"100%"},children:[n.jsxs($,{type:"secondary",children:[n.jsx(j,{style:{marginRight:8}}),e.teacher_name]}),n.jsxs($,{type:"secondary",children:[n.jsx(U,{style:{marginRight:8}}),"Durasi: ",e.duration," menit"]})]})})})}),!O&&R?.totalData>0&&n.jsx(l,{justify:"center",children:n.jsx(I,{simple:T.xs,current:a,pageSize:s,total:R?.totalData||0,onChange:(e,a)=>{i(e),t(a)},showSizeChanger:!T.xs,showTotal:T.xs?void 0:(e,a)=>`${a[0]}-${a[1]} dari ${e} Ujian`})}),n.jsx(E,{open:y,onClose:()=>{v(""),C(!1)},exam:k})]})},F=()=>{const{user:e}=i(e=>e.auth);return n.jsx(k,{title:`Daftr Ujian Kelas ${e?.class}`,levels:["student"],children:n.jsx(q,{classid:e?.class_id})})};export{F as default};
