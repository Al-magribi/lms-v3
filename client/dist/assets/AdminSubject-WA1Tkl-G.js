import{ay as e,j as a,e as s,am as l,c as t,az as i}from"./index-CscvGmZ8.js";import{b as n,u as d}from"./vendor-CnnDPxwB.js";import{L as r}from"./Layout-cU0dvNtb.js";import{T as c}from"./Table-CrNwIEEP.js";import"./index-B8CuzAwO.js";import"./index-g0LoU_Ie.js";import"./index-BpPDjKa5.js";const o=({detail:l,setDetail:t})=>{const[i,d]=n.useState(""),[r,c]=n.useState(""),[o,m]=n.useState(null),u=n.useRef(null),[x,{isSuccess:p,isLoading:j,isError:h,reset:b}]=e(),f=()=>{t({}),d(""),c(""),u.current&&(u.current.value=null)};return n.useEffect((()=>{l&&(d(l.id),c(l.name))}),[l]),n.useEffect((()=>{if(p||h){b(),t({}),d(""),c(""),u.current&&(u.current.value=null);document.querySelector("[data-bs-dismiss='modal']").click()}}),[p,h]),a.jsx("div",{className:"modal fade",id:"addsubject","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"subjectModalLabel","aria-hidden":l&&l.id?"false":"true",children:a.jsx("div",{className:"modal-dialog",children:a.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!r)return s.error("Lengkapi data");const a=new FormData;a.append("id",i||""),a.append("name",r),a.append("cover",o),s.promise(x(a).unwrap().then((e=>e.message)),{loading:"Meyimpan data...",success:e=>e,error:e=>e.data.message})},className:"modal-content p-3",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h5",{className:"modal-title",id:"subjectModalLabel",children:i?"Edit Mata Pelajaran":"Tambah Mata Pelajaran"}),a.jsx("button",{type:"button",className:"btn-close","aria-label":"Close","data-bs-dismiss":"modal",onClick:f})]}),a.jsxs("div",{className:"modal-body d-flex flex-column gap-3",children:[a.jsx("input",{type:"text",name:"name",id:"name",className:"form-control",placeholder:"Nama Mata Pelajaran",value:r||"",onChange:e=>c(e.target.value)}),a.jsxs("div",{className:"input-group",children:[a.jsx("input",{type:"file",className:"form-control",id:"inputGroupFile02",ref:u,onChange:e=>m(e.target.files[0])}),a.jsx("label",{className:"input-group-text",htmlFor:"inputGroupFile02",children:"Cover"})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn btn-warning","data-bs-dismiss":"modal",onClick:f,children:"Batal"}),a.jsx("button",{type:"submit",className:"btn btn-success",disabled:j,children:"Simpan"})]})]})})})},m=({setDetail:e})=>{const r=d(),[o,m]=n.useState(1),[u,x]=n.useState(10),[p,j]=n.useState(""),{data:h={},isLoading:b}=l({page:o,limit:u,search:p}),{data:f}=t(),{totalData:g,totalPages:N,subjects:v=[]}=h,[w,{isSuccess:y,isLoading:k,isError:S,reset:D}]=i();return n.useEffect((()=>{(y||S)&&D()}),[y,S]),a.jsx(c,{page:o,setPage:m,setLimit:x,setSearch:j,totalData:g,totalPages:N,isLoading:b,children:a.jsx("div",{className:"row g-4",children:(null==v?void 0:v.length)>0?null==v?void 0:v.map(((l,t)=>a.jsx("div",{className:"col-12 col-md-6",children:a.jsx("div",{className:"card border shadow-sm hover-shadow h-100 p-0 overflow-hidden",children:a.jsxs("div",{className:"d-flex flex-row h-100",children:[a.jsx("div",{className:"d-flex flex-column align-items-center justify-content-center bg-light",style:{minWidth:110,maxWidth:110},children:a.jsx("img",{src:l.cover?l.cover:null==f?void 0:f.logo,alt:`cover-${l.name}`,width:80,height:100,className:"rounded-3 shadow-sm mt-4 mb-4",style:{objectFit:"cover"}})}),a.jsx("div",{className:"flex-grow-1 d-flex flex-column justify-content-between p-3",children:a.jsxs("div",{children:[a.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[a.jsx("h5",{className:"text-primary mb-2",style:{fontSize:20},children:l.name}),a.jsxs("div",{className:"dropdown",children:[a.jsx("button",{className:"btn btn-sm btn-outline-primary",type:"button",id:`dropdownMenuButton${l.id}`,"data-bs-toggle":"dropdown","aria-expanded":"false",children:a.jsx("i",{className:"bi bi-three-dots-vertical"})}),a.jsxs("ul",{className:"dropdown-menu dropdown-menu-end","aria-labelledby":`dropdownMenuButton${l.id}`,children:[a.jsx("li",{children:a.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2",onClick:()=>((e,a)=>{const s=e.replace(/\s+/g,"-");r(`/pelajaran/${s}/${a}`)})(l.name,l.id),children:[a.jsx("i",{className:"bi bi-eye"})," Detail"]})}),a.jsx("li",{children:a.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2",onClick:()=>e(l),"data-bs-toggle":"modal","data-bs-target":"#addsubject",children:[a.jsx("i",{className:"bi bi-pencil-square"})," Edit"]})}),a.jsx("li",{children:a.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2 text-danger",disabled:k,onClick:()=>{return e=l.id,void(window.confirm("Apakah anda yakin ingin menghapus data mata pelajaran ini dan semua data yang terkait dengan mata pelajaran ini?")&&s.promise(w(e).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message}));var e},children:[a.jsx("i",{className:"bi bi-folder-minus"})," Hapus"]})})]})]})]}),a.jsx("div",{className:"d-flex flex-column gap-2 mb-2",children:l.teachers.length>0?l.teachers.map(((e,s)=>{var l,t;return a.jsxs("div",{className:"d-flex flex-column",children:[a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[a.jsx("span",{className:"fw-medium text-dark",children:e.name}),a.jsx("span",{className:"text-secondary fw-normal small",children:`(${(null==(l=e.class)?void 0:l.length)>0?null==(t=e.class)?void 0:t.map((e=>e.name)).join(", "):"Data belum tersedia"})`})]}),a.jsxs("div",{className:"d-flex gap-4 text-secondary small mt-1",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("i",{className:"bi bi-book me-2"}),a.jsxs("span",{children:[e.chapters," Chapter"]})]}),a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("i",{className:"bi bi-file-text me-2"}),a.jsxs("span",{children:[e.contents," Materi"]})]})]})]},s)})):a.jsx("span",{className:"text-secondary fw-normal small",children:"Data belum tersedia"})})]})})]})})},t))):a.jsx("div",{className:"col-12",children:a.jsxs("div",{className:"alert alert-info d-flex align-items-center gap-2 mb-0",children:[a.jsx("i",{className:"bi bi-info-circle-fill"}),a.jsx("span",{children:"Data tidak tersedia"})]})})})})},u=()=>{const[e,s]=n.useState({});return a.jsxs(r,{title:"Mata Pelajaran",levels:["admin"],children:[a.jsx(o,{detail:e,setDetail:s}),a.jsx(m,{setDetail:s})]})};export{u as default};
//# sourceMappingURL=AdminSubject-WA1Tkl-G.js.map
