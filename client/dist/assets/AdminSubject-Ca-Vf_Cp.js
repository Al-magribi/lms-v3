import{az as e,j as a,e as s,an as l,c as t,aA as n}from"./index-D_xLDGgb.js";import{b as i,u as r}from"./vendor-CnnDPxwB.js";import{L as c}from"./Layout-CeXxh9dB.js";import{T as d}from"./Table-0OluQQdG.js";import"./index-B8CuzAwO.js";import"./index-g0LoU_Ie.js";const m=({detail:l,setDetail:t})=>{const[n,r]=i.useState(""),[c,d]=i.useState(""),[m,o]=i.useState(null),u=i.useRef(null),[p,{isSuccess:x,isLoading:j,isError:h,reset:b}]=e();return i.useEffect((()=>{l&&(r(l.id),d(l.name))}),[l]),i.useEffect((()=>{(x||h)&&(b(),t({}),r(""),d(""),u.current&&(u.current.value=null))}),[x,h]),a.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!c)return s.error("Lengkapi data");const a=new FormData;a.append("id",n||""),a.append("name",c),a.append("cover",m),s.promise(p(a).unwrap().then((e=>e.message)),{loading:"Meyimpan data...",success:e=>e,error:e=>e.data.message})},className:"rounded border p-2 bg-white d-flex flex-column gap-2",children:[a.jsx("p",{className:"m-0 h6",children:"Mata Pelajaran"}),a.jsx("input",{type:"text",name:"name",id:"name",className:"form-control",placeholder:"Nama Mata Pelajaran",value:c||"",onChange:e=>d(e.target.value)}),a.jsxs("div",{className:"input-group",children:[a.jsx("input",{type:"file",className:"form-control",id:"inputGroupFile02",ref:u,onChange:e=>o(e.target.files[0])}),a.jsx("label",{className:"input-group-text",htmlFor:"inputGroupFile02",children:"Cover"})]}),a.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-sm btn-warning",onClick:()=>{t({}),r(""),d(""),u.current&&(u.current.value=null)},children:"Batal"}),a.jsx("button",{type:"submit",className:"btn btn-sm btn-success",disabled:j,children:"Simpan"})]})]})},o=({setDetail:e})=>{const c=r(),[m,o]=i.useState(1),[u,p]=i.useState(10),[x,j]=i.useState(""),{data:h={},isLoading:b}=l({page:m,limit:u,search:x}),{data:g}=t(),{totalData:N,totalPages:v,subjects:f=[]}=h,[w,{isSuccess:y,isLoading:S,isError:k,reset:D}]=n();return i.useEffect((()=>{(y||k)&&D()}),[y,k]),a.jsx(d,{page:m,setPage:o,setLimit:p,setSearch:j,totalData:N,totalPages:v,isLoading:b,children:a.jsx("div",{className:"row g-4",children:(null==f?void 0:f.length)>0?null==f?void 0:f.map(((l,t)=>a.jsx("div",{className:"col-12 col-md-6",children:a.jsx("div",{className:"card shadow-sm h-100",children:a.jsx("div",{className:"card-body",children:a.jsxs("div",{className:"row align-items-center",children:[a.jsx("div",{className:"col-auto",children:a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("span",{className:"badge bg-primary me-3",children:(m-1)*u+t+1}),a.jsx("img",{src:l.cover?l.cover:null==g?void 0:g.logo,alt:`cover-${l.name}`,width:65,height:80,className:"rounded",style:{objectFit:"cover"}})]})}),a.jsxs("div",{className:"col",children:[a.jsx("h5",{className:"card-title mb-3",children:l.name}),a.jsx("div",{className:"d-flex flex-column gap-3",children:l.teachers.map(((e,s)=>{var l,t;return a.jsxs("div",{className:"d-flex flex-column",children:[a.jsxs("p",{className:"m-0 fw-medium",children:[e.name," ",a.jsx("span",{className:"text-secondary fw-normal",children:`(${(null==(l=e.class)?void 0:l.length)>0?null==(t=e.class)?void 0:t.map((e=>e.name)).join(", "):"Data belum tersedia"})`})]}),a.jsxs("div",{className:"d-flex gap-3 text-secondary small",children:[a.jsxs("p",{className:"m-0",children:[a.jsx("i",{className:"bi bi-book me-1"}),e.chapters," Chapter"]}),a.jsxs("p",{className:"m-0",children:[a.jsx("i",{className:"bi bi-file-text me-1"}),e.contents," Materi"]})]})]},s)}))})]}),a.jsx("div",{className:"col-auto",children:a.jsxs("div",{className:"d-flex gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>((e,a)=>{const s=e.replace(/\s+/g,"-");c(`/pelajaran/${s}/${a}`)})(l.name,l.id),children:a.jsx("i",{className:"bi bi-three-dots-vertical"})}),a.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>e(l),children:a.jsx("i",{className:"bi bi-pencil-square"})}),a.jsx("button",{className:"btn btn-sm btn-danger",disabled:S,onClick:()=>{return e=l.id,void(window.confirm("Apakah anda yakin ingin menghapus data mata pelajaran ini dan semua data yang terkait dengan mata pelajaran ini?")&&s.promise(w(e).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message}));var e},children:a.jsx("i",{className:"bi bi-folder-minus"})})]})})]})})})},t))):a.jsx("div",{className:"col-12",children:a.jsx("div",{className:"alert alert-info mb-0",children:"Data tidak tersedia"})})})})},u=()=>{const[e,s]=i.useState({});return a.jsx(c,{title:"Mata Pelajaran",levels:["admin"],children:a.jsxs("div",{className:"row g-2",children:[a.jsx("div",{className:"col-lg-3 col-12",children:a.jsx(m,{detail:e,setDetail:s})}),a.jsx("div",{className:"col-lg-9 col-12",children:a.jsx(o,{setDetail:s})})]})})};export{u as default};
//# sourceMappingURL=AdminSubject-Ca-Vf_Cp.js.map
