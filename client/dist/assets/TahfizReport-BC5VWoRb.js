import{r as h,j as e,bd as S,be as L,d as C,aK as T,b2 as D}from"./index-Bk0R0AbM.js";import{L as P}from"./Layout-DtCUdCMC.js";import{T as $}from"./Table-ojIeP2TN.js";import{C as B,b as I,L as _,B as A,c as R,p as M,a as K,d as z}from"./index-B5hO5s0T.js";const H=({detail:a,setDetail:i,id:d})=>{var t,c;const r=h.useRef(null),n=()=>{i("")};return e.jsx("div",{ref:r,className:"modal fade",id:`modal-${d}`,"data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-primary text-white",children:[e.jsx("h1",{className:"modal-title fs-5",id:"staticBackdropLabel",children:a==null?void 0:a.name}),e.jsx("button",{type:"button",className:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close",onClick:n})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row g-2 mb-3",children:[e.jsx("div",{className:"col-lg-3 col-6",children:e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body p-2",children:[e.jsx("small",{className:"text-muted",children:"Jenis Penilaian"}),e.jsx("p",{className:"mb-0",children:a==null?void 0:a.type})]})})}),e.jsx("div",{className:"col-lg-3 col-6",children:e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body p-2",children:[e.jsx("small",{className:"text-muted",children:"Penguji"}),e.jsx("p",{className:"mb-0",children:a==null?void 0:a.examiner})]})})}),e.jsx("div",{className:"col-lg-3 col-6",children:e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body p-2",children:[e.jsx("small",{className:"text-muted",children:"Nilai"}),e.jsx("p",{className:"mb-0",children:a==null?void 0:a.totalPoints})]})})}),e.jsx("div",{className:"col-lg-3 col-6",children:e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body p-2",children:[e.jsx("small",{className:"text-muted",children:"Tanggal"}),e.jsx("p",{className:"mb-0",children:new Date(a==null?void 0:a.date).toLocaleDateString()})]})})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"m-0 h6",children:"Detail Penilaian"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-bordered table-hover table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center",children:"Kategori"}),e.jsx("th",{className:"text-center",children:"Nilai"}),e.jsx("th",{className:"text-center",children:"Indikator"})]})}),e.jsx("tbody",{children:(t=a==null?void 0:a.scores)==null?void 0:t.map((s,o)=>{var x;return e.jsxs("tr",{children:[e.jsx("td",{className:"align-middle",children:s.category}),e.jsx("td",{className:"text-center align-middle",children:s.poin}),e.jsx("td",{children:((x=s.indicators)==null?void 0:x.length)>0?e.jsx("table",{className:"table table-sm mb-0",children:e.jsx("tbody",{children:s.indicators.map((b,g)=>e.jsxs("tr",{children:[e.jsx("td",{children:b.indicator}),e.jsx("td",{className:"text-center",children:b.poin||"-"})]},g))})}):e.jsx("div",{className:"text-center",children:"-"})})]},o)})})]})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"m-0 h6",children:"Daftar Surah"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-bordered table-hover table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Surah"}),e.jsx("th",{children:"Ayat"}),e.jsx("th",{children:"Baris"})]})}),e.jsx("tbody",{children:(c=a==null?void 0:a.surahs)==null?void 0:c.map((s,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:s.name}),e.jsx("td",{children:`${s.from_ayat} - ${s.to_ayat}`}),e.jsx("td",{children:`${s.from_line} - ${s.to_line}`})]},o))})]})})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:n,children:"Tutup"})})]})})})},E=({type:a})=>{const[i,d]=h.useState(1),[r,n]=h.useState(10),[t,c]=h.useState(""),[s,o]=h.useState(""),[x,b]=h.useState(""),{data:g={},isLoading:u}=S({page:i,limit:r,search:t,type:a}),{report:m=[],totalData:p,totalPages:v}=g,[y,{isLoading:J}]=L(),f=(l,j)=>{o(l),b(j)},w=(l,j,k)=>{C.promise(y({userid:l,typeId:j,createdat:k}).unwrap().then(N=>N.message),{loading:"Menghapus data...",success:N=>N,error:N=>N.data.message})};return e.jsxs($,{isLoading:u,totalData:p,totalPages:v,page:i,setPage:d,limit:r,setLimit:n,setSearch:c,children:[e.jsxs("table",{className:"table table-striped table-hover table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"align-middle text-center",children:"No"}),e.jsx("th",{className:"align-middle text-center",children:"Tanggal"}),e.jsx("th",{className:"align-middle text-center",children:"NIS"}),e.jsx("th",{className:"align-middle text-center",children:"Nama Siswa"}),e.jsx("th",{className:"align-middle text-center",children:"Tingkat"}),e.jsx("th",{className:"align-middle text-center",children:"Kelas"}),e.jsx("th",{className:"align-middle text-center",children:"Jenis Penilaian"}),e.jsx("th",{className:"align-middle text-center",children:"Nilai"}),e.jsx("th",{className:"align-middle text-center",children:"Penguji"}),e.jsx("th",{className:"align-middle text-center",children:"Aksi"})]})}),(m==null?void 0:m.length)===0?e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:11,children:"Belum ada data"})})}):u?e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{children:"Loading.."})})}):e.jsx("tbody",{children:m==null?void 0:m.map((l,j)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-center align-middle",children:j+1}),e.jsx("td",{className:"text-center align-middle",children:new Date(l.date).toLocaleDateString()}),e.jsx("td",{className:"text-center align-middle",children:l.nis}),e.jsx("td",{className:"text-start align-middle",children:l.name}),e.jsx("td",{className:"text-center align-middle",children:l.grade}),e.jsx("td",{className:"text-center align-middle",children:l.class}),e.jsx("td",{className:"text-center align-middle",children:l.type}),e.jsx("td",{className:"text-center align-middle",children:l.totalPoints}),e.jsx("td",{className:"text-center align-middle",children:l.examiner}),e.jsx("td",{className:"align-middle",children:e.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[e.jsx("button",{className:"btn btn-sm btn-primary","data-bs-toggle":"modal","data-bs-target":`#modal-${l.id}`,onClick:()=>f(l,l.id),title:"Lihat Detail",children:e.jsx("i",{className:"bi bi-eye-fill"})}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>w(l.userid,l.type_id,new Date(l.date).toLocaleDateString()),children:e.jsx("i",{className:"bi bi-trash"})})]})})]},j))})]}),m==null?void 0:m.map((l,j)=>e.jsx(H,{detail:l.id===x?s:null,setDetail:o,id:l.id},j))]})};B.register(I,_,A,R,M,K);const G=({show:a,onClose:i,students:d,gradeName:r})=>a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal fade show d-block",tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h5",{className:"modal-title",children:["Tingkat - ",r]}),e.jsx("button",{type:"button",className:"btn-close",onClick:i})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-sm table-bordered table-striped table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"NIS"}),e.jsx("th",{children:"Nama"}),e.jsx("th",{children:"Kelas"}),e.jsx("th",{style:{width:"30%"},children:"Progress"})]})}),e.jsx("tbody",{children:d.map((n,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:n.nis}),e.jsx("td",{children:n.name}),e.jsx("td",{children:n.class}),e.jsx("td",{children:n.progress.map((c,s)=>e.jsxs("div",{className:"mb-1",children:[e.jsxs("small",{className:"d-flex justify-content-between",children:[e.jsx("span",{children:c.juz}),e.jsxs("span",{children:[c.persentase,"%"]})]}),e.jsx("div",{className:"progress",style:{height:"5px"},children:e.jsx("div",{className:`progress-bar ${c.persentase>=100?"bg-success":c.persentase>=75?"bg-info":c.persentase>=50?"bg-warning":"bg-danger"}`,role:"progressbar",style:{width:`${c.persentase}%`},"aria-valuenow":c.persentase,"aria-valuemin":"0","aria-valuemax":"100"})})]},s))})]},t))})]})})}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:i,children:"Tutup"})})]})})}),e.jsx("div",{className:"modal-backdrop fade show"})]}):null,Q=()=>{const{data:a,isLoading:i}=T(),[d,r]=h.useState({show:!1,students:[],gradeName:""});if(console.log(a),i||!a)return e.jsx("div",{children:"Loading..."});const n={responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"Capaian Hafalan Per Tingkat"}},scales:{y:{beginAtZero:!0,max:100}}};return e.jsxs("div",{className:"container-fluid p-0",children:[a.map((t,c)=>e.jsxs("div",{className:"card mb-4",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h4",{children:t.periode}),e.jsx("small",{className:"text-muted",children:t.homebase})]}),e.jsxs("div",{className:"card-body",children:[t.grade.map((s,o)=>e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{children:s.name}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"card mb-3",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h6",{children:"Target Hafalan"}),s.target.map((x,b)=>e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"badge bg-success",children:x.juz}),e.jsxs("small",{className:"badge bg-danger",children:[x.verses," Ayat | ",x.lines," Baris"]})]})},b))]})})}),e.jsx("div",{className:"col-md-8",children:e.jsx("div",{className:"card mb-3",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h6",{children:"Pencapaian Tingkat"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[e.jsx("span",{children:"Progress Ketuntasan"}),e.jsxs("span",{children:[s.achievement,"%"]})]}),e.jsx("div",{className:"progress",children:e.jsxs("div",{className:`progress-bar ${s.achievement>=75?"bg-success":s.achievement>=50?"bg-warning":"bg-danger"}`,role:"progressbar",style:{width:`${s.achievement}%`},"aria-valuenow":s.achievement,"aria-valuemin":"0","aria-valuemax":"100",children:[s.achievement,"%"]})})]}),e.jsxs("div",{className:"row text-center",children:[e.jsxs("div",{className:"col",children:[e.jsx("div",{className:"h5 mb-0",children:s.completed}),e.jsx("small",{className:"text-success",children:"Tuntas"})]}),e.jsxs("div",{className:"col",children:[e.jsx("div",{className:"h5 mb-0",children:s.uncompleted}),e.jsx("small",{className:"text-danger",children:"Belum Tuntas"})]})]}),e.jsx("div",{className:"text-center mt-3",children:e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>r({show:!0,students:s.students,gradeName:s.name}),children:"Lihat Detail Siswa"})})]})})})]})]},o)),e.jsx("div",{className:"mt-4",children:e.jsx(z,{options:n,data:{labels:t.grade.map(s=>s.name),datasets:[{label:"Pencapaian (%)",data:t.grade.map(s=>s.achievement),backgroundColor:"rgba(53, 162, 235, 0.5)"},{label:"Siswa Tuntas",data:t.grade.map(s=>s.completed),backgroundColor:"rgba(75, 192, 192, 0.5)"},{label:"Siswa Belum Tuntas",data:t.grade.map(s=>s.uncompleted),backgroundColor:"rgba(255, 99, 132, 0.5)"}]}})})]})]},c)),e.jsx(G,{show:d.show,students:d.students,gradeName:d.gradeName,onClose:()=>r({show:!1,students:[],gradeName:""})})]})},U=()=>{const[a,i]=h.useState(""),[d,r]=h.useState(!1),{data:n}=D({page:"",limit:"",search:""});return e.jsxs(P,{title:"Laporan Hafalan Siswa",levels:["tahfiz"],children:[e.jsx("div",{className:"container-fluid card p-2 mb-2",children:e.jsx("div",{className:"card-body p-0 text-end",children:e.jsxs("div",{className:"btn-group",children:[n==null?void 0:n.map(t=>e.jsx("button",{className:`btn btn-sm ${a===t.id?"btn-secondary":"btn-outline-secondary"}`,onClick:()=>i(t.id),children:t.name},t.id)),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>i(""),children:e.jsx("i",{className:"bi bi-recycle"})}),e.jsx("button",{className:"btn btn-sm btn-success",onClick:()=>r(!d),children:d?"Laporan":"Capaian"})]})})}),d?e.jsx(Q,{}):e.jsx(E,{type:a})]})};export{U as default};
