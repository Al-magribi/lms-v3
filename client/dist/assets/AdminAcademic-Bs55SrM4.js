import{a1 as e,a2 as a,l as s,a9 as t,aa as r,s as n,j as i,I as l,B as o,a as c,R as d,C as u,r as m,$ as h,D as j,b as x,ab as g,ac as p,ad as y,F as v,ae as b,n as f,af as k,G as S,ag as C,ah as w,ai as T,aj as F,ak as L,m as P,al as M,am as E,an as z,Y as I,ao as O,h as R,x as N}from"./index-uqXiPZaM.js";import{c as A}from"./vendor-DTs43g_X.js";import{A as K}from"./Add-ClBUWLqP.js";import{M as G}from"./index-DzGsxoGF.js";import{S as B,E as D,P as H}from"./Pagination-CcDshGE9.js";import{U as q,R as $}from"./InboxOutlined-DhcWKAB8.js";import{S as V}from"./index-DimbDAWW.js";import{R as _}from"./ExclamationCircleOutlined-D4oG_Mm_.js";import{R as U}from"./BookOutlined-CNrhxhO_.js";import{S as W}from"./index-CSBJDs9d.js";import{R as J}from"./ContainerOutlined-CyeNz6X2.js";import{R as Y}from"./FileTextOutlined-CfU_-iR4.js";import{R as Q}from"./CheckCircleOutlined-Cjmvrnll.js";import{A as X}from"./index-7mhCT5El.js";import{R as Z}from"./CloseCircleOutlined-DUu7cAUq.js";import{R as ee}from"./TeamOutlined-CFCiYsuV.js";import{R as ae}from"./DeleteOutlined-C5VyeaFb.js";import{C as se,F as te,D as re}from"./Table-Cvq4F04g.js";import{P as ne}from"./progress-BWpqLqt3.js";import{T as ie}from"./TableLayout-C9zhRGu7.js";import{R as le}from"./FileAddOutlined-CdXuWoHa.js";var oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"},ce=function(s,t){return A.createElement(e,a({},s,{ref:t,icon:oe}))},de=A.forwardRef(ce),ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M938 458.8l-29.6-312.6c-1.5-16.2-14.4-29-30.6-30.6L565.2 86h-.4c-3.2 0-5.7 1-7.6 2.9L88.9 557.2a9.96 9.96 0 000 14.1l363.8 363.8c1.9 1.9 4.4 2.9 7.1 2.9s5.2-1 7.1-2.9l468.3-468.3c2-2.1 3-5 2.8-8zM459.7 834.7L189.3 564.3 589 164.6 836 188l23.4 247-399.7 399.7zM680 256c-48.5 0-88 39.5-88 88s39.5 88 88 88 88-39.5 88-88-39.5-88-88-88zm0 120c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"}}]},name:"tag",theme:"outlined"},me=function(s,t){return A.createElement(e,a({},s,{ref:t,icon:ue}))},he=A.forwardRef(me),je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"},xe=function(s,t){return A.createElement(e,a({},s,{ref:t,icon:je}))},ge=A.forwardRef(xe);const pe=({open:e,onClose:a,title:c,subject:d})=>{const[u]=s.useForm(),[m,h]=A.useState(null),[j,x]=A.useState(null),[g,p]=A.useState(null),[y,{data:v,isLoading:b,isSuccess:f,error:k,reset:S}]=t(),{data:C,isLoading:w}=r({page:"",limit:"",search:""}),T=C?.map(e=>({value:e.id,label:e.name}))||[],F=A.useMemo(()=>{if(!g||!C)return[];const e=C.find(e=>e.id===g);return e&&e.branches?e.branches.map(e=>({value:e.id,label:e.name})):[]},[g,C]);A.useEffect(()=>{e&&(u.resetFields(),h(null),x(null),p(null),d&&(p(d.category_id),u.setFieldsValue({name:d.name,categoryid:{value:d.category_id,label:d.category_name},branchid:{value:d.branch_id,label:d.branch_name}}),x(d.cover||null)))},[d,u,e]),A.useEffect(()=>{f&&(n.success(v.message),a(),S()),k&&(n.error(k?.data?.message||"Terjadi kesalahan"),S())},[f,k,v,a,S]);const L={beforeUpload:e=>(e.type.startsWith("image/")?(h(e),x(URL.createObjectURL(e))):n.error("Anda hanya bisa mengunggah file gambar!"),!1),onRemove:()=>{h(null),x(d?d.cover:null)},showUploadList:!1};return i.jsx(G,{title:c,open:e,onCancel:a,destroyOnHidden:!0,okText:"Simpan",cancelText:"Tutup",confirmLoading:b,onOk:()=>u.submit(),children:i.jsxs(s,{form:u,layout:"vertical",onFinish:e=>{const a=new FormData;a.append("name",e.name),e.categoryid&&a.append("categoryid",e.categoryid.value),e.branchid&&a.append("branchid",e.branchid.value),m&&a.append("cover",m),d&&a.append("id",d.id),y(a)},style:{marginTop:24},children:[i.jsx(s.Item,{name:"categoryid",label:"Pilih Kategori",rules:[{required:!0,message:"Kategori wajib dipilih"}],children:i.jsx(B,{allowClear:!0,placeholder:"Pilih Kategori",options:T,loading:w,labelInValue:!0,showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),onChange:e=>{p(e?e.value:null),u.setFieldsValue({branchid:null})},getPopupContainer:e=>e.parentNode,virtual:!1})}),i.jsx(s.Item,{name:"branchid",label:"Pilih Rumpun",children:i.jsx(B,{allowClear:!0,placeholder:"Pilih Rumpun",options:F,disabled:!g,loading:w,labelInValue:!0,showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),i.jsx(s.Item,{name:"name",label:"Nama Pelajaran",rules:[{required:!0,message:"Nama pelajaran tidak boleh kosong!"}],children:i.jsx(l,{placeholder:"Contoh: Matematika"})}),i.jsxs(s.Item,{label:"Cover Gambar",children:[i.jsx(q.Dragger,{...L,children:j?i.jsx("img",{src:j,alt:"Preview",style:{width:"100%",maxHeight:"180px",objectFit:"contain"}}):i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"ant-upload-drag-icon",children:i.jsx($,{})}),i.jsx("p",{className:"ant-upload-text",children:"Klik atau seret file ke area ini"})]})}),j&&i.jsx(o,{type:"text",danger:!0,onClick:L.onRemove,style:{marginTop:8,padding:0},children:"Hapus atau Ganti Gambar"})]})]})})},{Title:ye,Text:ve}=m,be=({open:e,onClose:a,title:s,teachers:t})=>i.jsx(G,{title:i.jsxs(V,{children:[i.jsx(g,{}),`Detail Guru ${s}`]}),open:e,onCancel:a,width:850,footer:[i.jsx(o,{onClick:a,icon:i.jsx(Z,{}),children:"Tutup"},"close")],children:t&&t.length>0?i.jsx("div",{style:{maxHeight:"60vh",overflowY:"auto",paddingRight:"10px"},children:i.jsx(V,{direction:"vertical",size:"large",style:{width:"100%"},children:t.map((e,a)=>i.jsxs(c,{title:i.jsxs(V,{children:[i.jsx(x,{}),i.jsx(ve,{strong:!0,children:e.name})]}),bordered:!1,style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.09)"},children:[i.jsxs(d,{gutter:[24,24],children:[i.jsx(u,{xs:24,md:12,children:i.jsxs(V,{direction:"vertical",style:{width:"100%"},children:[i.jsxs(ye,{level:5,type:"secondary",children:[i.jsx(de,{})," Informasi Guru"]}),i.jsxs("div",{children:[i.jsx(ve,{strong:!0,children:"Nama:"})," ",i.jsx(ve,{children:e.name})]}),i.jsxs("div",{children:[i.jsx(ve,{strong:!0,children:"Kelas yang diajar:"}),i.jsx("div",{style:{marginTop:"8px"},children:e.class&&e.class.length>0?i.jsxs(i.Fragment,{children:[e.class.map((e,a)=>i.jsx(h,{color:"blue",children:e.name},a)),i.jsx("br",{}),i.jsxs(ve,{type:"secondary",style:{fontSize:"12px"},children:["Total: ",e.class.length," kelas"]})]}):i.jsxs(ve,{type:"secondary",children:[i.jsx(_,{})," Belum ditugaskan ke kelas"]})})]})]})}),i.jsx(u,{xs:24,md:12,children:i.jsxs(V,{direction:"vertical",style:{width:"100%"},children:[i.jsxs(ye,{level:5,type:"secondary",children:[i.jsx(U,{})," Statistik Materi"]}),i.jsxs(d,{gutter:16,children:[i.jsx(u,{span:12,children:i.jsx(c,{size:"small",children:i.jsx(W,{title:"Chapter",value:e.chapters||0,prefix:i.jsx(J,{})})})}),i.jsx(u,{span:12,children:i.jsx(c,{size:"small",children:i.jsx(W,{title:"Materi",value:e.contents||0,prefix:i.jsx(Y,{}),valueStyle:{color:"#389e0d"}})})})]}),(e.chapters>0||e.contents>0)&&i.jsx(h,{icon:i.jsx(Q,{}),color:"success",children:"Guru aktif mengunggah materi"})]})})]}),i.jsx(j,{}),i.jsxs("div",{children:[i.jsxs(ye,{level:5,type:"secondary",children:[i.jsx(ge,{})," Detail Chapter dan Materi"]}),e.chapters>0||e.contents>0?i.jsx(X,{message:i.jsx(ve,{strong:!0,children:"Materi Sudah Tersedia"}),description:i.jsxs(V,{children:[i.jsxs(h,{color:"cyan",children:["Total Chapter: ",e.chapters]}),i.jsxs(h,{color:"green",children:["Total Materi: ",e.contents]})]}),type:"success",showIcon:!0}):i.jsx(X,{message:"Belum Ada Materi yang Tersedia",description:"Guru ini belum mengunggah chapter atau materi untuk mata pelajaran ini.",type:"warning",showIcon:!0,icon:i.jsx(_,{})})]})]},a))})}):i.jsx(D,{image:i.jsx(_,{style:{fontSize:64,color:"#faad14"}}),imageStyle:{height:80},description:i.jsxs(i.Fragment,{children:[i.jsx(ye,{level:5,children:"Tidak Ada Data Guru"}),i.jsx(ve,{type:"secondary",children:"Belum ada guru yang ditugaskan untuk mata pelajaran ini."})]})})}),{Meta:fe}=c,{confirm:ke}=G,{Text:Se}=m,Ce=()=>{const[e,a]=A.useState(1),[s,t]=A.useState(8),[r,o]=A.useState(""),[h,j]=A.useState(""),[g,S]=A.useState(!1),[C,w]=A.useState(!1),[T,F]=A.useState(null),[L,P]=A.useState(!1),[M,E]=A.useState([]),[z,I]=A.useState(""),{data:O,isLoading:R}=p({page:e,limit:s,search:r}),[N]=y();A.useEffect(()=>{const e=setTimeout(()=>{o(h),a(1)},500);return()=>clearTimeout(e)},[h]);return i.jsxs(v,{vertical:!0,gap:"large",children:[i.jsxs(v,{justify:"space-between",align:"center",children:[i.jsxs(v,{vertical:!0,gap:4,children:[i.jsx(m.Title,{level:4,style:{margin:0},children:"Manajemen Pelajaran"}),i.jsx(l.Search,{placeholder:"Cari pelajaran...",value:h,onChange:e=>j(e.target.value),allowClear:!0,style:{width:250}})]}),i.jsx(K,{onClick:()=>S(!0)})]}),R?i.jsx(d,{gutter:[16,16],children:Array.from({length:s}).map((e,a)=>i.jsx(u,{xs:24,sm:12,md:8,lg:6,children:i.jsx(c,{children:i.jsx(k,{active:!0,avatar:{size:"large"}})})},a))}):O?.subjects&&O.subjects.length>0?i.jsxs(v,{vertical:!0,gap:"large",children:[i.jsx(d,{gutter:[16,24],children:O.subjects.map(e=>i.jsx(u,{xs:24,sm:12,md:8,lg:6,children:i.jsx(c,{hoverable:!0,cover:i.jsx("img",{alt:e.name,src:e.cover||"/logo.png",style:{height:200,objectFit:"cover"}}),actions:[i.jsx(x,{onClick:()=>{return a=e.teachers,s=e.name,E(a),I(s),void P(!0);var a,s}},"teachers"),i.jsx(f,{onClick:()=>(F(e),w(!0),void S(!0))},"edit"),i.jsx(ae,{onClick:()=>{return a=e.id,void ke({title:"Konfirmasi Hapus Data",content:"Apakah Anda yakin akan menghapus data ini?",okText:"Ya, Hapus",okType:"danger",cancelText:"Batal",onOk:async()=>{try{await N(a).unwrap(),n.success("Pelajaran berhasil dihapus")}catch(e){n.error("Gagal menghapus pelajaran")}}});var a}},"delete")],children:i.jsx(fe,{title:i.jsx(m.Title,{level:5,ellipsis:{rows:2},children:e.name}),description:i.jsxs(v,{vertical:!0,gap:8,style:{marginTop:8},children:[i.jsxs(v,{align:"center",gap:6,children:[i.jsx(he,{style:{color:"#1890ff"}}),i.jsx(Se,{type:"secondary",children:"Kategori:"}),i.jsx(Se,{strong:!0,children:e.category_name||"-"})]}),i.jsxs(v,{align:"center",gap:6,children:[i.jsx(b,{style:{color:"#52c41a"}}),i.jsx(Se,{type:"secondary",children:"Rumpun:"}),i.jsx(Se,{strong:!0,children:e.branch_name||"-"})]}),i.jsxs(v,{align:"center",gap:6,children:[i.jsx(ee,{style:{color:"#faad14"}}),i.jsx(Se,{type:"secondary",children:"Pengajar:"}),i.jsxs(Se,{strong:!0,children:[e.teachers?.length||0," Guru"]})]})]})})})},e.id))}),i.jsx(H,{align:"center",current:e,pageSize:s,total:O?.totalData,onChange:(e,s)=>{a(e),t(s)},showSizeChanger:!0,showTotal:(e,a)=>`${a[0]}-${a[1]} dari ${e} data`})]}):i.jsx(v,{justify:"center",style:{padding:"50px 0"},children:i.jsx(D,{description:"Tidak ada pelajaran yang ditemukan."})}),i.jsx(pe,{title:C?"Edit Pelajaran":"Tambah Pelajaran",open:g,onClose:()=>{S(!1),w(!1),F(null)},subject:T}),i.jsx(be,{open:L,onClose:()=>{E([]),I(""),P(!1)},teachers:M,title:z})]})},{Option:we}=B,Te=({title:e,open:a,onClose:t,teacher:r})=>{const{data:o,isLoading:c}=S({page:"",limit:"",search:""}),{data:d,isLoading:u}=p({page:"",limit:"",search:""}),[m,{isLoading:h,data:j,isSuccess:x,error:g}]=C(),[y]=s.useForm(),v=s.useWatch("homeroom",y),b=o?.map(e=>({label:e.name,value:e.id})),f=d?.map(e=>({label:e.name,value:e.id}));return A.useEffect(()=>{x&&(n.success(j.message),y.resetFields(),t()),g&&n.error(g.data.message)},[j,x,g]),A.useEffect(()=>{a&&(y.resetFields(),r&&y.setFieldsValue({id:r.id,username:r.username||"",name:r.name||"",gender:r.gender||void 0,homeroom:r.homeroom||!1,classid:r.class||void 0,subjects:r.subjects?.map(e=>({value:e.id,label:e.name}))||[]}))},[a,r,y]),i.jsx(G,{title:e,open:a,onCancel:t,okText:"Simpan",cancelText:"Tutup",confirmLoading:h,loading:h,onOk:()=>y.submit(),destroyOnHidden:!0,children:i.jsxs(s,{form:y,layout:"vertical",name:"teacherForm",style:{marginTop:24},onFinish:async()=>{const e={...await y.validateFields()};e.subjects&&(e.subjects=e.subjects.map(e=>({value:e.value}))),m(e)},children:[i.jsx(s.Item,{name:"id",hidden:!0,children:i.jsx(l,{})}),i.jsx(s.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Username is required"}],children:i.jsx(l,{placeholder:"Enter username"})}),i.jsx(s.Item,{name:"name",label:"Nama Guru",rules:[{required:!0,message:"Name is required"}],children:i.jsx(l,{placeholder:"Enter teacher's name"})}),i.jsx(s.Item,{name:"gender",label:"Jenis Kelamin",rules:[{required:!0,message:"Gender is required"}],children:i.jsxs(B,{placeholder:"Select gender",children:[i.jsx(we,{value:"L",children:"Laki-laki"}),i.jsx(we,{value:"P",children:"Perempuan"})]})}),i.jsx(s.Item,{name:"subjects",label:"Mata Pelajaran",children:i.jsx(B,{mode:"multiple",allowClear:!0,placeholder:"Select subjects",options:f,loading:u,labelInValue:!0,showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})}),i.jsx(s.Item,{name:"homeroom",valuePropName:"checked",children:i.jsx(se,{children:"Wali Kelas"})}),v&&i.jsx(s.Item,{name:"classid",label:"Kelas Wali",rules:[{required:!0,message:"Class is required for a homeroom teacher"}],children:i.jsx(B,{placeholder:"Select class",options:b,loading:c,showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})})]})})},{Meta:Fe}=c,{confirm:Le,info:Pe}=G,Me=()=>{const[e,a]=A.useState(1),[s,t]=A.useState(8),[r,o]=A.useState(""),[j,g]=A.useState(""),[p,y]=A.useState(!1),[b,S]=A.useState(!1),[C,L]=A.useState({}),{data:P,isLoading:M}=w({page:e,limit:s,search:r}),[E,{isLoading:z,data:I,isSuccess:O,error:R}]=T();A.useEffect(()=>{const e=setTimeout(()=>{o(j),a(1)},500);return()=>clearTimeout(e)},[j]),A.useEffect(()=>{O&&n.success(I.message),R&&n.error(R.data.message)},[O,I,R]);return i.jsxs(v,{vertical:!0,gap:"large",children:[i.jsxs(v,{align:"center",justify:"space-between",children:[i.jsxs(V,{direction:"vertical",size:"small",children:[i.jsx(m.Title,{style:{margin:0},level:5,children:"Manajemen Guru"}),i.jsx(l.Search,{placeholder:"Cari guru...",value:j,onChange:e=>g(e.target.value),enterButton:!0,loading:M&&j.length>0,style:{width:250}})]}),i.jsx(K,{onClick:()=>y(!0)})]}),i.jsx(d,{gutter:[16,16],children:M?Array.from({length:s}).map((e,a)=>i.jsx(u,{xs:24,sm:12,md:8,lg:6,children:i.jsx(c,{style:{width:"100%"},children:i.jsx(k,{active:!0,avatar:!0,paragraph:{rows:2}})})},a)):P&&0!==P.teachers.length?P.teachers.map(e=>i.jsx(u,{xs:24,sm:12,md:8,lg:6,children:i.jsxs(c,{hoverable:!0,loading:M||z,style:{width:"100%"},actions:[i.jsx(f,{onClick:()=>(L(e),S(!0),void y(!0))},"edit"),i.jsx(ae,{onClick:()=>{return a=e.id,void Le({title:"Konfirmasi Hapus Guru",content:"Apakah Anda yakin akan menghapus guru ini?",okText:"Ya, Hapus",okType:"danger",cancelText:"Batal",onOk:()=>{E(a)}});var a}},"delete")],children:[i.jsx(Fe,{avatar:i.jsx(F,{src:e.img,icon:i.jsx(x,{})}),title:e.name,description:e.homebase}),i.jsxs(v,{vertical:!0,gap:"small",style:{marginTop:"1rem"},children:[i.jsxs(V,{children:[i.jsx("strong",{children:"Wali Kelas:"}),e.homeroom?i.jsx(h,{color:"green",children:e.class_name}):i.jsx(h,{color:"magenta",children:i.jsx(Z,{})})]}),i.jsx(h,{color:"cyan",onClick:()=>{return a=e.subjects,void Pe({title:"Pelajaran yang diampu",content:i.jsx(i.Fragment,{children:a?.map(e=>i.jsx(h,{color:"blue",style:{marginBottom:4},children:e.name},e.id))}),okText:"Tutup"});var a},children:"Mata Pelajaran"})]})]})},e.id)):i.jsx(u,{span:24,style:{textAlign:"center",marginTop:"50px"},children:i.jsx(D,{description:"Tidak ada data guru yang ditemukan."})})}),i.jsx(H,{current:e,pageSize:s,total:P?.totalData,onChange:(e,s)=>{a(e),t(s)},align:"center",showSizeChanger:!0,showTotal:(e,a)=>`${a[0]}-${a[1]} dari ${e} data`}),i.jsx(Te,{title:b?"Edit Guru":"Tambah Guru",open:p,onClose:()=>{y(!1),S(!1),L({})},teacher:C})]})},Ee=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],ze=()=>{const[e,a]=A.useState(1),[s,t]=A.useState(10),[n,o]=A.useState(""),[c,d]=A.useState(""),[u,j]=A.useState(null),[x,g]=A.useState(Ee[(new Date).getMonth()]);A.useEffect(()=>{const e=setTimeout(()=>{d(n),a(1)},500);return()=>clearTimeout(e)},[n]);const{data:p,isError:y,isFetching:b}=L({month:x,page:e,limit:s,search:c,categoryId:u},{skip:!x}),{data:f}=r({page:"",limit:"",search:""}),k=Ee.map(e=>({value:e,label:e})),S=f?.map(e=>({value:e.id,label:e.name})),C=[{title:"Nama Guru",dataIndex:"teacher",key:"teacher"},{title:"Absen",dataIndex:"present",key:"present",render:e=>e?i.jsx(h,{color:"success",children:"Sudah"}):i.jsx(h,{color:"error",children:"Belum"})},{title:"Sumatif",dataIndex:"summative",key:"summative",render:e=>e?i.jsx(h,{color:"success",children:"Sudah"}):i.jsx(h,{color:"error",children:"Belum"})},{title:"Formatif",dataIndex:"formative",key:"formative",render:e=>e?i.jsx(h,{color:"success",children:"Sudah"}):i.jsx(h,{color:"error",children:"Belum"})}],w=p?.statistics||[],T=p?parseFloat(p.completeness):0,F=p?.pagination?.total||0,M=!x;return i.jsxs(v,{vertical:!0,gap:"large",children:[i.jsxs(v,{align:"center",justify:"space-between",children:[i.jsx(m.Title,{style:{margin:0},level:5,children:"Statistik Laporan Bulanan"}),i.jsxs(V,{children:[i.jsx(l.Search,{placeholder:"Cari Guru ...",onChange:e=>o(e.target.value),value:n,allowClear:!0}),i.jsx(B,{style:{width:200},placeholder:"Pilih Kategori",options:S,onChange:e=>{j(e),a(1)},allowClear:!0,value:u,showSearch:!0,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1}),i.jsx(B,{style:{width:200},showSearch:!0,allowClear:!0,placeholder:"Pilih Bulan",options:k,onChange:e=>g(e),value:x,filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,virtual:!1})]})]}),b&&!M&&i.jsx(v,{justify:"center",children:i.jsx(P,{})}),y&&i.jsx(m.Text,{type:"danger",children:"Gagal memuat data."}),M&&i.jsx(m.Text,{type:"secondary",children:"Pilih bulan."}),!M&&!y&&i.jsxs(v,{vertical:!0,gap:"large",children:[i.jsxs(v,{align:"center",gap:"large",children:[i.jsx(m.Text,{children:"Kelengkapan Nilai (Halaman ini):"}),i.jsx(ne,{percent:T,style:{flex:1}})]}),i.jsx(te,{dataSource:w,columns:C,rowKey:"teacher",bordered:!0,loading:b,pagination:{current:e,pageSize:s,total:F},onChange:e=>{a(e.current),t(e.pageSize)},scroll:{x:!0}})]})]})},Ie=({open:e,onClose:a,branch:t,title:r,categoryid:o})=>{const[c]=s.useForm(),[d,{isLoading:u,isSuccess:m,data:h,error:j,reset:x}]=M(),g=()=>{c.resetFields(),a()};return A.useEffect(()=>{e&&(c.resetFields(),t?c.setFieldsValue({name:t.name}):c.resetFields())},[e,t,c]),A.useEffect(()=>{m&&(n.success(h.message),g(),x()),j&&(n.error(j.data.message),x())},[m,h,j]),i.jsx(G,{title:r,open:e,onCancel:g,okText:"Simpan",cancelText:"Tutup",confirmLoading:u,loading:u,onOk:()=>c.submit(),children:i.jsx(P,{spinning:u,tip:"Memperoses data..",children:i.jsx(s,{form:c,layout:"vertical",onFinish:e=>{if(t){const a={...e,categoryid:o,id:t.id};d(a)}else{const a={categoryid:o,...e};d(a)}},children:i.jsx(s.Item,{name:"name",label:"Nama Rumpun",rules:[{required:!0,message:"Nama Wajib diisi"}],children:i.jsx(l,{placeholder:"Nama Rumpun"})})})})})},{confirm:Oe}=G,Re=({onEdit:e})=>{const[a,s]=A.useState(1),[t,l]=A.useState(10),[o,c]=A.useState(""),[d,u]=A.useState(!1),[m,j]=A.useState(!1),[x,g]=A.useState(""),[p,y]=A.useState(""),{data:v,isLoading:b}=r({page:a,limit:t,search:o}),[k,{data:S,isLoading:C,isSuccess:w,error:T}]=E(),F=(a,{key:s})=>{switch(s){case"add":g(a),u(!0);break;case"edit":(a=>{e(a)})(a);break;case"delete":t=a.id,Oe({title:"Apakah anda yakin menghapus data ini?",icon:i.jsx(I,{}),content:"Data yang dihapus tidak bisa dikembalikan",okText:"Ya, Hapus",okType:"danger",cancelText:"Batal",onOk(){k(t)},onCancel(){n.warning("Aksi dibatalkan")}})}var t};A.useEffect(()=>{w&&n.success(S.message),T&&n.error(T.data.message)},[S,w,T]);const L=[{title:"No",key:"no",render:(e,s,r)=>(a-1)*t+r+1},{title:"Kategori",dataIndex:"name",key:"name"},{title:"Rumpun",dataIndex:"branches",key:"branches",render:(e,a)=>i.jsx(i.Fragment,{children:e?.map(e=>i.jsxs(h,{color:"blue",children:[e.name," ",i.jsx(z,{title:`Edit rumpun ${e.name}`,children:i.jsx(f,{onClick:()=>{return s=a,y(e),g(s),j(!0),void u(!0);var s}})})]},e.id))})},{title:"Aksi",key:"action",render:e=>i.jsx(re.Button,{menu:{items:[{key:"add",label:"Tambah Rumpun",icon:i.jsx(le,{})},{key:"edit",label:"Edit",icon:i.jsx(f,{})},{key:"delete",label:"Hapus",icon:i.jsx(ae,{}),danger:!0}],onClick:({key:a})=>F(e,{key:a})},children:"Pilihan Aksi"})}];return i.jsxs(i.Fragment,{children:[i.jsx(ie,{onSearch:e=>{c(e),s(1)},isLoading:b||C,columns:L,source:v?.categories,rowKey:"id",page:a,limit:t,totalData:v?.totalData,onChange:e=>{s(e.current),l(e.pageSize)}}),i.jsx(Ie,{title:m?`Edit Rumpun ${p.name} di kategori ${x.name}`:`Tambah Rumpun di kategori ${x.name}`,open:d,onClose:()=>{g(""),u(!1),j(!1)},categoryid:x.id,branch:p})]})},Ne=({open:e,onClose:a,category:t,title:r})=>{const[o]=s.useForm(),[c,{isLoading:d,isSuccess:u,data:m,error:h,reset:j}]=O(),x=()=>{o.resetFields(),a()};return A.useEffect(()=>{e&&(o.resetFields(),t?o.setFieldsValue({name:t.name}):o.resetFields())},[e,t,o]),A.useEffect(()=>{u&&(n.success(m.message),x(),j()),h&&(n.error(h.data.message),j())},[u,m,h]),i.jsx(G,{title:r,open:e,onCancel:x,okText:"Simpan",cancelText:"Tutup",confirmLoading:d,loading:d,onOk:()=>o.submit(),children:i.jsx(P,{spinning:d,tip:"Memperoses data..",children:i.jsx(s,{form:o,layout:"vertical",onFinish:e=>{if(t){const a={...e,id:t.id};c(a)}else c(e)},children:i.jsx(s.Item,{name:"name",label:"Nama Kategori",rules:[{required:!0,message:"Nama Wajib diisi"}],children:i.jsx(l,{placeholder:"Nama Kategori"})})})})})},Ae=()=>{const[e,a]=A.useState(!1),[s,t]=A.useState(!1),[r,n]=A.useState([]);return i.jsxs(c,{hoverable:!0,title:"Managemen Kategori",extra:i.jsx(K,{onClick:()=>a(!0)}),children:[i.jsx(Re,{onEdit:e=>{n(e),t(!0),a(!0)}}),i.jsx(Ne,{title:s?"Edit Kategori":"Simpan Kategori",open:e,onClose:()=>{n({}),a(!1),t(!1)},category:r})]})},Ke=()=>{const e=[{label:"Kategori",key:"1",children:i.jsx(Ae,{})},{label:"Mata Pelajaran",key:"2",children:i.jsx(Ce,{})},{label:"Guru",key:"3",children:i.jsx(Me,{})},{label:"Laporan Bulanan",key:"4",children:i.jsx(ze,{})}];return i.jsx(R,{title:"Management Akademik",levels:["admin"],children:i.jsx(v,{vertical:!0,gap:"middle",children:i.jsx(N,{defaultActiveKey:"1",centered:!0,items:e})})})};export{Ke as default};
//# sourceMappingURL=AdminAcademic-Bs55SrM4.js.map
