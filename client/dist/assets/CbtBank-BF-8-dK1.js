import{b as e,aC as s,aD as a,j as l,e as n,aE as i,aF as t}from"./index-D_xLDGgb.js";import{b as c,u as d}from"./vendor-CnnDPxwB.js";import{S as r}from"./react-select.esm-C351JJ6e.js";import{T as m}from"./Table-0OluQQdG.js";const o=({detail:i,setDetail:t})=>{var d;const{user:m}=e((e=>e.auth)),[o,u]=c.useState({id:"",teacher:(null==m?void 0:m.id)||null,subject:null,btype:"",name:""}),{data:b}=s(),[h,{isSuccess:j,isLoading:x,isError:p,reset:v}]=a(),g=null==b?void 0:b.map((e=>({value:e.id,label:e.name,subjects:e.subjects}))),N=null==b?void 0:b.find((e=>e.id===o.teacher)),f=(null==(d=null==N?void 0:N.subjects)?void 0:d.map((e=>({value:e.id,label:e.name}))))||[],k=e=>{const{name:s,value:a}=e.target;u((e=>({...e,[s]:a})))};return c.useEffect((()=>{(j||p)&&(u({id:"",teacher:(null==m?void 0:m.id)||null,btype:"",subject:null,name:""}),v())}),[j,p,m]),c.useEffect((()=>{i&&u({id:i.id,teacher:i.teacher||(null==m?void 0:m.id)||null,subject:i.subject,name:i.name,btype:i.btype})}),[i,m]),l.jsxs("form",{onSubmit:e=>{e.preventDefault(),n.promise(h(o).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message})},className:"bg-white p-2 rounded d-flex flex-column gap-2 border",children:[l.jsx("p",{className:"m-0 h6",children:"Bank Soal"}),l.jsx(r,{isClearable:!0,isSearchable:!0,placeholder:"Cari Guru",value:(null==g?void 0:g.find((e=>e.value===o.teacher)))||null,options:g,onChange:e=>{u((s=>({...s,teacher:(null==e?void 0:e.value)||null,subject:null})))}}),l.jsx(r,{isClearable:!0,isSearchable:!0,placeholder:"Pilih Mata Pelajaran",value:(null==f?void 0:f.find((e=>e.value===o.subject)))||null,options:f,onChange:e=>{u((s=>({...s,subject:(null==e?void 0:e.value)||null})))},isDisabled:!o.teacher}),l.jsxs("select",{name:"btype",id:"btype",className:"form-select",value:o.btype,onChange:k,children:[l.jsx("option",{value:"",hidden:!0,children:"Jenis Bank Soal"}),l.jsx("option",{value:"bank",children:"Bank"}),l.jsx("option",{value:"paket",children:"Paket"})]}),l.jsx("input",{name:"name",className:"form-control",placeholder:"Nama Bank Soal",value:o.name,onChange:k}),l.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[l.jsx("button",{type:"button",className:"btn btn-sm btn-warning",onClick:()=>{t({}),u({id:"",teacher:(null==m?void 0:m.id)||null,subject:null,btype:"",name:""})},children:"Batal"}),l.jsx("button",{type:"submit",className:"btn btn-sm btn-success",children:"Simpan"})]})]})},u=({setDetail:e})=>{const s=d(),[a,r]=c.useState(1),[o,u]=c.useState(10),[b,h]=c.useState(""),{data:j={},isLoading:x}=i({page:a,limit:o,search:b}),{banks:p=[],totalData:v,totalPages:g}=j,[N,{isLoading:f}]=t();return l.jsx(m,{page:a,setPage:r,setLimit:u,setSearch:h,totalData:v,totalPages:g,isLoading:x,children:l.jsx("div",{className:"row g-4",children:(null==p?void 0:p.length)>0?null==p?void 0:p.map(((i,t)=>l.jsx("div",{className:"col-12 col-md-6",children:l.jsx("div",{className:"card shadow-sm h-100",children:l.jsxs("div",{className:"card-body",children:[l.jsxs("div",{className:"d-flex align-items-center mb-3",children:[l.jsx("span",{className:"badge bg-primary me-3",children:(a-1)*o+t+1}),l.jsxs("div",{children:[l.jsx("h5",{className:"card-title mb-1",children:i.name}),l.jsx("p",{className:"text-muted small mb-0",children:i.subject_name})]})]}),l.jsxs("div",{className:"row g-3 mb-3",children:[l.jsx("div",{className:"col-12",children:l.jsxs("div",{className:"d-flex align-items-center",children:[l.jsx("i",{className:"bi bi-person me-2 text-primary"}),l.jsxs("div",{children:[l.jsx("small",{className:"text-muted d-block",children:"Guru"}),l.jsx("span",{className:"fw-medium",children:i.teacher_name})]})]})}),l.jsx("div",{className:"col-6",children:l.jsxs("div",{className:"d-flex align-items-center",children:[l.jsx("i",{className:"bi bi-tag me-2 text-primary"}),l.jsxs("div",{children:[l.jsx("small",{className:"text-muted d-block",children:"Jenis"}),l.jsx("span",{className:"badge bg-success",children:i.btype.toUpperCase()})]})]})}),l.jsx("div",{className:"col-6",children:l.jsxs("div",{className:"d-flex align-items-center",children:[l.jsx("i",{className:"bi bi-question-circle me-2 text-primary"}),l.jsxs("div",{children:[l.jsx("small",{className:"text-muted d-block",children:"Jumlah Soal"}),l.jsx("span",{className:"badge bg-secondary",children:`${i.question_count} Soal`})]})]})})]}),l.jsxs("div",{className:"d-flex gap-2 mt-auto pt-3 border-top",children:[l.jsxs("button",{className:"btn btn-sm btn-primary flex-grow-1",onClick:()=>((e,a,l)=>{const n=a.replace(/[\s/]/g,"-"),i=e.replace(/[\s/]/g,"-");s(`/admin-cbt-bank/${i}/${n}/${l}`)})(i.subject_name,i.name,i.id),children:[l.jsx("i",{className:"bi bi-folder-fill"}),l.jsx("span",{className:"ms-2",children:"Lihat"})]}),l.jsxs("button",{className:"btn btn-sm btn-warning flex-grow-1",onClick:()=>e(i),children:[l.jsx("i",{className:"bi bi-pencil-square"}),l.jsx("span",{className:"ms-2",children:"Edit"})]}),l.jsxs("button",{className:"btn btn-sm btn-danger flex-grow-1",disabled:f,onClick:()=>{return e=i.id,void(window.confirm("Apakah anda yakin ingin menghapus bank soal ini dan semua data yang terkait dengan bank soal ini?")&&n.promise(N(e).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message}));var e},children:[l.jsx("i",{className:"bi bi-folder-minus"}),l.jsx("span",{className:"ms-2",children:"Hapus"})]})]})]})})},t))):l.jsx("div",{className:"col-12",children:l.jsx("div",{className:"alert alert-info mb-0",children:"Data belum tersedia"})})})})},b=()=>{const[e,s]=c.useState("");return l.jsxs("div",{className:"row g-2",children:[l.jsx("div",{className:"col-lg-3 col-12",children:l.jsx(o,{detail:e,setDetail:s})}),l.jsx("div",{className:"col-lg-9 col-12",children:l.jsx(u,{setDetail:s})})]})};export{b as C};
//# sourceMappingURL=CbtBank-BF-8-dK1.js.map
