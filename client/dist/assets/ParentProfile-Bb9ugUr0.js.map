{"version":3,"file":"ParentProfile-Bb9ugUr0.js","sources":["../../src/page/parent/profile/ParentProfile.jsx"],"sourcesContent":["import { useSelector, useDispatch } from \"react-redux\";\r\nimport { useState } from \"react\";\r\nimport { useUpdateParentProfileMutation } from \"../../../controller/api/auth/ApiAuth\";\r\nimport { updateUserProfile } from \"../../../controller/slice/AuthSlice\";\r\nimport Layout from \"../../../components/layout/Layout\";\r\n\r\nconst ParentProfile = () => {\r\n  const { user } = useSelector((state) => state.auth);\r\n  const dispatch = useDispatch();\r\n  const [updateParentProfile] = useUpdateParentProfileMutation();\r\n\r\n  const [formData, setFormData] = useState({\r\n    name: user?.name || \"\",\r\n    email: user?.email || \"\",\r\n    oldPassword: \"\",\r\n    newPassword: \"\",\r\n    confirmPassword: \"\",\r\n  });\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [message, setMessage] = useState({ type: \"\", text: \"\" });\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      [name]: value,\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n    setMessage({ type: \"\", text: \"\" });\r\n\r\n    try {\r\n      // Validate password confirmation\r\n      if (\r\n        formData.newPassword &&\r\n        formData.newPassword !== formData.confirmPassword\r\n      ) {\r\n        setMessage({ type: \"error\", text: \"Konfirmasi password tidak cocok\" });\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      // Prepare request body\r\n      const requestBody = {\r\n        name: formData.name,\r\n        email: formData.email,\r\n      };\r\n\r\n      // Add password fields if new password is provided\r\n      if (formData.newPassword) {\r\n        requestBody.oldPassword = formData.oldPassword;\r\n        requestBody.newPassword = formData.newPassword;\r\n      }\r\n\r\n      const response = await updateParentProfile(requestBody).unwrap();\r\n\r\n      setMessage({ type: \"success\", text: response.message });\r\n\r\n      // Update user state in Redux store\r\n      dispatch(\r\n        updateUserProfile({\r\n          name: formData.name,\r\n          email: formData.email,\r\n        })\r\n      );\r\n\r\n      // Clear password fields after successful update\r\n      setFormData((prev) => ({\r\n        ...prev,\r\n        oldPassword: \"\",\r\n        newPassword: \"\",\r\n        confirmPassword: \"\",\r\n      }));\r\n    } catch (error) {\r\n      setMessage({\r\n        type: \"error\",\r\n        text:\r\n          error.data?.message || \"Terjadi kesalahan saat memperbarui profil\",\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Layout title={\"Profile Orang Tua\"} levels={[\"parent\"]}>\r\n      <div className='container-fluid'>\r\n        <div className='row'>\r\n          <div className='col-12'>\r\n            <div className='card shadow-sm'>\r\n              <div className='card-header bg-primary text-white'>\r\n                <h4 className='mb-0'>\r\n                  <i className='fas fa-user-edit me-2'></i>\r\n                  Profile Orang Tua\r\n                </h4>\r\n              </div>\r\n              <div className='card-body'>\r\n                {message.text && (\r\n                  <div\r\n                    className={`alert alert-${\r\n                      message.type === \"error\" ? \"danger\" : \"success\"\r\n                    } alert-dismissible fade show`}\r\n                    role='alert'\r\n                  >\r\n                    {message.text}\r\n                    <button\r\n                      type='button'\r\n                      className='btn-close'\r\n                      onClick={() => setMessage({ type: \"\", text: \"\" })}\r\n                    ></button>\r\n                  </div>\r\n                )}\r\n\r\n                <div className='row'>\r\n                  {/* Profile Information */}\r\n                  <div className='col-md-6'>\r\n                    <div className='card border-0 bg-light'>\r\n                      <div className='card-header bg-info text-white'>\r\n                        <h5 className='mb-0'>\r\n                          <i className='fas fa-info-circle me-2'></i>\r\n                          Informasi Profil\r\n                        </h5>\r\n                      </div>\r\n                      <div className='card-body'>\r\n                        <div className='mb-3'>\r\n                          <label className='form-label fw-bold'>\r\n                            Nama Lengkap:\r\n                          </label>\r\n                          <p className='form-control-plaintext'>\r\n                            {user?.name || \"-\"}\r\n                          </p>\r\n                        </div>\r\n                        <div className='mb-3'>\r\n                          <label className='form-label fw-bold'>Email:</label>\r\n                          <p className='form-control-plaintext'>\r\n                            {user?.email || \"-\"}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Student Information */}\r\n                  <div className='col-md-6'>\r\n                    <div className='card border-0 bg-light'>\r\n                      <div className='card-header bg-success text-white'>\r\n                        <h5 className='mb-0'>\r\n                          <i className='fas fa-graduation-cap me-2'></i>\r\n                          Informasi Siswa\r\n                        </h5>\r\n                      </div>\r\n                      <div className='card-body'>\r\n                        <div className='mb-3'>\r\n                          <label className='form-label fw-bold'>\r\n                            Nama Siswa:\r\n                          </label>\r\n                          <p className='form-control-plaintext'>\r\n                            {user?.student || \"-\"}\r\n                          </p>\r\n                        </div>\r\n                        <div className='mb-3'>\r\n                          <label className='form-label fw-bold'>NIS:</label>\r\n                          <p className='form-control-plaintext'>\r\n                            {user?.nis || \"-\"}\r\n                          </p>\r\n                        </div>\r\n                        <div className='mb-3'>\r\n                          <label className='form-label fw-bold'>Kelas:</label>\r\n                          <p className='form-control-plaintext'>\r\n                            {user?.class || \"-\"}\r\n                          </p>\r\n                        </div>\r\n                        <div className='mb-3'>\r\n                          <label className='form-label fw-bold'>Jurusan:</label>\r\n                          <p className='form-control-plaintext'>\r\n                            {user?.major || \"-\"}\r\n                          </p>\r\n                        </div>\r\n                        <div className='mb-3'>\r\n                          <label className='form-label fw-bold'>\r\n                            Homebase:\r\n                          </label>\r\n                          <p className='form-control-plaintext'>\r\n                            {user?.homebase || \"-\"}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Update Profile Form */}\r\n                <div className='row mt-4'>\r\n                  <div className='col-12'>\r\n                    <div className='card border-0'>\r\n                      <div className='card-header bg-warning text-dark'>\r\n                        <h5 className='mb-0'>\r\n                          <i className='fas fa-edit me-2'></i>\r\n                          Update Profil\r\n                        </h5>\r\n                      </div>\r\n                      <div className='card-body'>\r\n                        <form onSubmit={handleSubmit}>\r\n                          <div className='row'>\r\n                            <div className='col-md-4'>\r\n                              <div className='mb-3'>\r\n                                <label\r\n                                  htmlFor='name'\r\n                                  className='form-label fw-bold'\r\n                                >\r\n                                  Nama Lengkap{\" \"}\r\n                                  <span className='text-danger'>*</span>\r\n                                </label>\r\n                                <input\r\n                                  type='text'\r\n                                  className='form-control'\r\n                                  id='name'\r\n                                  name='name'\r\n                                  value={formData.name}\r\n                                  onChange={handleInputChange}\r\n                                  required\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                            <div className='col-md-4'>\r\n                              <div className='mb-3'>\r\n                                <label\r\n                                  htmlFor='email'\r\n                                  className='form-label fw-bold'\r\n                                >\r\n                                  Email <span className='text-danger'>*</span>\r\n                                </label>\r\n                                <input\r\n                                  type='email'\r\n                                  className='form-control'\r\n                                  id='email'\r\n                                  name='email'\r\n                                  value={formData.email}\r\n                                  onChange={handleInputChange}\r\n                                  required\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n\r\n                          <hr className='my-4' />\r\n\r\n                          <div className='row'>\r\n                            <div className='col-12'>\r\n                              <h6 className='text-muted mb-3'>\r\n                                <i className='fas fa-lock me-2'></i>\r\n                                Ubah Password (Opsional)\r\n                              </h6>\r\n                            </div>\r\n                            <div className='col-md-4'>\r\n                              <div className='mb-3'>\r\n                                <label\r\n                                  htmlFor='oldPassword'\r\n                                  className='form-label'\r\n                                >\r\n                                  Password Lama\r\n                                </label>\r\n                                <input\r\n                                  type='password'\r\n                                  className='form-control'\r\n                                  id='oldPassword'\r\n                                  name='oldPassword'\r\n                                  value={formData.oldPassword}\r\n                                  onChange={handleInputChange}\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                            <div className='col-md-4'>\r\n                              <div className='mb-3'>\r\n                                <label\r\n                                  htmlFor='newPassword'\r\n                                  className='form-label'\r\n                                >\r\n                                  Password Baru\r\n                                </label>\r\n                                <input\r\n                                  type='password'\r\n                                  className='form-control'\r\n                                  id='newPassword'\r\n                                  name='newPassword'\r\n                                  value={formData.newPassword}\r\n                                  onChange={handleInputChange}\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                            <div className='col-md-4'>\r\n                              <div className='mb-3'>\r\n                                <label\r\n                                  htmlFor='confirmPassword'\r\n                                  className='form-label'\r\n                                >\r\n                                  Konfirmasi Password Baru\r\n                                </label>\r\n                                <input\r\n                                  type='password'\r\n                                  className='form-control'\r\n                                  id='confirmPassword'\r\n                                  name='confirmPassword'\r\n                                  value={formData.confirmPassword}\r\n                                  onChange={handleInputChange}\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div className='d-flex justify-content-end'>\r\n                            <button\r\n                              type='submit'\r\n                              className='btn btn-primary'\r\n                              disabled={isLoading}\r\n                            >\r\n                              {isLoading ? (\r\n                                <>\r\n                                  <span\r\n                                    className='spinner-border spinner-border-sm me-2'\r\n                                    role='status'\r\n                                    aria-hidden='true'\r\n                                  ></span>\r\n                                  Menyimpan...\r\n                                </>\r\n                              ) : (\r\n                                <>\r\n                                  <i className='fas fa-save me-2'></i>\r\n                                  Simpan Perubahan\r\n                                </>\r\n                              )}\r\n                            </button>\r\n                          </div>\r\n                        </form>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default ParentProfile;\r\n"],"names":["ParentProfile","user","useSelector","state","auth","dispatch","useDispatch","updateParentProfile","useUpdateParentProfileMutation","formData","setFormData","useState","name","email","oldPassword","newPassword","confirmPassword","isLoading","setIsLoading","message","setMessage","type","text","handleInputChange","e","value","target","prev","jsx","Layout","title","levels","children","jsxRuntimeExports","className","jsxs","role","onClick","student","nis","class","major","homebase","onSubmit","async","preventDefault","requestBody","response","unwrap","updateUserProfile","error","_a","data","htmlFor","id","onChange","required","disabled","Fragment"],"mappings":"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"}