import{r as t,q as v,j as e,e as M,t as y,v as L,V as w}from"./index-B88h2kYZ.js";import{L as D}from"./Layout-BzzV81EK.js";import{T as k}from"./Table-BvY52Fag.js";const E=({detail:n,setDetail:l})=>{const[x,i]=t.useState(""),[m,d]=t.useState(""),[j,{isSuccess:u,isLoading:h,error:s,reset:b}]=v(),g=o=>{o.preventDefault();const f={id:x,name:m};M.promise(j(f).unwrap().then(r=>r.message),{loading:"Meyimpan data...",success:r=>r,error:r=>r.data.message})},p=()=>{l({}),i(""),d("")};return t.useEffect(()=>{u&&(b(),d(""),i("")),s&&b()},[u,s]),t.useEffect(()=>{n&&(i(n.id),d(n.name))},[n]),e.jsxs("form",{onSubmit:g,className:"bg-white rounded border d-flex flex-column gap-2 p-2",children:[e.jsx("p",{className:"m-0 h6",children:"Jurusan"}),e.jsx("input",{type:"text",name:"major",id:"major",className:"form-control",placeholder:"Jurusan",required:!0,value:m||"",onChange:o=>d(o.target.value)}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-warning",onClick:p,children:"Batal"}),e.jsx("button",{type:"submit",className:"btn btn-sm btn-success",disabled:h,children:"Simpan"})]})]})},C=[{label:"No"},{label:"Satuan"},{label:"Jurusan"},{label:"aksi"}],J=({setDetail:n})=>{const[l,x]=t.useState(1),[i,m]=t.useState(10),[d,j]=t.useState(""),{data:u={},isLoading:h}=y({page:l,limit:i,search:d}),{majors:s=[],totalData:b,totalPages:g}=u,[p,{isSuccess:o,isLoading:f,error:r,reset:N}]=L(),S=a=>{w.promise(p(a).unwrap().then(c=>c.message),{loading:"Memproses...",success:c=>c,error:c=>c.data.message})};return t.useEffect(()=>{o&&N(),r&&N()},[o,r]),e.jsx(k,{page:l,setPage:x,setLimit:m,setSearch:j,totalData:b,totalPages:g,isLoading:h,children:e.jsxs("table",{className:"table table-bordered table-striped table-hover",children:[e.jsx("thead",{children:e.jsx("tr",{children:C.map(a=>e.jsx("th",{className:"text-center",children:a.label},a.label))})}),e.jsx("tbody",{children:(s==null?void 0:s.length)>0?s==null?void 0:s.map((a,c)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-center align-middle",children:(l-1)*i+c+1}),e.jsx("td",{className:"align-middle",children:a.homebase}),e.jsx("td",{className:"align-middle",children:a.name}),e.jsx("td",{className:"text-center align-middle",children:e.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[e.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>n(a),children:e.jsx("i",{className:"bi bi-pencil-square"})}),e.jsx("button",{className:"btn btn-sm btn-danger",disabled:f,onClick:()=>S(a.id),children:e.jsx("i",{className:"bi bi-folder-minus"})})]})})]},c)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,children:"Data tidak tersedia"})})})]})})},H=()=>{const[n,l]=t.useState("");return e.jsx(D,{title:"Jurusan",levels:["admin"],children:e.jsxs("div",{className:"row g-2",children:[e.jsx("div",{className:"col-lg-3 col-2",children:e.jsx(E,{detail:n,setDetail:l})}),e.jsx("div",{className:"col-lg-9 col-2",children:e.jsx(J,{setDetail:l})})]})})};export{H as default};
