import{b as e,aC as a,aD as s,j as l,e as i,aE as n,aF as t}from"./index-BAWIGdgW.js";import{b as d,u as c}from"./vendor-DfXzdC0j.js";import{S as r}from"./react-select.esm-DUeLA41h.js";import{T as o}from"./Table-Cz3IM_IN.js";const m=({detail:n,setDetail:t})=>{var c;const{user:o}=e((e=>e.auth)),[m,u]=d.useState({id:"",teacher:(null==o?void 0:o.id)||null,subject:null,btype:"",name:""}),{data:b}=a(),[h,{isSuccess:x,isLoading:p,isError:j,reset:g}]=s(),v=null==b?void 0:b.map((e=>({value:e.id,label:e.name,subjects:e.subjects}))),N=null==b?void 0:b.find((e=>e.id===m.teacher)),f=(null==(c=null==N?void 0:N.subjects)?void 0:c.map((e=>({value:e.id,label:e.name}))))||[],y=e=>{const{name:a,value:s}=e.target;u((e=>({...e,[a]:s})))},k=()=>{t({}),u({id:"",teacher:(null==o?void 0:o.id)||null,subject:null,btype:"",name:""})};return d.useEffect((()=>{if(x||j){u({id:"",teacher:(null==o?void 0:o.id)||null,btype:"",subject:null,name:""}),g();document.querySelector("[data-bs-dismiss='modal']").click()}}),[x,j,o,g]),d.useEffect((()=>{n&&u({id:n.id,teacher:n.teacher||(null==o?void 0:o.id)||null,subject:n.subject,name:n.name,btype:n.btype})}),[n,o]),d.useEffect((()=>{const e=document.getElementById("addbank");if(!e)return;const a=()=>{u({id:"",teacher:(null==o?void 0:o.id)||null,subject:null,btype:"",name:""})};return e.addEventListener("hidden.bs.modal",a),()=>e.removeEventListener("hidden.bs.modal",a)}),[o]),l.jsx("div",{className:"modal fade",id:"addbank","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"bankModalLabel","aria-hidden":"true",children:l.jsx("div",{className:"modal-dialog",children:l.jsxs("form",{onSubmit:e=>{e.preventDefault(),i.promise(h(m).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message})},className:"modal-content p-3",children:[l.jsxs("div",{className:"modal-header",children:[l.jsx("h5",{className:"modal-title",id:"bankModalLabel",children:m.id?"Edit Bank Soal":"Tambah Bank Soal"}),l.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:k})]}),l.jsxs("div",{className:"modal-body d-flex flex-column gap-3",children:[l.jsx(r,{isClearable:!0,isSearchable:!0,placeholder:"Cari Guru",value:(null==v?void 0:v.find((e=>e.value===m.teacher)))||null,options:v,onChange:e=>{u((a=>({...a,teacher:(null==e?void 0:e.value)||null,subject:null})))},className:"mb-2"}),l.jsx(r,{isClearable:!0,isSearchable:!0,placeholder:"Pilih Mata Pelajaran",value:(null==f?void 0:f.find((e=>e.value===m.subject)))||null,options:f,onChange:e=>{u((a=>({...a,subject:(null==e?void 0:e.value)||null})))},isDisabled:!m.teacher,className:"mb-2"}),l.jsxs("select",{name:"btype",id:"btype",className:"form-select",value:m.btype,onChange:y,required:!0,children:[l.jsx("option",{value:"",hidden:!0,children:"Jenis Bank Soal"}),l.jsx("option",{value:"bank",children:"Bank"}),l.jsx("option",{value:"paket",children:"Paket"})]}),l.jsx("input",{name:"name",className:"form-control",placeholder:"Nama Bank Soal",value:m.name,onChange:y,required:!0})]}),l.jsxs("div",{className:"modal-footer",children:[l.jsxs("button",{type:"button",className:"btn btn-warning","data-bs-dismiss":"modal",onClick:k,children:[l.jsx("i",{className:"bi bi-x-lg me-1"}),"Batal"]}),l.jsxs("button",{type:"submit",className:"btn btn-success",disabled:p,children:[l.jsx("i",{className:"bi bi-save me-1"}),"Simpan"]})]})]})})})},u=({setDetail:e})=>{const a=c(),[s,r]=d.useState(1),[m,u]=d.useState(12),[b,h]=d.useState(""),{data:x={},isLoading:p}=n({page:s,limit:m,search:b}),{banks:j=[],totalData:g,totalPages:v}=x,[N,{isLoading:f}]=t();return l.jsx(o,{page:s,setPage:r,setLimit:u,setSearch:h,totalData:g,totalPages:v,isLoading:p,children:l.jsx("div",{className:"row g-4",children:(null==j?void 0:j.length)>0?null==j?void 0:j.map(((n,t)=>l.jsx("div",{className:"col-12 col-md-6 col-lg-4",children:l.jsxs("div",{className:"card bg-white rounded-4 shadow-sm hover-shadow h-100",children:[l.jsxs("span",{className:"position-absolute top-0 end-0 badge bg-primary rounded-pill m-2",style:{fontSize:13,zIndex:2},children:["#",(s-1)*m+t+1]}),l.jsxs("div",{className:"card-body p-4 d-flex flex-column h-100",children:[l.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[l.jsxs("div",{className:"d-flex gap-3 align-items-center",children:[l.jsx("div",{className:"rounded-circle bg-primary bg-opacity-10 d-flex align-items-center justify-content-center",style:{width:48,height:48},children:l.jsx("i",{className:"bi bi-person text-primary fs-4"})}),l.jsxs("div",{className:"d-flex flex-column",children:[l.jsx("h6",{title:n.name,className:"fw-bold text-primary mb-1 pointer",children:n.name.length>20?`${n.name.slice(0,20)}...`:n.name}),l.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[l.jsx("span",{title:n.teacher_name,className:"text-muted small pointer",children:n.teacher_name.length>20?`${n.teacher_name.slice(0,20)}...`:n.teacher_name}),l.jsx("div",{className:"vr"}),l.jsx("span",{className:"text-muted small",children:n.subject_name})]})]})]}),l.jsxs("div",{className:"dropdown",children:[l.jsx("button",{type:"button",className:"btn btn-sm btn-outline-primary","data-bs-toggle":"dropdown","aria-expanded":"false",children:l.jsx("i",{className:"bi bi-three-dots-vertical"})}),l.jsxs("ul",{className:"dropdown-menu dropdown-menu-end shadow",children:[l.jsx("li",{children:l.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2",onClick:()=>((e,s,l)=>{const i=s.replace(/[\s/]/g,"-"),n=e.replace(/[\s/]/g,"-");a(`/admin-cbt-bank/${n}/${i}/${l}`)})(n.subject_name,n.name,n.id),children:[l.jsx("i",{className:"bi bi-folder-fill"})," Lihat"]})}),l.jsx("li",{children:l.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2",onClick:()=>e(n),"data-bs-toggle":"modal","data-bs-target":"#addbank",children:[l.jsx("i",{className:"bi bi-pencil-square"})," Edit"]})}),l.jsx("li",{children:l.jsx("hr",{className:"dropdown-divider"})}),l.jsx("li",{children:l.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2 text-danger",disabled:f,onClick:()=>{return e=n.id,void(window.confirm("Apakah anda yakin ingin menghapus bank soal ini dan semua data yang terkait dengan bank soal ini?")&&i.promise(N(e).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message}));var e},children:[l.jsx("i",{className:"bi bi-folder-minus"})," Hapus"]})})]})]})]}),l.jsxs("div",{className:"row g-3 mb-3",children:[l.jsx("div",{className:"col-6",children:l.jsxs("div",{className:"d-flex align-items-center",children:[l.jsx("i",{className:"bi bi-tag me-2 text-success fs-5"}),l.jsxs("div",{children:[l.jsx("small",{className:"text-muted d-block",children:"Jenis"}),l.jsx("span",{className:"badge bg-success bg-opacity-75 px-3 py-1",children:n.btype.toUpperCase()})]})]})}),l.jsx("div",{className:"col-6",children:l.jsxs("div",{className:"d-flex align-items-center",children:[l.jsx("i",{className:"bi bi-question-circle me-2 text-info fs-5"}),l.jsxs("div",{children:[l.jsx("small",{className:"text-muted d-block",children:"Jumlah Soal"}),l.jsx("span",{className:"badge bg-info bg-opacity-75 px-3 py-1",children:`${n.question_count} Soal`})]})]})})]})]})]})},t))):l.jsx("div",{className:"col-12",children:l.jsx("div",{className:"alert alert-info mb-0",children:"Data belum tersedia"})})})})},b=()=>{const[e,a]=d.useState("");return l.jsxs("div",{className:"container-fluid",children:[l.jsx(m,{detail:e,setDetail:a}),l.jsx(u,{setDetail:a})]})};export{b as C};
//# sourceMappingURL=CbtBank-B0nX8N1C.js.map
