import{b as e,aZ as a,a_ as s,j as i,e as l,a$ as n}from"./index-DBphrCn1.js";import{b as t}from"./vendor-DfXzdC0j.js";import{L as d}from"./Layout-DoNTfWoh.js";import"./index-CGMX7dKw.js";import"./index-hpZ4eOv6.js";import"./index-DyuEXp_a.js";const r=({exam:n,setExam:d})=>{const[r,c]=t.useState(""),o=t.useRef(null),{user:m}=e((e=>e.auth)),{data:x,isLoading:u}=a({exam:n.id,student:m.user_id},{skip:!n.id||!m.user_id}),[h,{isLoading:j}]=s();t.useEffect((()=>{o.current&&(o.current.addEventListener("shown.bs.modal",(()=>{o.current.removeAttribute("aria-hidden")})),o.current.addEventListener("hidden.bs.modal",(()=>{o.current.setAttribute("aria-hidden","true")})))}),[]);const b=()=>{d({}),c("")};return i.jsx("div",{ref:o,className:"modal fade",id:"token",tabIndex:"-1",role:"dialog","aria-labelledby":"token-label","aria-modal":"true",children:i.jsx("div",{className:"modal-dialog",children:i.jsxs("div",{className:"modal-content",children:[i.jsxs("div",{className:"modal-header",children:[i.jsxs("h5",{className:"modal-title",id:"token-label",children:["Token ",n.name]}),i.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:b})]}),i.jsx("div",{className:"modal-body",children:i.jsx("input",{type:"text",name:"token",id:"token",className:"form-control",placeholder:"Masukkan Token",value:r,onChange:e=>c(e.target.value),"aria-label":"Token input"})}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{type:"button",className:"btn btn-sm btn-danger","data-bs-dismiss":"modal",onClick:b,children:"Tutup"}),i.jsx("button",{type:"button",className:"btn btn-sm btn-primary",onClick:()=>{if(!n.id)return void l.error("Ujian tidak ditemukan");if(r!==n.token)return l.error("Token Salah"),void c("");if(x&&x.ispenalty)return l.error("Anda melanggar ketentuan"),void c("");if(x&&x.isactive)return l.error("Anda sedang mengikuti ujian"),void c("");if(x&&x.isdone)return l.error("Anda sudah mengikuti ujian"),void c("");console.log(x);const e={exam:n.id,student:m.user_id,action:"start",start_time:(new Date).toISOString()};l.promise(h(e).unwrap(),{loading:"Memuat...",success:e=>{d({}),c("");const a=document.getElementById("token");if(a){const e=a.querySelector('[data-bs-dismiss="modal"]');e&&e.click()}localStorage.removeItem("questions");const s=n.name.replace(/\s+/g,"-");window.location.href=`/siswa-cbt/${s}/${n.id}/${n.token}`},error:e=>{var a;return console.log("Error starting exam:",e),(null==(a=e.data)?void 0:a.message)||"Gagal memulai ujian"}})},disabled:u||j,children:"Konfirmasi"})]})]})})})},c=({classid:e})=>{const[a,s]=t.useState(1),[l,d]=t.useState(10),[c,o]=t.useState(""),{data:m={},isLoading:x}=n({classid:e,page:a,limit:l,search:c},{skip:!e}),{exams:u=[],totalData:h,totalPages:j}=m,[b,p]=t.useState({}),N=e=>{e>=1&&e<=j&&s(e)};return i.jsxs("div",{className:"container-fluid py-4",children:[i.jsxs("div",{className:"row mb-4",children:[i.jsx("div",{className:"col-md-6 col-lg-4 mb-3 mb-md-0",children:i.jsxs("div",{className:"input-group",children:[i.jsx("span",{className:"input-group-text bg-white border-end-0",children:i.jsx("i",{className:"bi bi-search"})}),i.jsx("input",{type:"text",className:"form-control border-start-0 ps-0",placeholder:"Cari ujian...",value:c,onChange:e=>{o(e.target.value),s(1)}})]})}),i.jsx("div",{className:"col-md-6 col-lg-2",children:i.jsxs("select",{className:"form-select",value:l,onChange:e=>{d(Number(e.target.value)),s(1)},children:[i.jsx("option",{value:"5",children:"5 per halaman"}),i.jsx("option",{value:"10",children:"10 per halaman"}),i.jsx("option",{value:"25",children:"25 per halaman"}),i.jsx("option",{value:"50",children:"50 per halaman"})]})})]}),x?i.jsx("div",{className:"text-center py-5",children:i.jsx("div",{className:"spinner-border text-primary",role:"status",children:i.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"table-responsive",children:i.jsxs("table",{className:"table table-hover table-striped align-middle",children:[i.jsx("thead",{className:"table-light",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"fw-bold",children:"Nama Ujian"}),i.jsx("th",{scope:"col",className:"fw-bold d-none d-md-table-cell",children:"Guru"}),i.jsx("th",{scope:"col",className:"fw-bold d-none d-lg-table-cell",children:"Durasi"}),i.jsx("th",{scope:"col",className:"fw-bold text-center",children:"Status"}),i.jsx("th",{scope:"col",className:"fw-bold text-center",children:"Aksi"})]})}),i.jsx("tbody",{children:(null==u?void 0:u.length)>0?null==u?void 0:u.map(((e,a)=>i.jsxs("tr",{className:"align-middle",children:[i.jsx("td",{children:i.jsxs("div",{className:"d-flex flex-column",children:[i.jsx("span",{className:""+(e.isactive?"text-primary":"text-danger"),children:e.name}),i.jsxs("div",{className:"d-md-none",children:[i.jsxs("small",{className:"text-muted",children:[i.jsx("i",{className:"bi bi-person-circle me-1"}),e.teacher_name]}),i.jsx("br",{}),i.jsxs("small",{className:"text-muted",children:[i.jsx("i",{className:"bi bi-clock me-1"}),e.duration," Menit"]})]})]})}),i.jsx("td",{className:"d-none d-md-table-cell",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx("i",{className:"bi bi-person-circle me-2 text-muted"}),i.jsx("span",{children:e.teacher_name})]})}),i.jsx("td",{className:"d-none d-lg-table-cell",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx("i",{className:"bi bi-clock me-2 text-muted"}),i.jsxs("span",{children:[e.duration," Menit"]})]})}),i.jsx("td",{className:"text-center",children:e.isactive?i.jsxs("span",{className:"badge rounded-pill bg-success px-3 py-2",children:[i.jsx("i",{className:"bi bi-check-circle me-1"}),i.jsx("span",{className:"d-none d-sm-inline",children:"Aktif"})]}):i.jsxs("span",{className:"badge rounded-pill bg-danger px-3 py-2",children:[i.jsx("i",{className:"bi bi-x-circle me-1"}),i.jsx("span",{className:"d-none d-sm-inline",children:"Nonaktif"})]})}),i.jsx("td",{className:"text-center",children:i.jsxs("button",{className:"btn btn-sm btn-primary rounded-pill","data-bs-toggle":"modal","data-bs-target":"#token",disabled:!e.isactive,onClick:()=>p(e),children:[i.jsx("i",{className:"bi bi-reception-4 me-1"}),i.jsx("span",{className:"d-none d-sm-inline",children:"Ikuti Ujian"}),i.jsx("span",{className:"d-sm-none",children:"Mulai"})]})})]},e.id))):i.jsx("tr",{children:i.jsx("td",{colSpan:"5",className:"text-center py-5",children:i.jsxs("div",{className:"text-muted",children:[i.jsx("i",{className:"bi bi-inbox fs-1 d-block mb-3"}),i.jsx("h5",{children:"Data Belum Tersedia"}),i.jsx("p",{className:"text-muted mb-0",children:c?"Tidak ada ujian yang sesuai dengan pencarian Anda":"Belum ada ujian yang tersedia saat ini"})]})})})})]})}),j>0&&i.jsxs("nav",{"aria-label":"Page navigation",className:"d-flex justify-content-between align-items-center mt-4",children:[i.jsxs("div",{className:"text-muted",children:[h," Ujian Tersedia"]}),i.jsxs("ul",{className:"pagination pagination-sm mb-0",children:[i.jsx("li",{className:"page-item "+(1===a?"disabled":""),children:i.jsx("button",{className:"page-link",onClick:()=>N(a-1),disabled:1===a,children:i.jsx("i",{className:"bi bi-chevron-left"})})}),[...Array(j)].map(((e,s)=>i.jsx("li",{className:"page-item "+(a===s+1?"active":""),children:i.jsx("button",{className:"page-link",onClick:()=>N(s+1),children:s+1})},s+1))),i.jsx("li",{className:"page-item "+(a===j?"disabled":""),children:i.jsx("button",{className:"page-link",onClick:()=>N(a+1),disabled:a===j,children:i.jsx("i",{className:"bi bi-chevron-right"})})})]})]})]}),i.jsx(r,{exam:b,setExam:p})]})},o=()=>{const{user:a}=e((e=>e.auth));return i.jsx(d,{title:"Daftar Ujian Saya",levels:["student"],children:i.jsx(c,{classid:a.class_id})})};export{o as default};
//# sourceMappingURL=StudentCbt-BFzne58j.js.map
