{"version":3,"file":"TahfizTarget-BNQunncx.js","sources":["../../src/page/tahfiz/target/Form.jsx","../../src/page/tahfiz/target/TableData.jsx","../../src/page/tahfiz/target/TahfizTarget.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  useGetGradesQuery,\r\n  useAddTargetMutation,\r\n} from \"../../../controller/api/tahfiz/ApiScoring\";\r\nimport { useGetJuzQuery } from \"../../../controller/api/tahfiz/ApiQuran\";\r\nimport { toast } from \"react-hot-toast\";\r\nimport Select from \"react-select\";\r\n\r\nconst Form = ({ detail, setDetail }) => {\r\n  const { data: grades } = useGetGradesQuery();\r\n  const { data: juz } = useGetJuzQuery({ page: \"\", limit: \"\", search: \"\" });\r\n  const [addTarget, { isLoading, isSuccess, isError, reset }] =\r\n    useAddTargetMutation();\r\n\r\n  const [formData, setFormData] = useState({\r\n    id: detail ? detail.id : \"\",\r\n    grade_id: \"\",\r\n    juz_ids: [],\r\n  });\r\n\r\n  const addHandler = (e) => {\r\n    e.preventDefault();\r\n\r\n    // Convert juz_ids array to individual target entries\r\n    const targets = formData.juz_ids.map((juz) => ({\r\n      id: formData.id,\r\n      gradeId: formData.grade_id,\r\n      juzId: juz.value,\r\n    }));\r\n\r\n    // Submit each target individually\r\n    const promises = targets.map((target) =>\r\n      addTarget(target)\r\n        .unwrap()\r\n        .then((res) => res.message)\r\n    );\r\n\r\n    toast.promise(Promise.all(promises), {\r\n      loading: \"Memuat data...\",\r\n      success: (messages) => messages[0],\r\n      error: (err) => err.data.message,\r\n    });\r\n  };\r\n\r\n  const cancel = () => {\r\n    setDetail({});\r\n    setFormData({\r\n      id: \"\",\r\n      grade_id: \"\",\r\n      juz_ids: [],\r\n    });\r\n  };\r\n\r\n  const handleJuzChange = (selectedOptions) => {\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      juz_ids: selectedOptions || [],\r\n    }));\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (detail) {\r\n      setFormData({\r\n        id: detail.id || \"\",\r\n        grade_id: detail.grade_id || \"\",\r\n        juz_ids: detail.juz_id\r\n          ? [\r\n              {\r\n                value: detail.juz_id,\r\n                label: detail.juz_name || `Juz ${detail.juz_id}`,\r\n              },\r\n            ]\r\n          : [],\r\n      });\r\n    }\r\n  }, [detail]);\r\n\r\n  useEffect(() => {\r\n    if (isError || isSuccess) {\r\n      reset();\r\n      setDetail({});\r\n      setFormData({\r\n        id: \"\",\r\n        grade_id: \"\",\r\n        juz_ids: [],\r\n      });\r\n    }\r\n  }, [isSuccess, isError]);\r\n\r\n  const juzOptions =\r\n    juz?.map((item) => ({\r\n      value: item.id,\r\n      label: item.name,\r\n    })) || [];\r\n\r\n  return (\r\n    <form\r\n      onSubmit={addHandler}\r\n      className='rounded border bg-white p-2 d-flex flex-column gap-2'>\r\n      <p className='m-0 h6'>Target Hafalan</p>\r\n\r\n      <select\r\n        className='form-select'\r\n        value={formData.grade_id}\r\n        onChange={(e) =>\r\n          setFormData({ ...formData, grade_id: e.target.value })\r\n        }>\r\n        <option value='' hidden>\r\n          Pilih Tingkat\r\n        </option>\r\n        {grades?.map((grade) => (\r\n          <option key={grade.id} value={grade.id}>\r\n            {grade.name}\r\n          </option>\r\n        ))}\r\n      </select>\r\n\r\n      <Select\r\n        isMulti\r\n        options={juzOptions}\r\n        value={formData.juz_ids}\r\n        onChange={handleJuzChange}\r\n        className='mb-2'\r\n        placeholder='Pilih Juz'\r\n      />\r\n\r\n      <div className='d-flex justify-content-end gap-2'>\r\n        <button\r\n          type='button'\r\n          className='btn btn-sm  btn-warning'\r\n          onClick={cancel}>\r\n          Batal\r\n        </button>\r\n        <button\r\n          type='submit'\r\n          className='btn btn-sm btn-success'\r\n          disabled={isLoading}>\r\n          Simpan\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default Form;\r\n","import React, { Fragment } from \"react\";\r\nimport { useGetTargetsQuery } from \"../../../controller/api/tahfiz/ApiScoring\";\r\n\r\nconst TableData = () => {\r\n  const { data: targets } = useGetTargetsQuery();\r\n\r\n  return (\r\n    <div className='table-responsive'>\r\n      <table className='mb-0 table table-bordered table-hover'>\r\n        <thead>\r\n          <tr>\r\n            <th className='text-center'>Tingkat</th>\r\n            <th className='text-center'>Juz</th>\r\n            <th className='text-center'>Ayat</th>\r\n            <th className='text-center'>Baris</th>\r\n            <th className='text-center'>Total Ayat</th>\r\n            <th className='text-center'>Total Baris</th>\r\n            <th className='text-center'>Aksi</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {targets?.length > 0 ? (\r\n            targets?.map((item, index) => (\r\n              <Fragment key={index}>\r\n                {item.target.map((targetItem, targetIndex) => (\r\n                  <tr key={targetIndex}>\r\n                    {targetIndex === 0 && (\r\n                      <th\r\n                        rowSpan={item.target.length}\r\n                        className='text-center align-middle'>\r\n                        {item.grade}\r\n                      </th>\r\n                    )}\r\n                    <td className='text-center'>{targetItem.juz}</td>\r\n                    <td className='text-center'>{targetItem.total_ayat}</td>\r\n                    <td className='text-center'>{targetItem.total_line}</td>\r\n                    {targetIndex === 0 && (\r\n                      <td\r\n                        rowSpan={item.target.length}\r\n                        className='text-center align-middle'>\r\n                        {item.total_ayat}\r\n                      </td>\r\n                    )}\r\n                    {targetIndex === 0 && (\r\n                      <td\r\n                        rowSpan={item.target.length}\r\n                        className='text-center align-middle'>\r\n                        {item.total_line}\r\n                      </td>\r\n                    )}\r\n                    <td className='text-center'>\r\n                      <div className='d-flex justify-content-center gap-2'>\r\n                        <button className='btn btn-sm btn-danger'>\r\n                          <i className='bi bi-trash'></i>\r\n                        </button>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </Fragment>\r\n            ))\r\n          ) : (\r\n            <tr>\r\n              <td colSpan='5' className='text-center'>\r\n                Tidak ada data tersedia\r\n              </td>\r\n            </tr>\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TableData;\r\n","import React, { useState } from \"react\";\r\nimport Layout from \"../../../components/layout/Layout\";\r\nimport Form from \"./Form\";\r\nimport TableData from \"./TableData\";\r\n\r\nconst TahfizTarget = () => {\r\n  const [detail, setDetail] = useState({});\r\n  return (\r\n    <Layout title={\"Target Hafalan\"} levels={[\"tahfiz\"]}>\r\n      <div className='row g-2'>\r\n        <div className='col-lg-3 col-12'>\r\n          <Form detail={detail} setDetail={setDetail} />\r\n        </div>\r\n        <div className='col-lg-9 col-12'>\r\n          <TableData />\r\n        </div>\r\n      </div>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default TahfizTarget;\r\n"],"names":["Form","detail","setDetail","data","grades","useGetGradesQuery","juz","useGetJuzQuery","page","limit","search","addTarget","isLoading","isSuccess","isError","reset","useAddTargetMutation","formData","setFormData","useState","id","grade_id","juz_ids","useEffect","juz_id","value","label","juz_name","juzOptions","map","item","name","jsxRuntimeExports","jsxs","onSubmit","e","preventDefault","promises","gradeId","juzId","target","unwrap","then","res","message","toast","promise","Promise","all","loading","success","messages","error","err","className","children","jsx","onChange","hidden","grade","Select","isMulti","options","selectedOptions","prev","placeholder","type","onClick","disabled","TableData","targets","useGetTargetsQuery","length","index","Fragment","targetItem","targetIndex","rowSpan","total_ayat","total_line","colSpan","TahfizTarget","Layout","title","levels"],"mappings":"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"}