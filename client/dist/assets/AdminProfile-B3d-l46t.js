import{a as s,b as a,aB as e,a1 as l,s as i,V as r,j as n}from"./index-DFhdulld.js";import{b as c}from"./vendor-CnnDPxwB.js";import{L as d}from"./Layout-GZnRoUIy.js";import"./index-B8CuzAwO.js";import"./index-g0LoU_Ie.js";const o=()=>{const o=s(),{user:m}=a((s=>s.auth)),[t,h]=c.useState(!1),[b,x]=c.useState({oldPassword:!1,newPassword:!1,confirmPassword:!1}),[j,N]=c.useState({name:"",email:"",phone:"",oldPassword:"",newPassword:"",confirmPassword:""}),[u,{isLoading:p,isSuccess:w,isError:v,reset:f}]=e(),[P]=l(),g=s=>{const{name:a,value:e}=s.target;if("phone"===a){const s=e.replace(/\D/g,""),l=s.startsWith("0")?"62"+s.substring(1):s;N((s=>({...s,[a]:l})))}else N((s=>({...s,[a]:e})))},y=s=>{if(s.preventDefault(),j.newPassword||j.confirmPassword||j.oldPassword){if(j.newPassword!==j.confirmPassword)return void r.error("Password baru tidak cocok!");if(!j.oldPassword)return void r.error("Password lama harus diisi!")}const a={name:j.name,email:j.email,phone:j.phone};j.newPassword&&(a.oldPassword=j.oldPassword,a.newPassword=j.newPassword),r.promise(u(a).unwrap().then((s=>s.message)),{loading:"Memperbarui profil...",success:s=>s,error:s=>s.data.message})},k=s=>{x((a=>({...a,[s]:!a[s]})))};return c.useEffect((()=>{w&&(N({name:"",email:"",phone:"",oldPassword:"",newPassword:"",confirmPassword:""}),h(!1),f(),P().unwrap().then((s=>{o(i(s))})).catch((s=>{r.error("Gagal memuat data pengguna"),console.error("Error: ",s)}))),v&&f()}),[w,v,o,P]),c.useEffect((()=>{m&&N({name:(null==m?void 0:m.name)||"",email:(null==m?void 0:m.email)||"",phone:(null==m?void 0:m.phone)||"",oldPassword:"",newPassword:"",confirmPassword:""})}),[m]),n.jsx(d,{title:"Profile",levels:["admin"],children:n.jsx("div",{className:"container-fluid",children:n.jsxs("div",{className:"row justify-content-center",children:[n.jsx("div",{className:"col-md-6 col-12",children:n.jsxs("div",{className:"card shadow mb-4",children:[n.jsxs("div",{className:"card-header bg-info d-flex justify-content-between align-items-center",children:[n.jsxs("h4",{className:"mb-0",children:[n.jsx("i",{className:"bi bi-person-circle me-2"}),"Informasi Profile"]}),n.jsxs("button",{className:"btn btn-light btn-sm",onClick:()=>h(!t),children:[n.jsx("i",{className:`bi bi-${t?"x-lg":"pencil"} me-1`}),t?"Cancel":"Edit Profile"]})]}),n.jsxs("div",{className:"card-body",children:[n.jsxs("div",{className:"row mb-4",children:[n.jsx("div",{className:"col-md-4 d-flex justify-content-center align-items-center",children:n.jsx("div",{style:{width:100,height:100},className:"rounded-circle bg-light d-flex justify-content-center align-items-center",children:n.jsx("i",{className:"bi bi-person-badge display-5 text-info"})})}),n.jsx("div",{className:"col-md-8",children:t?n.jsxs("form",{onSubmit:y,children:[n.jsxs("div",{className:"mb-3",children:[n.jsx("label",{className:"form-label",children:"Name"}),n.jsx("input",{type:"text",className:"form-control",name:"name",value:j.name,onChange:g})]}),n.jsxs("div",{className:"mb-3",children:[n.jsx("label",{className:"form-label",children:"Email"}),n.jsx("input",{type:"email",className:"form-control",name:"email",value:j.email,onChange:g})]}),n.jsxs("div",{className:"mb-3",children:[n.jsx("label",{className:"form-label",children:"Whatsapp"}),n.jsx("input",{type:"text",className:"form-control",name:"phone",value:j.phone,onChange:g})]}),n.jsxs("button",{type:"submit",className:"btn btn-info",disabled:p,children:[n.jsx("i",{className:"bi bi-save me-1"}),p?"Loading...":"Simpan Perubahan"]})]}):n.jsxs(n.Fragment,{children:[n.jsx("h3",{className:"mb-3",children:null==m?void 0:m.name}),n.jsxs("span",{className:"badge bg-success mb-2",children:[n.jsx("i",{className:"bi bi-check-circle me-1"}),null==m?void 0:m.level]}),(null==m?void 0:m.isactive)?n.jsxs("span",{className:"badge bg-success ms-2",children:[n.jsx("i",{className:"bi bi-check-circle me-1"}),"Aktif"]}):n.jsxs("span",{className:"badge bg-danger ms-2",children:[n.jsx("i",{className:"bi bi-x-circle me-1"}),"Nonaktif"]})]})})]}),!t&&n.jsxs("div",{className:"row",children:[n.jsx("div",{className:"col-md-6 mb-3",children:n.jsx("div",{className:"card h-100",children:n.jsxs("div",{className:"card-body",children:[n.jsxs("h5",{className:"card-title",children:[n.jsx("i",{className:"bi bi-envelope me-2 text-primary"}),"Email"]}),n.jsx("p",{className:"card-text",children:null==m?void 0:m.email})]})})}),n.jsx("div",{className:"col-md-6 mb-3",children:n.jsx("div",{className:"card h-100",children:n.jsxs("div",{className:"card-body",children:[n.jsxs("h5",{className:"card-title",children:[n.jsx("i",{className:"bi bi-telephone me-2 text-primary"}),"Whatsapp"]}),n.jsx("p",{className:"card-text",children:null==m?void 0:m.phone})]})})}),n.jsx("div",{className:"col-md-6 mb-3",children:n.jsx("div",{className:"card h-100",children:n.jsxs("div",{className:"card-body",children:[n.jsxs("h5",{className:"card-title",children:[n.jsx("i",{className:"bi bi-building me-2 text-primary"}),"Satuan"]}),n.jsx("p",{className:"card-text",children:null==m?void 0:m.homebase})]})})}),n.jsx("div",{className:"col-md-6 mb-3",children:n.jsx("div",{className:"card h-100",children:n.jsxs("div",{className:"card-body",children:[n.jsxs("h5",{className:"card-title",children:[n.jsx("i",{className:"bi bi-key me-2 text-primary"}),"Activation ID"]}),n.jsx("p",{className:"card-text small",children:null==m?void 0:m.activation})]})})})]})]})]})}),n.jsx("div",{className:"col-md-6 col-12",children:n.jsxs("div",{className:"card shadow",children:[n.jsx("div",{className:"card-header bg-warning text-dark",children:n.jsxs("h4",{className:"mb-0",children:[n.jsx("i",{className:"bi bi-shield-lock me-2"}),"Ubah Password"]})}),n.jsx("div",{className:"card-body",children:n.jsxs("form",{onSubmit:y,children:[n.jsxs("div",{className:"mb-3",children:[n.jsx("label",{className:"form-label",children:"Password Lama"}),n.jsxs("div",{className:"input-group",children:[n.jsx("input",{type:b.oldPassword?"text":"password",className:"form-control",name:"oldPassword",value:j.oldPassword,onChange:g,placeholder:"Masukkan password lama"}),n.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>k("oldPassword"),children:n.jsx("i",{className:"bi bi-eye"+(b.oldPassword?"-slash":"")})})]})]}),n.jsxs("div",{className:"mb-3",children:[n.jsx("label",{className:"form-label",children:"Password Baru"}),n.jsxs("div",{className:"input-group",children:[n.jsx("input",{type:b.newPassword?"text":"password",className:"form-control",name:"newPassword",value:j.newPassword,onChange:g,placeholder:"Masukkan password baru"}),n.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>k("newPassword"),children:n.jsx("i",{className:"bi bi-eye"+(b.newPassword?"-slash":"")})})]})]}),n.jsxs("div",{className:"mb-3",children:[n.jsx("label",{className:"form-label",children:"Konfirmasi Password Baru"}),n.jsxs("div",{className:"input-group",children:[n.jsx("input",{type:b.confirmPassword?"text":"password",className:"form-control",name:"confirmPassword",value:j.confirmPassword,onChange:g,placeholder:"Konfirmasi password baru"}),n.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>k("confirmPassword"),children:n.jsx("i",{className:"bi bi-eye"+(b.confirmPassword?"-slash":"")})})]})]}),n.jsxs("button",{type:"submit",className:"btn btn-warning",children:[n.jsx("i",{className:"bi bi-key me-1"}),"Ubah Password"]})]})})]})})]})})})};export{o as default};
//# sourceMappingURL=AdminProfile-B3d-l46t.js.map
