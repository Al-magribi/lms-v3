{"version":3,"file":"AdminPeriode-MZ8Cneyu.js","sources":["../../src/page/admin/periode/Form.jsx","../../src/page/admin/periode/TableData.jsx","../../src/page/admin/periode/AdminPeriode.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { toast } from \"react-hot-toast\";\r\nimport { useAddPeriodeMutation } from \"../../../controller/api/admin/ApiPeriode\";\r\n\r\nconst Form = ({ detail, setDetail }) => {\r\n  const [id, setId] = useState(\"\");\r\n  const [name, setName] = useState(\"\");\r\n\r\n  const [addPeriode, { isSuccess, isLoading, isError, reset }] =\r\n    useAddPeriodeMutation();\r\n\r\n  const addHandler = (e) => {\r\n    e.preventDefault();\r\n\r\n    const data = { id, name };\r\n\r\n    toast.promise(\r\n      addPeriode(data)\r\n        .unwrap()\r\n        .then((res) => res.message),\r\n      {\r\n        loading: \"Menyimpan data...\",\r\n        success: (message) => message,\r\n        error: (err) => err.data.message,\r\n      }\r\n    );\r\n  };\r\n\r\n  const cancel = () => {\r\n    setDetail({});\r\n    setId(\"\");\r\n    setName(\"\");\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isSuccess) {\r\n      reset();\r\n      setDetail({});\r\n      setId(\"\");\r\n      setName(\"\");\r\n    }\r\n\r\n    if (isError) {\r\n      reset();\r\n    }\r\n  }, [isSuccess, isError]);\r\n\r\n  useEffect(() => {\r\n    if (detail) {\r\n      setId(detail.id);\r\n      setName(detail.name);\r\n    }\r\n  }, [detail]);\r\n\r\n  return (\r\n    <form\r\n      onSubmit={addHandler}\r\n      className='rounded bg-white p-2 border d-flex flex-column gap-2'>\r\n      <p className='m-0 h6'>Periode</p>\r\n\r\n      <input\r\n        type='text'\r\n        name='periode'\r\n        id='periode'\r\n        className='form-control'\r\n        placeholder='Periode'\r\n        required\r\n        value={name || \"\"}\r\n        onChange={(e) => setName(e.target.value)}\r\n      />\r\n\r\n      <div className='d-flex justify-content-end gap-2'>\r\n        <button\r\n          type='button'\r\n          className='btn btn-sm btn-warning'\r\n          onClick={cancel}>\r\n          Batal\r\n        </button>\r\n        <button\r\n          type='submit'\r\n          className='btn btn-sm btn-success'\r\n          disabled={isLoading}>\r\n          Simpan\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default Form;\r\n","import { useEffect, useState } from \"react\";\r\nimport Table from \"../../../components/table/Table\";\r\nimport {\r\n  useChangeStatusMutation,\r\n  useDeletePeriodeMutation,\r\n  useGetPeriodesQuery,\r\n} from \"../../../controller/api/admin/ApiPeriode\";\r\nimport toast from \"react-hot-toast\";\r\nimport { useGetStudentsQuery } from \"../../../controller/api/admin/ApiStudent\";\r\nimport { useGetClassQuery } from \"../../../controller/api/admin/ApiClass\";\r\n\r\nconst TableData = ({ setDetail }) => {\r\n  const [page, setPage] = useState(1);\r\n  const [limit, setLimit] = useState(10);\r\n  const [search, setSearch] = useState(\"\");\r\n\r\n  const { data: rawData = {}, isLoading: dataLoading } = useGetPeriodesQuery({\r\n    page,\r\n    limit,\r\n    search,\r\n  });\r\n  const { periodes = [], totalData, totalPages } = rawData;\r\n  const [deletePeriode, { isSuccess, isLoading, isError, reset }] =\r\n    useDeletePeriodeMutation();\r\n  const [changeStatus] = useChangeStatusMutation();\r\n  const { refetch } = useGetStudentsQuery({\r\n    page,\r\n    limit,\r\n    search,\r\n  });\r\n  const { refetch: refetchClass } = useGetClassQuery({\r\n    page,\r\n    limit,\r\n    search,\r\n  });\r\n\r\n  const deleteHandler = (id) => {\r\n    const confirm = window.confirm(\r\n      \"Apakah anda yakin ingin menghapus periode ini dan semua data yang terkait dengan periode ini?\"\r\n    );\r\n    if (confirm) {\r\n      toast.promise(\r\n        deletePeriode(id)\r\n          .unwrap()\r\n          .then((res) => res.message),\r\n        {\r\n          loading: \"Memproses...\",\r\n          success: (message) => message,\r\n          error: (err) => err.data.message,\r\n        }\r\n      );\r\n    }\r\n  };\r\n\r\n  const changeHandler = (id) => {\r\n    const confirm = window.confirm(\r\n      \"Apakah anda yakin ingin mengubah status periode ini?\"\r\n    );\r\n    if (confirm) {\r\n      toast.promise(\r\n        changeStatus(id)\r\n          .unwrap()\r\n          .then((res) => {\r\n            refetch();\r\n            refetchClass();\r\n            return res.message;\r\n          }),\r\n        {\r\n          loading: \"Memproses...\",\r\n          success: (message) => message,\r\n          error: (err) => err.data.message,\r\n        }\r\n      );\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isSuccess) {\r\n      reset();\r\n    }\r\n\r\n    if (isError) {\r\n      reset();\r\n    }\r\n  }, [isSuccess, isError]);\r\n\r\n  return (\r\n    <Table\r\n      page={page}\r\n      setPage={setPage}\r\n      setLimit={setLimit}\r\n      setSearch={setSearch}\r\n      totalData={totalData}\r\n      totalPages={totalPages}\r\n      isLoading={dataLoading}\r\n    >\r\n      <table className=\"table table-bordered table-striped table-hover\">\r\n        <thead>\r\n          <tr>\r\n            <th className=\"text-center\">No</th>\r\n            <th className=\"text-center\">_id</th>\r\n            <th className=\"text-center\">Periode</th>\r\n            <th className=\"text-center\">Status</th>\r\n            <th className=\"text-center\">Aksi</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {periodes?.map((item, i) => (\r\n            <tr key={i}>\r\n              <td className=\"text-center align-middle\">\r\n                {(page - 1) * limit + i + 1}\r\n              </td>\r\n              <td className=\"text-center align-middle\">{item.id}</td>\r\n              <td className=\"text-center align-middle\">{item.name}</td>\r\n              <td className=\"text-center align-middle\">\r\n                <div\r\n                  className=\"form-check form-switch d-flex justify-content-center\"\r\n                  onClick={() => changeHandler(item.id)}\r\n                >\r\n                  <input\r\n                    className=\"form-check-input pointer\"\r\n                    type=\"checkbox\"\r\n                    role=\"switch\"\r\n                    id=\"flexSwitchCheckChecked\"\r\n                    checked={item.isactive}\r\n                    readOnly\r\n                  />\r\n                </div>\r\n              </td>\r\n              <td className=\"text-cente align-middle\">\r\n                <div className=\"d-flex justify-content-center gap-2\">\r\n                  <button\r\n                    className=\"btn btn-sm btn-warning\"\r\n                    onClick={() => setDetail(item)}\r\n                  >\r\n                    <i className=\"bi bi-pencil-square\"></i>\r\n                  </button>\r\n                  <button\r\n                    className=\"btn btn-sm btn-danger\"\r\n                    disabled={isLoading}\r\n                    onClick={() => deleteHandler(item.id)}\r\n                  >\r\n                    <i className=\"bi bi-folder-minus\"></i>\r\n                  </button>\r\n                </div>\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </Table>\r\n  );\r\n};\r\n\r\nexport default TableData;\r\n","import React, { useState } from \"react\"\r\nimport Layout from \"../../../components/layout/Layout\"\r\nimport Form from \"./Form\"\r\nimport TableData from \"./TableData\"\r\n\r\nconst AdminPeriode = () => {\r\n\tconst [detail, setDetail] = useState(\"\")\r\n\r\n\treturn (\r\n\t\t<Layout title={\"Periode Pembelajaran\"} levels={[\"admin\"]}>\r\n\t\t\t<div className='row g-2'>\r\n\t\t\t\t<div className='col-lg-3 col-12'>\r\n\t\t\t\t\t<Form detail={detail} setDetail={setDetail} />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className='col-lg-9 col-12'>\r\n\t\t\t\t\t<TableData setDetail={setDetail} />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</Layout>\r\n\t)\r\n}\r\n\r\nexport default AdminPeriode\r\n"],"names":["Form","detail","setDetail","id","setId","useState","name","setName","addPeriode","isSuccess","isLoading","isError","reset","useAddPeriodeMutation","useEffect","jsxRuntimeExports","jsxs","onSubmit","e","preventDefault","data","c","promise","unwrap","then","res","message","loading","success","error","err","className","children","jsx","type","placeholder","required","value","onChange","target","onClick","disabled","TableData","page","setPage","limit","setLimit","search","setSearch","rawData","dataLoading","useGetPeriodesQuery","periodes","totalData","totalPages","deletePeriode","useDeletePeriodeMutation","changeStatus","useChangeStatusMutation","refetch","useGetStudentsQuery","refetchClass","useGetClassQuery","Table","map","item","i","changeHandler","window","confirm","Vt","role","checked","isactive","readOnly","deleteHandler","AdminPeriode","Layout","title","levels"],"mappings":"wRAIA,MAAMA,EAAO,EAAGC,SAAQC,gBACtB,MAAOC,EAAIC,GAASC,EAAAA,SAAS,KACtBC,EAAMC,GAAWF,EAAAA,SAAS,KAE1BG,GAAYC,UAAEA,EAAAC,UAAWA,UAAWC,EAASC,MAAAA,IAClDC,IA8CA,OArBFC,EAAAA,WAAU,KACJL,IACIG,IACNV,EAAU,CAAA,GACVE,EAAM,IACNG,EAAQ,KAGNI,GACIC,GAAA,GAEP,CAACH,EAAWE,IAEfG,EAAAA,WAAU,KACJb,IACFG,EAAMH,EAAOE,IACbI,EAAQN,EAAOK,MAAI,GAEpB,CAACL,IAGFc,EAAAC,KAAC,OAAA,CACCC,SA7CgBC,IAClBA,EAAEC,iBAEI,MAAAC,EAAO,CAAEjB,KAAIG,QAEbe,EAAAC,QACJd,EAAWY,GACRG,SACAC,MAAMC,GAAQA,EAAIC,UACrB,CACEC,QAAS,oBACTC,QAAUF,GAAYA,EACtBG,MAAQC,GAAQA,EAAIV,KAAKM,SAE7B,EAgCEK,UAAU,uDACVC,SAAA,CAACC,EAAAA,IAAA,IAAA,CAAEF,UAAU,SAASC,SAAO,YAE7BjB,EAAAkB,IAAC,QAAA,CACCC,KAAK,OACL5B,KAAK,UACLH,GAAG,UACH4B,UAAU,eACVI,YAAY,UACZC,UAAQ,EACRC,MAAO/B,GAAQ,GACfgC,SAAWpB,GAAMX,EAAQW,EAAEqB,OAAOF,WAGpCrB,KAAC,MAAI,CAAAe,UAAU,mCACbC,SAAA,CAAAjB,EAAAkB,IAAC,SAAA,CACCC,KAAK,SACLH,UAAU,yBACVS,QA/CO,KACbtC,EAAU,CAAA,GACVE,EAAM,IACNG,EAAQ,GAAE,EA4CayB,SAAA,UAGnBjB,EAAAkB,IAAC,SAAA,CACCC,KAAK,SACLH,UAAU,yBACVU,SAAU/B,EAAWsB,SAAA,gBAI3B,EC1EEU,EAAY,EAAGxC,gBACnB,MAAOyC,EAAMC,GAAWvC,EAAAA,SAAS,IAC1BwC,EAAOC,GAAYzC,EAAAA,SAAS,KAC5B0C,EAAQC,GAAa3C,EAAAA,SAAS,KAE7Be,KAAM6B,EAAU,CAAA,EAAIvC,UAAWwC,GAAgBC,EAAoB,CACzER,OACAE,QACAE,YAEIK,SAAEA,EAAW,GAAIC,UAAAA,EAAAC,WAAWA,GAAeL,GAC1CM,GAAe9C,UAAEA,EAAAC,UAAWA,UAAWC,EAASC,MAAAA,IACrD4C,KACKC,GAAgBC,KACjBC,QAAEA,GAAYC,EAAoB,CACtCjB,OACAE,QACAE,YAEMY,QAASE,GAAiBC,EAAiB,CACjDnB,OACAE,QACAE,WAsDA,OAXFjC,EAAAA,WAAU,KACJL,GACIG,IAGJD,GACIC,GAAA,GAEP,CAACH,EAAWE,IAGbI,EAAAkB,IAAC8B,EAAA,CACCpB,OACAC,UACAE,WACAE,YACAK,YACAC,aACA5C,UAAWwC,EAEXlB,SAAAjB,EAAAC,KAAC,QAAM,CAAAe,UAAU,iDACfC,SAAA,CAACC,EAAAA,IAAA,QAAA,CACCD,gBAAC,KACC,CAAAA,SAAA,CAACC,EAAAA,IAAA,KAAA,CAAGF,UAAU,cAAcC,SAAE,OAC7BC,EAAAA,IAAA,KAAA,CAAGF,UAAU,cAAcC,SAAG,QAC9BC,EAAAA,IAAA,KAAA,CAAGF,UAAU,cAAcC,SAAO,YAClCC,EAAAA,IAAA,KAAA,CAAGF,UAAU,cAAcC,SAAM,WACjCC,EAAAA,IAAA,KAAA,CAAGF,UAAU,cAAcC,SAAI,cAGpCC,EAAAA,IAAC,SACED,SAAU,MAAAoB,OAAA,EAAAA,EAAAY,KAAI,CAACC,EAAMC,WACnB,KACC,CAAAlC,SAAA,CAAAC,EAAAA,IAAC,MAAGF,UAAU,2BACVC,YAAO,GAAKa,EAAQqB,EAAI,IAE3BjC,EAAAA,IAAA,KAAA,CAAGF,UAAU,2BAA4BC,WAAK7B,KAC9C8B,EAAAA,IAAA,KAAA,CAAGF,UAAU,2BAA4BC,WAAK1B,SAC/C2B,IAAC,KAAG,CAAAF,UAAU,2BACZC,SAAAjB,EAAAkB,IAAC,MAAA,CACCF,UAAU,uDACVS,QAAS,KAAM2B,OA/DRhE,EA+DsB8D,EAAK9D,QA9DhCiE,OAAOC,QACrB,yDAGMC,EAAAhD,QACJmC,EAAatD,GACVoB,SACAC,MAAMC,IACGkC,IACKE,IACNpC,EAAIC,WAEf,CACEC,QAAS,eACTC,QAAUF,GAAYA,EACtBG,MAAQC,GAAQA,EAAIV,KAAKM,WAhBX,IAACvB,CA+D6B,EAEpC6B,SAAAjB,EAAAkB,IAAC,QAAA,CACCF,UAAU,2BACVG,KAAK,WACLqC,KAAK,SACLpE,GAAG,yBACHqE,QAASP,EAAKQ,SACdC,UAAQ,cAIb,KAAG,CAAA3C,UAAU,0BACZC,SAAChB,EAAAA,KAAA,MAAA,CAAIe,UAAU,sCACbC,SAAA,CAAAjB,EAAAkB,IAAC,SAAA,CACCF,UAAU,yBACVS,QAAS,IAAMtC,EAAU+D,GAEzBjC,SAAAC,EAAAA,IAAC,IAAE,CAAAF,UAAU,0BAEfhB,EAAAkB,IAAC,SAAA,CACCF,UAAU,wBACVU,SAAU/B,EACV8B,QAAS,KAAMmC,OAxGVxE,EAwGwB8D,EAAK9D,QAvGlCiE,OAAOC,QACrB,kGAGMC,EAAAhD,QACJiC,EAAcpD,GACXoB,SACAC,MAAMC,GAAQA,EAAIC,UACrB,CACEC,QAAS,eACTC,QAAUF,GAAYA,EACtBG,MAAQC,GAAQA,EAAIV,KAAKM,WAZX,IAACvB,CAwG+B,EAEpC6B,SAAAC,EAAAA,IAAC,IAAE,CAAAF,UAAU,gCAlCZmC,WA0CjB,ECjJEU,EAAe,KACpB,MAAO3E,EAAQC,GAAaG,EAAAA,SAAS,IAGpC,SAAA4B,IAAC4C,EAAO,CAAAC,MAAO,uBAAwBC,OAAQ,CAAC,SAC/C/C,SAAAjB,EAAAC,KAAC,MAAI,CAAAe,UAAU,UACdC,SAAA,CAAAC,EAAAA,IAAC,OAAIF,UAAU,kBACdC,eAAChC,EAAK,CAAAC,SAAgBC,sBAEtB,MAAI,CAAA6B,UAAU,kBACdC,SAACC,EAAAA,IAAAS,EAAA,CAAUxC,oBAGd"}