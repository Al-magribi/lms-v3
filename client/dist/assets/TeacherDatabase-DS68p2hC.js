import{av as e,a3 as s,a5 as a,H as t,j as n,V as i}from"./index-CNbAajcm.js";import{u as l,e as r,b as c}from"./vendor-BYWiIb5-.js";import{L as d}from"./Layout-_SAc74nU.js";import{T as m}from"./Table-BSwODE4h.js";import"./index-C-OX0RB-.js";import"./index-DLmIb9aI.js";const o=()=>{const o=l(),{classname:h,classid:x}=r(),[j,p]=c.useState(1),[g,u]=c.useState(10),[b,N]=c.useState(""),[v,f]=c.useState(""),{data:y,isLoading:k,isError:w,refetch:S}=e({page:j,limit:g,search:b,classid:x}),{students:_=[],totalData:L,totalPages:C}=y||{},{data:P}=s(),[T,{isLoading:$}]=a(),[A,{isLoading:D}]=t();return n.jsx(d,{title:`Database Kelas ${h.replace(/-/g," ")}`,levels:["teacher"],children:n.jsx(m,{isLoading:k,page:j,setPage:p,limit:g,setLimit:u,setSearch:N,totalData:L,totalPages:C,children:n.jsxs("table",{className:"mb-0 table table-striped table-hover table-bordered",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-center",children:"No"}),n.jsx("th",{className:"text-center",children:"Tahun Ajaran"}),n.jsx("th",{className:"text-center",children:"Satuan"}),n.jsx("th",{className:"text-center",children:"Nama"}),n.jsx("th",{className:"text-center",children:"Kelas"}),n.jsx("th",{className:"text-center",children:"L/P"}),n.jsx("th",{className:"text-center",children:"Kelengkapan"}),n.jsx("th",{className:"text-center",children:"Status"}),n.jsx("th",{className:"text-center",children:"Aksi"})]})}),n.jsx("tbody",{children:_.map(((e,s)=>n.jsxs("tr",{children:[n.jsx("td",{className:"text-center align-middle",children:(j-1)*g+s+1}),n.jsx("td",{className:"text-center align-middle",children:e.periode_name===e.active_periode?e.periode_name:n.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[n.jsx("span",{className:"badge bg-danger",children:e.periode_name}),n.jsx("i",{className:"bi bi-arrow-right"}),n.jsx("span",{className:"badge bg-success",children:e.active_periode})]})}),n.jsx("td",{className:"text-center align-middle",children:e.homebase_name}),n.jsx("td",{className:"align-middle",children:e.student_name}),n.jsx("td",{className:"text-center align-middle",children:e.class_name}),n.jsx("td",{className:"text-center align-middle",children:e.student_gender}),n.jsx("td",{className:"text-center align-middle",children:n.jsx("div",{className:"progress",style:{height:"20px"},children:n.jsxs("div",{className:"progress-bar "+(100===parseInt(e.completeness)?"bg-success":parseInt(e.completeness)>=50?"bg-warning":"bg-danger"),role:"progressbar",style:{width:`${e.completeness}%`},"aria-valuenow":e.completeness,"aria-valuemin":"0","aria-valuemax":"100",children:[e.completeness,"%"]})})}),n.jsx("td",{className:"text-center align-middle",children:n.jsx("div",{className:"form-check form-switch d-flex justify-content-center",onClick:()=>{return s=e.student,void i.promise(A(s).unwrap().then((e=>(S(),e.message))),{loading:"Memproses...",success:e=>e,error:e=>e.data.message});var s},children:n.jsx("input",{className:"form-check-input pointer",type:"checkbox",role:"switch",id:"flexSwitchCheckChecked",checked:e.isactive,readOnly:!0})})}),n.jsx("td",{className:"text-center align-middle",children:n.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>((e,s)=>{const a=s.replace(/\s+/g,"-");o(`/database/${e}/${a}`)})(e.student,e.student_name),children:n.jsx("i",{className:"bi bi-database"})})})]},e.id)))}),n.jsx("tfoot",{children:n.jsx("tr",{children:n.jsx("td",{colSpan:9,children:n.jsxs("div",{className:"d-flex align-items-center justify-content-end gap-2",children:[n.jsxs("select",{style:{width:"20%"},className:"form-select",value:v,onChange:e=>{const s=e.target.value;f(s)},children:[n.jsx("option",{value:"",hidden:!0,children:"Ganti Tahun Ajaran"}),null==P?void 0:P.map((e=>n.jsx("option",{value:e.id,children:e.name},e.id)))]}),n.jsxs("button",{className:"btn btn-sm btn-success",onClick:async()=>{if(v)try{const e=_.map((e=>T({userid:e.student,periodeid:v})));await Promise.all(e),i.success("Berhasil mengganti tahun ajaran"),f(""),S()}catch(e){console.error("Error updating periods:",e),i.error("Gagal mengganti tahun ajaran")}else i.error("Pilih tahun ajaran terlebih dahulu")},disabled:$||!v,children:[n.jsx("i",{className:"bi bi-save"}),n.jsx("span",{className:"ms-2",children:$?"Menyimpan...":"Simpan"})]})]})})})})]})})})};export{o as default};
//# sourceMappingURL=TeacherDatabase-DS68p2hC.js.map
