{"version":3,"file":"Editor-CbDDl2NV.js","sources":["../../src/components/editor/Editor.jsx"],"sourcesContent":["import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport ReactQuill, { Quill } from \"react-quill-new\";\r\nimport QuillResizeImage from \"quill-resize-image\";\r\nimport \"react-quill-new/dist/quill.snow.css\";\r\n\r\n// Register the resize module\r\nQuill.register(\"modules/resize\", QuillResizeImage);\r\n\r\n// Register the audio format\r\nconst AudioBlot = Quill.import(\"blots/block/embed\");\r\n\r\nclass Audio extends AudioBlot {\r\n  static create(value) {\r\n    const node = super.create();\r\n    node.setAttribute(\"controls\", \"\");\r\n    node.setAttribute(\"src\", value);\r\n    return node;\r\n  }\r\n\r\n  static value(node) {\r\n    return node.getAttribute(\"src\");\r\n  }\r\n}\r\n\r\nAudio.blotName = \"audio\";\r\nAudio.tagName = \"audio\";\r\nAudio.className = \"ql-audio\";\r\n\r\nQuill.register(Audio);\r\n\r\nclass Editor extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { editorHtml: props.value || \"\" };\r\n    this.reactQuillRef = React.createRef();\r\n  }\r\n\r\n  handleChange = (html) => {\r\n    this.setState({ editorHtml: html });\r\n    this.props.onChange(html);\r\n  };\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.value !== this.props.value) {\r\n      this.setState({ editorHtml: this.props.value });\r\n    }\r\n  }\r\n\r\n  handleImageUpload = () => {\r\n    const input = document.createElement(\"input\");\r\n    input.setAttribute(\"type\", \"file\");\r\n    input.setAttribute(\"accept\", \"image/*\");\r\n    input.click();\r\n\r\n    input.onchange = async () => {\r\n      const file = input.files[0];\r\n      if (file) {\r\n        const formData = new FormData();\r\n        formData.append(\"file\", file);\r\n\r\n        try {\r\n          const response = await fetch(`/api/bank/upload/image`, {\r\n            method: \"POST\",\r\n            body: formData,\r\n          });\r\n          const data = await response.json();\r\n\r\n          const editor = this.reactQuillRef.current?.getEditor();\r\n          if (editor) {\r\n            const range = editor.getSelection(true);\r\n            editor.insertEmbed(range.index, \"image\", data.url);\r\n\r\n            console.log(data);\r\n          }\r\n        } catch (error) {\r\n          console.error(\"Error uploading image:\", error);\r\n          alert(\"Gagal mengunggah gambar. Coba lagi.\");\r\n        }\r\n      }\r\n    };\r\n  };\r\n\r\n  handleAudioUpload = () => {\r\n    const input = document.createElement(\"input\");\r\n    input.setAttribute(\"type\", \"file\");\r\n    input.setAttribute(\"accept\", \"audio/*\");\r\n    input.click();\r\n\r\n    input.onchange = async () => {\r\n      const file = input.files[0];\r\n      if (file) {\r\n        const formData = new FormData();\r\n        formData.append(\"file\", file);\r\n\r\n        try {\r\n          const response = await fetch(`/api/bank/upload/audio`, {\r\n            method: \"POST\",\r\n            body: formData,\r\n          });\r\n          const data = await response.json();\r\n\r\n          const editor = this.reactQuillRef.current?.getEditor();\r\n          if (editor) {\r\n            const range = editor.getSelection(true);\r\n            editor.insertEmbed(range.index, \"audio\", data.url);\r\n          }\r\n        } catch (error) {\r\n          console.error(\"Error uploading audio:\", error);\r\n          alert(\"Gagal mengunggah audio. Coba lagi.\");\r\n        }\r\n      }\r\n    };\r\n  };\r\n\r\n  render() {\r\n    const { placeholder, height, classname } = this.props;\r\n\r\n    return (\r\n      <div className=\"d-flex mb-2\" style={{ height: height }}>\r\n        <ReactQuill\r\n          ref={this.reactQuillRef}\r\n          theme=\"snow\"\r\n          value={this.state.editorHtml}\r\n          onChange={this.handleChange}\r\n          modules={Editor.modules(\r\n            this.handleImageUpload,\r\n            this.handleAudioUpload\r\n          )}\r\n          formats={Editor.formats}\r\n          placeholder={placeholder}\r\n          style={{ width: \"100%\" }}\r\n          className={`react-quill border border-2 bg-white rounded ${classname}`}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nEditor.modules = (handleImageUpload, handleAudioUpload) => {\r\n  return {\r\n    toolbar: {\r\n      container: [\r\n        [{ header: \"1\" }, { header: \"2\" }, { font: [] }],\r\n        [{ size: [] }],\r\n        [\"bold\", \"italic\", \"underline\", \"strike\", \"blockquote\"],\r\n        [\r\n          { list: \"ordered\" },\r\n          { list: \"bullet\" },\r\n          { indent: \"-1\" },\r\n          { indent: \"+1\" },\r\n        ],\r\n        [\"link\", \"image\", \"audio\", \"video\"],\r\n        [\"clean\"],\r\n      ],\r\n      handlers: {\r\n        image: handleImageUpload,\r\n        audio: handleAudioUpload,\r\n      },\r\n    },\r\n    clipboard: {\r\n      matchVisual: false,\r\n    },\r\n    resize: {\r\n      modules: [\"Resize\"],\r\n    },\r\n  };\r\n};\r\n\r\nEditor.formats = [\r\n  \"header\",\r\n  \"font\",\r\n  \"size\",\r\n  \"bold\",\r\n  \"italic\",\r\n  \"underline\",\r\n  \"strike\",\r\n  \"blockquote\",\r\n  \"list\",\r\n  \"indent\",\r\n  \"link\",\r\n  \"image\",\r\n  \"audio\",\r\n  \"video\",\r\n];\r\n\r\nEditor.propTypes = {\r\n  placeholder: PropTypes.string,\r\n  value: PropTypes.string,\r\n  onChange: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default Editor;\r\n"],"names":["Quill","register","QuillResizeImage","AudioBlot","import","Audio","create","value","node","super","setAttribute","getAttribute","blotName","tagName","className","Editor","Component","constructor","props","__publicField","this","html","setState","editorHtml","onChange","input","document","createElement","click","onchange","async","file","files","formData","FormData","append","response","fetch","method","body","data","json","editor","_a","reactQuillRef","current","getEditor","range","getSelection","insertEmbed","index","url","console","log","error","alert","state","React","createRef","componentDidUpdate","prevProps","render","placeholder","height","classname","style","children","jsxRuntimeExports","jsx","ReactQuill","ref","theme","handleChange","modules","handleImageUpload","handleAudioUpload","formats","width","toolbar","container","header","font","size","list","indent","handlers","image","audio","clipboard","matchVisual","resize","propTypes","PropTypes","string","func","isRequired"],"mappings":"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"}