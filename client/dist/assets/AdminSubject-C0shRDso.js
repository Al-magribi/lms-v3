import{az as e,j as a,e as s,an as l,c as t,aA as i}from"./index-DmZz6DJh.js";import{b as n,u as d}from"./vendor-DfXzdC0j.js";import{L as c}from"./Layout-CsIsJGyq.js";import{T as r}from"./Table-CeIWKjfj.js";import"./index-CGMX7dKw.js";import"./index-hpZ4eOv6.js";import"./index-DyuEXp_a.js";const m=({detail:l,setDetail:t})=>{const[i,d]=n.useState(""),[c,r]=n.useState(""),[m,o]=n.useState(null),x=n.useRef(null),[h,{isSuccess:j,isLoading:b,isError:u,reset:N}]=e(),p=()=>{t({}),d(""),r(""),x.current&&(x.current.value=null)};return n.useEffect((()=>{l&&(d(l.id),r(l.name))}),[l]),n.useEffect((()=>{if(j||u){N(),t({}),d(""),r(""),x.current&&(x.current.value=null);document.querySelector("[data-bs-dismiss='modal']").click()}}),[j,u]),a.jsx("div",{className:"modal fade",id:"addsubject","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"subjectModalLabel","aria-hidden":l&&l.id?"false":"true",children:a.jsx("div",{className:"modal-dialog",children:a.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!c)return s.error("Lengkapi data");const a=new FormData;a.append("id",i||""),a.append("name",c),a.append("cover",m),s.promise(h(a).unwrap().then((e=>e.message)),{loading:"Meyimpan data...",success:e=>e,error:e=>e.data.message})},className:"modal-content p-3",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h5",{className:"modal-title",id:"subjectModalLabel",children:i?"Edit Mata Pelajaran":"Tambah Mata Pelajaran"}),a.jsx("button",{type:"button",className:"btn-close","aria-label":"Close","data-bs-dismiss":"modal",onClick:p})]}),a.jsxs("div",{className:"modal-body d-flex flex-column gap-3",children:[a.jsx("input",{type:"text",name:"name",id:"name",className:"form-control",placeholder:"Nama Mata Pelajaran",value:c||"",onChange:e=>r(e.target.value)}),a.jsxs("div",{className:"input-group",children:[a.jsx("input",{type:"file",className:"form-control",id:"inputGroupFile02",ref:x,onChange:e=>o(e.target.files[0])}),a.jsx("label",{className:"input-group-text",htmlFor:"inputGroupFile02",children:"Cover"})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn btn-warning","data-bs-dismiss":"modal",onClick:p,children:"Batal"}),a.jsx("button",{type:"submit",className:"btn btn-success",disabled:b,children:"Simpan"})]})]})})})},o=({setDetail:e})=>{var c;const m=d(),[o,x]=n.useState(1),[h,j]=n.useState(10),[b,u]=n.useState(""),[N,p]=n.useState(null),{data:g={},isLoading:v}=l({page:o,limit:h,search:b});t();const{totalData:f,totalPages:y,subjects:k=[]}=g,[w,{isSuccess:M,isLoading:S,isError:D,reset:C}]=i();return n.useEffect((()=>{(M||D)&&C()}),[M,D]),a.jsxs(a.Fragment,{children:[a.jsx(r,{page:o,setPage:x,setLimit:j,setSearch:u,totalData:f,totalPages:y,isLoading:v,children:a.jsx("div",{className:"table-responsive",children:a.jsxs("table",{className:"table table-striped table-hover ",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-center",children:"No"}),a.jsx("th",{className:"text-center",children:"Nama"}),a.jsx("th",{className:"text-center",children:"Guru"}),a.jsx("th",{className:"text-center",children:"Aksi"})]})}),a.jsx("tbody",{children:(null==k?void 0:k.length)>0?k.map(((l,t)=>a.jsxs("tr",{children:[a.jsx("td",{className:"text-center align-middle",children:(o-1)*h+t+1}),a.jsx("td",{className:"align-middle text-start",children:l.name}),a.jsx("td",{className:"text-center align-middle",children:l.teachers.length>0?a.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{p(e)})(l),"data-bs-toggle":"modal","data-bs-target":"#teacherDetailModal",children:[a.jsx("i",{className:"bi bi-eye me-1"}),"Lihat Guru"]}):a.jsx("span",{className:"text-secondary fw-normal small",children:"Data belum tersedia"})}),a.jsx("td",{className:"text-center align-middle",children:a.jsxs("div",{className:"dropdown",children:[a.jsx("button",{className:"btn btn-sm btn-outline-primary",type:"button",id:`dropdownMenuButton${l.id}`,"data-bs-toggle":"dropdown","aria-expanded":"false",children:"Pilihan Aksi"}),a.jsxs("ul",{className:"dropdown-menu dropdown-menu-end","aria-labelledby":`dropdownMenuButton${l.id}`,children:[a.jsx("li",{children:a.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2",onClick:()=>((e,a)=>{const s=e.replace(/\s+/g,"-");m(`/pelajaran/${s}/${a}`)})(l.name,l.id),children:[a.jsx("i",{className:"bi bi-eye"})," Detail"]})}),a.jsx("li",{children:a.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2",onClick:()=>e(l),"data-bs-toggle":"modal","data-bs-target":"#addsubject",children:[a.jsx("i",{className:"bi bi-pencil-square"})," Edit"]})}),a.jsx("li",{children:a.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2 text-danger",disabled:S,onClick:()=>{return e=l.id,void(window.confirm("Apakah anda yakin ingin menghapus data mata pelajaran ini dan semua data yang terkait dengan mata pelajaran ini?")&&s.promise(w(e).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message}));var e},children:[a.jsx("i",{className:"bi bi-folder-minus"})," Hapus"]})})]})]})})]},t))):a.jsx("tr",{children:a.jsx("td",{colSpan:"4",className:"text-center",children:a.jsxs("div",{className:"alert alert-danger d-flex align-items-center justify-content-center",role:"alert",children:[a.jsx("i",{className:"bi bi-exclamation-circle-fill me-2"}),a.jsx("span",{children:"Data belum tersedia"})]})})})})]})})}),a.jsx("div",{className:"modal fade",id:"teacherDetailModal",tabIndex:"-1","aria-labelledby":"teacherDetailModalLabel","aria-hidden":"true",children:a.jsx("div",{className:"modal-dialog modal-lg",children:a.jsxs("div",{className:"modal-content",children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h5",{className:"modal-title",id:"teacherDetailModalLabel",children:[a.jsx("i",{className:"bi bi-person-badge me-2"}),"Detail Guru - ",null==N?void 0:N.name]}),a.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),a.jsx("div",{className:"modal-body",children:(null==(c=null==N?void 0:N.teachers)?void 0:c.length)>0?a.jsx("div",{className:"row",children:N.teachers.map(((e,s)=>{var l;return a.jsx("div",{className:"col-12 mb-4",children:a.jsxs("div",{className:"card border-0 shadow-sm",children:[a.jsx("div",{className:"card-header bg-primary text-white",children:a.jsxs("h6",{className:"mb-0",children:[a.jsx("i",{className:"bi bi-person-circle me-2"}),e.name]})}),a.jsxs("div",{className:"card-body",children:[a.jsxs("div",{className:"row",children:[a.jsxs("div",{className:"col-md-6",children:[a.jsxs("h6",{className:"text-primary mb-3",children:[a.jsx("i",{className:"bi bi-info-circle me-2"}),"Informasi Guru"]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("strong",{children:"Nama:"})," ",e.name]}),(null==(l=e.class)?void 0:l.length)>0?a.jsxs("div",{className:"mb-3",children:[a.jsx("strong",{children:"Kelas yang diajar:"}),a.jsx("div",{className:"mt-1",children:e.class.map(((e,s)=>a.jsx("span",{className:"badge bg-secondary me-1 mb-1",children:e.name},s)))}),a.jsxs("small",{className:"text-muted",children:["Total: ",e.class.length," kelas"]})]}):a.jsxs("div",{className:"mb-3",children:[a.jsx("strong",{children:"Kelas yang diajar:"}),a.jsx("div",{className:"mt-1",children:a.jsxs("span",{className:"text-muted",children:[a.jsx("i",{className:"bi bi-dash-circle me-1"}),"Belum ditugaskan ke kelas"]})})]})]}),a.jsxs("div",{className:"col-md-6",children:[a.jsxs("h6",{className:"text-primary mb-3",children:[a.jsx("i",{className:"bi bi-book me-2"}),"Statistik Materi"]}),a.jsxs("div",{className:"row text-center",children:[a.jsx("div",{className:"col-6",children:a.jsx("div",{className:"card "+(e.chapters>0?"border-primary":"bg-light"),children:a.jsxs("div",{className:"card-body py-2",children:[a.jsx("h4",{className:"mb-0 "+(e.chapters>0?"text-primary":"text-muted"),children:e.chapters||0}),a.jsxs("small",{className:"text-muted",children:[a.jsx("i",{className:"bi bi-collection me-1"}),"Chapter"]})]})})}),a.jsx("div",{className:"col-6",children:a.jsx("div",{className:"card "+(e.contents>0?"border-success":"bg-light"),children:a.jsxs("div",{className:"card-body py-2",children:[a.jsx("h4",{className:"mb-0 "+(e.contents>0?"text-success":"text-muted"),children:e.contents||0}),a.jsxs("small",{className:"text-muted",children:[a.jsx("i",{className:"bi bi-file-text me-1"}),"Materi"]})]})})})]}),(e.chapters>0||e.contents>0)&&a.jsx("div",{className:"mt-2 text-center",children:a.jsxs("small",{className:"text-success",children:[a.jsx("i",{className:"bi bi-check-circle me-1"}),"Guru aktif mengunggah materi"]})})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("h6",{className:"text-primary mb-3",children:[a.jsx("i",{className:"bi bi-list-ul me-2"}),"Detail Chapter dan Materi"]}),e.chapters>0||e.contents>0?a.jsxs("div",{className:"row",children:[a.jsxs("div",{className:"col-md-6",children:[a.jsxs("h6",{className:"text-secondary",children:[a.jsx("i",{className:"bi bi-book me-2"}),"Statistik Chapter:"]}),a.jsx("div",{className:"card bg-light",children:a.jsxs("div",{className:"card-body",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsx("span",{children:"Total Chapter:"}),a.jsx("span",{className:"badge bg-primary fs-6",children:e.chapters})]}),a.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-2",children:[a.jsx("span",{children:"Total Materi:"}),a.jsx("span",{className:"badge bg-success fs-6",children:e.contents})]})]})})]}),a.jsxs("div",{className:"col-md-6",children:[a.jsxs("h6",{className:"text-secondary",children:[a.jsx("i",{className:"bi bi-info-circle me-2"}),"Status Materi:"]}),a.jsx("div",{className:"card bg-light",children:a.jsxs("div",{className:"card-body",children:[e.chapters>0?a.jsxs("div",{className:"text-success",children:[a.jsx("i",{className:"bi bi-check-circle me-2"}),"Materi sudah tersedia"]}):a.jsxs("div",{className:"text-warning",children:[a.jsx("i",{className:"bi bi-exclamation-triangle me-2"}),"Belum ada materi"]}),e.contents>0&&a.jsxs("div",{className:"text-info mt-2",children:[a.jsx("i",{className:"bi bi-file-earmark-text me-2"}),e.contents," konten tersedia"]})]})})]})]}):a.jsxs("div",{className:"alert alert-warning",children:[a.jsx("i",{className:"bi bi-exclamation-triangle me-2"}),a.jsx("strong",{children:"Belum ada materi yang tersedia"}),a.jsx("br",{}),a.jsx("small",{className:"text-muted",children:"Guru ini belum mengunggah chapter atau materi untuk mata pelajaran ini."})]})]})]})]})},s)}))}):a.jsxs("div",{className:"text-center py-4",children:[a.jsx("i",{className:"bi bi-exclamation-triangle text-warning",style:{fontSize:"3rem"}}),a.jsx("h5",{className:"mt-3 text-muted",children:"Tidak ada data guru"}),a.jsx("p",{className:"text-muted",children:"Belum ada guru yang ditugaskan untuk mata pelajaran ini."})]})}),a.jsx("div",{className:"modal-footer",children:a.jsxs("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:[a.jsx("i",{className:"bi bi-x-circle me-1"}),"Tutup"]})})]})})})]})},x=()=>{const[e,s]=n.useState({});return a.jsxs(c,{title:"Mata Pelajaran",levels:["admin"],children:[a.jsx(m,{detail:e,setDetail:s}),a.jsx(o,{setDetail:s})]})};export{x as default};
//# sourceMappingURL=AdminSubject-C0shRDso.js.map
