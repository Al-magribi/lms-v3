{"version":3,"file":"Subject-Ddgpie1l.js","sources":["../../src/page/lms/list/Subject.jsx"],"sourcesContent":["import React from \"react\";\r\nimport Layout from \"../../../components/layout/Layout\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { useGetSubjectQuery } from \"../../../controller/api/lms/ApiLms\";\r\n\r\nconst createMarkup = (html) => {\r\n  return { __html: html };\r\n};\r\n\r\nconst Subject = () => {\r\n  const { id, name } = useParams();\r\n  const { user } = useSelector((state) => state.auth);\r\n  const formattedName = name.replace(/\\s+/g, \"-\");\r\n\r\n  // Fetch subject data using the new endpoint\r\n  const {\r\n    data: subject,\r\n    isLoading,\r\n    error,\r\n  } = useGetSubjectQuery(\r\n    {\r\n      subjectid: id,\r\n      classid: user?.level === \"student\" ? user?.class_id : undefined,\r\n    },\r\n    { skip: !id }\r\n  );\r\n\r\n  return (\r\n    <Layout title={formattedName} levels={[\"student\", \"admin\"]}>\r\n      <div className='container py-4'>\r\n        {isLoading ? (\r\n          <div className='text-center py-5'>\r\n            <div className='spinner-border text-primary' role='status'>\r\n              <span className='visually-hidden'>Loading...</span>\r\n            </div>\r\n            <p className='mt-2'>Memuat data mata pelajaran...</p>\r\n          </div>\r\n        ) : error ? (\r\n          <div className='alert alert-danger'>\r\n            Terjadi kesalahan saat memuat data: {error.message}\r\n          </div>\r\n        ) : subject ? (\r\n          <>\r\n            {/* Subject Header */}\r\n            <div className='card mb-4 shadow'>\r\n              <div className='card-body'>\r\n                <div className='d-flex align-items-center'>\r\n                  {subject.cover ? (\r\n                    <img\r\n                      src={`${window.location.origin}${subject.cover}`}\r\n                      alt={subject.name}\r\n                      className='me-3 rounded'\r\n                      style={{\r\n                        width: \"120px\",\r\n                        height: \"150px\",\r\n                        objectFit: \"cover\",\r\n                      }}\r\n                    />\r\n                  ) : (\r\n                    <div\r\n                      className='me-3 bg-light rounded d-flex align-items-center justify-content-center'\r\n                      style={{ width: \"80px\", height: \"80px\" }}\r\n                    >\r\n                      <i\r\n                        className='bi bi-book text-muted'\r\n                        style={{ fontSize: \"2rem\" }}\r\n                      ></i>\r\n                    </div>\r\n                  )}\r\n                  <div>\r\n                    <h5 className='card-title mb-1'>{subject.name}</h5>\r\n                    <p className='card-subtitle text-muted'>\r\n                      {subject.chapters?.length || 0} Bab Pembelajaran\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Chapters Accordion */}\r\n            <div className='accordion mb-4 shadow' id='chaptersAccordion'>\r\n              {subject.chapters?.map((chapter, index) => (\r\n                <div key={chapter.id} className='accordion-item'>\r\n                  <h2 className='accordion-header' id={`heading${chapter.id}`}>\r\n                    <button\r\n                      className={`accordion-button ${\r\n                        index === 0 ? \"\" : \"collapsed\"\r\n                      }`}\r\n                      type='button'\r\n                      data-bs-toggle='collapse'\r\n                      data-bs-target={`#collapse${chapter.id}`}\r\n                      aria-expanded={index === 0 ? \"true\" : \"false\"}\r\n                      aria-controls={`collapse${chapter.id}`}\r\n                    >\r\n                      <div className='d-flex align-items-center'>\r\n                        <i className='bi bi-folder me-2 text-primary'></i>\r\n                        <div>\r\n                          <div className='fw-bold'>{chapter.title}</div>\r\n                          <small\r\n                            className='text-muted m-0'\r\n                            dangerouslySetInnerHTML={createMarkup(\r\n                              chapter.target\r\n                            )}\r\n                          />\r\n                          {/* Chapter Info - Teacher and Classes */}\r\n                          <div className='mt-2'>\r\n                            <div className='d-flex align-items-center mb-1'>\r\n                              <i className='bi bi-person me-2 text-primary'></i>\r\n                              <small className='text-muted me-2'>\r\n                                Pengajar:\r\n                              </small>\r\n                              <span className='fw-medium'>\r\n                                {chapter.teacher_name || \"Tidak ada data\"}\r\n                              </span>\r\n                            </div>\r\n                            <div className='d-flex align-items-center'>\r\n                              <i className='bi bi-people me-2 text-primary'></i>\r\n                              <small className='text-muted me-2'>Kelas:</small>\r\n                              <div className='d-flex flex-wrap gap-1'>\r\n                                {chapter.classes &&\r\n                                chapter.classes.length > 0 ? (\r\n                                  chapter.classes.map((cls, idx) => (\r\n                                    <span\r\n                                      key={idx}\r\n                                      className='badge bg-primary me-1'\r\n                                    >\r\n                                      {cls.name}\r\n                                    </span>\r\n                                  ))\r\n                                ) : (\r\n                                  <span className='text-muted'>\r\n                                    Tidak ada data\r\n                                  </span>\r\n                                )}\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </button>\r\n                  </h2>\r\n                  <div\r\n                    id={`collapse${chapter.id}`}\r\n                    className={`accordion-collapse collapse ${\r\n                      index === 0 ? \"show\" : \"\"\r\n                    }`}\r\n                    aria-labelledby={`heading${chapter.id}`}\r\n                    data-bs-parent='#chaptersAccordion'\r\n                  >\r\n                    <div className='accordion-body'>\r\n                      {/* Content Items */}\r\n                      {chapter.contents?.map((content) => (\r\n                        <div key={content.id} className='card mb-3'>\r\n                          <div className='card-header bg-light'>\r\n                            <div className='d-flex align-items-center'>\r\n                              <i className='bi bi-book me-2 text-primary'></i>\r\n                              <div>\r\n                                <div className='fw-bold'>{content.title}</div>\r\n                                <small\r\n                                  className='text-muted m-0'\r\n                                  dangerouslySetInnerHTML={createMarkup(\r\n                                    content.target\r\n                                  )}\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                          <div className='card-body'>\r\n                            {/* Files */}\r\n                            {content.files?.length > 0 ? (\r\n                              <div className='list-group'>\r\n                                {content.files.map((file) => (\r\n                                  <a\r\n                                    key={file.id}\r\n                                    href={`${window.location.origin}${file.file}`}\r\n                                    target='_blank'\r\n                                    rel='noopener noreferrer'\r\n                                    className='list-group-item list-group-item-action d-flex align-items-center'\r\n                                  >\r\n                                    {file.video ? (\r\n                                      <i className='bi bi-camera-video me-2 text-danger'></i>\r\n                                    ) : (\r\n                                      <i className='bi bi-file-earmark-text me-2 text-primary'></i>\r\n                                    )}\r\n                                    <div>\r\n                                      <div>{file.title || \"File Materi\"}</div>\r\n                                      <small className='text-muted m-0'>\r\n                                        {file.video\r\n                                          ? \"Video Pembelajaran\"\r\n                                          : \"Dokumen Materi\"}\r\n                                      </small>\r\n                                    </div>\r\n                                  </a>\r\n                                ))}\r\n                              </div>\r\n                            ) : (\r\n                              <p className='text-muted mb-0'>\r\n                                Tidak ada file materi\r\n                              </p>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n\r\n                      {(!chapter.contents || chapter.contents.length === 0) && (\r\n                        <div className='alert alert-light'>\r\n                          <i className='bi bi-info-circle me-2'></i>\r\n                          Tidak ada konten pembelajaran\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n\r\n            {(!subject.chapters || subject.chapters.length === 0) && (\r\n              <div className='alert alert-info'>\r\n                <i className='bi bi-info-circle me-2'></i>\r\n                Belum ada bab pembelajaran untuk mata pelajaran ini.\r\n              </div>\r\n            )}\r\n          </>\r\n        ) : (\r\n          <div className='alert alert-warning'>\r\n            <i className='bi bi-exclamation-triangle me-2'></i>\r\n            Data mata pelajaran tidak ditemukan.\r\n          </div>\r\n        )}\r\n      </div>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default Subject;\r\n"],"names":["createMarkup","html","__html","Subject","id","name","useParams","user","useSelector","state","auth","formattedName","replace","data","subject","isLoading","error","useGetSubjectQuery","subjectid","classid","level","class_id","skip","Layout","title","levels","children","jsx","className","role","jsxs","message","Fragment","cover","jsxRuntimeExports","src","window","location","origin","alt","style","width","height","objectFit","fontSize","_a","chapters","length","_b","map","chapter","index","type","dangerouslySetInnerHTML","target","teacher_name","classes","cls","idx","contents","content","files","file","href","rel","video"],"mappings":"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"}