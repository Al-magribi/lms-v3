import{r,aM as T,j as e,e as v,aN as k,aO as J,aP as E,aQ as L}from"./index-B88h2kYZ.js";import{L as I}from"./Layout-BzzV81EK.js";import{T as M}from"./Table-BvY52Fag.js";const q=({detail:n,setDetail:d})=>{const[x,o]=r.useState(""),[h,c]=r.useState(""),[l,{isLoading:i,isSuccess:j,isError:u,reset:p}]=T(),b=m=>{m.preventDefault();const s={id:x||"",name:h};v.promise(l(s).unwrap().then(t=>t.message),{loading:"Menambahkan data...",success:t=>t,error:t=>t.data.message})},N=()=>{d({}),c(""),o("")};return r.useEffect(()=>{n&&(c(n.name),o(n.id))},[n]),r.useEffect(()=>{(j||u)&&(p(),d({}),c(""),o(""))},[j,u]),e.jsxs("form",{onSubmit:b,className:"rounded border p-2 d-flex flex-column gap-2 bg-white",children:[e.jsx("p",{className:"m-0 h6",children:"Tambah Juz"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Nama Juz",value:h||"",onChange:m=>c(m.target.value)}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-warning",onClick:N,children:"Batal"}),e.jsx("button",{type:"submit",className:"btn btn-sm btn-success",disabled:i,children:"Simpan"})]})]})},B=({setDetail:n,juz:d,totalData:x,totalPages:o,page:h,setPage:c,limit:l,setLimit:i,setSearch:j,isLoading:u})=>{const[p,{isLoading:b}]=k(),N=s=>{v.promise(p(s).unwrap().then(t=>t.message),{pending:"Menghapus data...",success:t=>t,error:t=>t.data.message})},m=(s,t)=>{const g={juz_id:t,surah_id:s.surah_id,id:s.id,surah:s.surah,from_ayat:s.from_ayat,to_ayat:s.to_ayat,lines:s.lines};n(g)};return e.jsx(M,{page:h,setPage:c,totalPages:o,totalData:x,limit:l,setLimit:i,setSearch:j,isLoading:u,children:e.jsxs("table",{className:"mb-0 table table-hover table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center",children:"No"}),e.jsx("th",{className:"text-center",children:"Juz"}),e.jsx("th",{className:"text-center",children:"Surah"}),e.jsx("th",{className:"text-center",children:"Dari Ayat"}),e.jsx("th",{className:"text-center",children:"Sampai Ayat"}),e.jsx("th",{className:"text-center",children:"Baris"}),e.jsx("th",{className:"text-center",children:"Edit Surah"}),e.jsx("th",{className:"text-center",children:"Ayat"}),e.jsx("th",{className:"text-center",children:"Baris"}),e.jsx("th",{className:"text-center",children:"Aksi"})]})}),e.jsx("tbody",{children:d==null?void 0:d.map((s,t)=>e.jsxs(r.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{rowSpan:s.surah.length||1,className:"text-center",children:(h-1)*l+t+1}),e.jsx("td",{rowSpan:s.surah.length||1,children:s.name}),s.surah.length>0?e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"text-center align-middle",children:s.surah[0].surah}),e.jsx("td",{className:"text-center align-middle",children:s.surah[0].from_ayat}),e.jsx("td",{className:"text-center align-middle",children:s.surah[0].to_ayat}),e.jsx("td",{className:"text-center align-middle",children:s.surah[0].lines}),e.jsx("td",{className:"text-center align-middle",children:e.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>m(s.surah[0],s.id),children:e.jsx("i",{className:"bi bi-pencil-square"})})})]}):e.jsx("td",{colSpan:5,className:"text-center align-middle",children:"Data belum tersedia"}),e.jsx("td",{rowSpan:s.surah.length||1,className:"text-center",children:s.total_ayat}),e.jsx("td",{rowSpan:s.surah.length||1,className:"text-center",children:s.total_line}),e.jsx("td",{rowSpan:s.surah.length||1,className:"text-center",children:e.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[e.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>n(s),children:e.jsx("i",{className:"bi bi-pencil-square"})}),e.jsx("button",{className:"btn btn-sm btn-danger",disabled:b,onClick:()=>N(s.id),children:e.jsx("i",{className:"bi bi-trash"})})]})})]}),s.surah.slice(1).map((g,y)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-center align-middle",children:g.surah}),e.jsx("td",{className:"text-center align-middle",children:g.from_ayat}),e.jsx("td",{className:"text-center align-middle",children:g.to_ayat}),e.jsx("td",{className:"text-center align-middle",children:g.lines}),e.jsx("td",{className:"text-center align-middle",children:e.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>m(g,s.id),children:e.jsx("i",{className:"bi bi-pencil-square"})})})]},y))]},t))})]})})},F=({detail:n,setDetail:d})=>{const[x,o]=r.useState(""),[h,c]=r.useState(""),[l,i]=r.useState(""),[j,u]=r.useState(""),[p,b]=r.useState(""),[N,m]=r.useState(""),{data:s}=J({page:"",limit:"",search:""}),{data:t}=E({page:"",limit:"",search:""}),[g,{isLoading:y,isSuccess:z,isError:_,reset:A}]=L(),w=a=>{const S=t==null?void 0:t.find(f=>f.id===parseInt(a));return S?Array.from({length:S.ayat},(f,C)=>C+1):[]},D=a=>{a.preventDefault();const S={id:x,juzId:h,surahId:l,fromAyat:j,toAyat:p,lines:N};v.promise(g(S).unwrap().then(f=>f.message),{loading:"Menambahkan data...",success:f=>f,error:f=>f.data.message})};return r.useEffect(()=>{n&&(o(n.id),c(n.juz_id),i(n.surah_id),u(n.from_ayat),b(n.to_ayat),m(n.lines||""))},[n]),r.useEffect(()=>{(z||_)&&(A(),d({}),o(""),c(""),i(""),u(""),b(""),m(""))},[z,_]),e.jsxs("form",{onSubmit:D,className:"mt-2 rounded border bg-white p-2 d-flex flex-column gap-2",children:[e.jsx("p",{className:"m-0 h6",children:"Tambah Surah"}),e.jsxs("select",{name:"juz",id:"juz",className:"form-select",required:!0,value:h,onChange:a=>c(a.target.value),children:[e.jsx("option",{value:"",hidden:!0,children:"Pilih Juz"}),s==null?void 0:s.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsxs("select",{name:"surah",id:"surah",className:"form-select",required:!0,value:l,onChange:a=>i(a.target.value),children:[e.jsx("option",{value:"",hidden:!0,children:"Pilih Surah"}),t==null?void 0:t.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsxs("select",{className:"form-select",value:j,onChange:a=>u(a.target.value),disabled:!l,children:[e.jsx("option",{value:"",hidden:!0,children:"Dari Ayat"}),w(l).map(a=>e.jsx("option",{value:a,children:a},a))]}),e.jsxs("select",{className:"form-select",value:p,onChange:a=>b(a.target.value),disabled:!l,children:[e.jsx("option",{value:"",hidden:!0,children:"Sampai Ayat"}),w(l).map(a=>e.jsx("option",{value:a,children:a},a))]}),e.jsx("input",{type:"number",name:"lines",id:"lines",placeholder:"Jumlah Baris",className:"form-control",value:N||"",onChange:a=>m(a.target.value),disabled:!l}),e.jsxs("div",{className:"text-end",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-warning me-2",onClick:d,children:"Batal"}),e.jsx("button",{type:"submit",className:"btn btn-sm btn-success",disabled:y,children:"Simpan"})]})]})},H=()=>{const[n,d]=r.useState(1),[x,o]=r.useState(10),[h,c]=r.useState(""),[l,i]=r.useState({}),{data:j={},isLoading:u}=J({page:n,limit:x,search:h}),{juz:p=[],totalData:b,totalPages:N}=j;return e.jsx(I,{title:"Tahfiz - Daftar Juz",levels:["tahfiz"],children:e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-lg-3 col-12",children:[e.jsx(q,{detail:l,setDetail:()=>i({})}),e.jsx(F,{detail:l,setDetail:()=>i({})})]}),e.jsx("div",{className:"col-lg-9 col-12",children:e.jsx(B,{setDetail:i,juz:p,totalData:b,totalPages:N,page:n,setPage:d,limit:x,setLimit:o,setSearch:c,isLoading:u})})]})})};export{H as default};
