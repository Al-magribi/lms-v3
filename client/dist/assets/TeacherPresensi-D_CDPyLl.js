import{av as e,aQ as a,aR as s,aS as l,j as t,e as i,aT as d,aB as c,b as n,ac as r}from"./index-DnM_FeMc.js";import{b as m}from"./vendor-DfXzdC0j.js";import{L as h}from"./Layout-OYV3vppq.js";import{S as x}from"./react-select.esm-DUeLA41h.js";import{T as o}from"./Table-CETHu2Vq.js";import"./index-CGMX7dKw.js";import"./index-hpZ4eOv6.js";import"./index-DyuEXp_a.js";const b=({classid:d,subjectid:c})=>{const[n,r]=m.useState(1),[h,x]=m.useState(10),[b,j]=m.useState(""),[u,N]=m.useState((new Date).toISOString().split("T")[0]),{data:p,isLoading:g}=e({page:n,limit:h,search:b,classid:d},{skip:!d}),{data:v}=a({classid:d,subjectid:c,date:u},{skip:!d||!c});s({classid:d,subjectid:c},{skip:!d||!c});const[y]=l(),{students:f,totalData:w,totalPages:k}=p||{},S=async({studentid:e,note:a,checked:s})=>{if(!s)return;const l={classid:d,subjectid:c,studentid:e,note:a,date:u};i.promise(y(l).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>{var a;return(null==(a=e.data)?void 0:a.message)||"Terjadi kesalahan"}})};return t.jsx("div",{className:"container-fluid px-0",children:d&&c?f?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"card mb-4",children:t.jsx("div",{className:"card-body",children:t.jsx("div",{className:"row align-items-center",children:t.jsxs("div",{className:"col-md-6",children:[t.jsxs("label",{className:"form-label fw-bold",children:[t.jsx("i",{className:"bi bi-calendar-date me-2"}),"Tanggal Presensi: ",t.jsx("span",{children:(P=u,new Date(P).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))})]}),t.jsx("input",{type:"date",className:"form-control",value:u,onChange:e=>N(e.target.value),max:(new Date).toISOString().split("T")[0]})]})})})}),t.jsx(o,{isLoading:g,page:n,setPage:r,limit:h,setLimit:x,setSearch:j,totalData:w,totalPages:k,children:t.jsx("div",{className:"table-responsive",children:t.jsxs("table",{className:"table table-hover align-middle mb-0",children:[t.jsx("thead",{className:"bg-primary bg-gradient text-white",children:t.jsxs("tr",{children:[t.jsx("th",{className:"align-middle text-center fw-semibold border-0",style:{width:"5%"},children:t.jsx("div",{className:"d-flex flex-column align-items-center",children:t.jsx("span",{children:"No"})})}),t.jsx("th",{className:"align-middle fw-semibold border-0",style:{width:"25%"},children:t.jsx("div",{className:"d-flex align-items-center",children:t.jsx("span",{children:"Siswa"})})}),t.jsx("th",{className:"align-middle text-center fw-semibold border-0",style:{width:"10%"},children:t.jsxs("div",{className:"d-flex flex-column align-items-center",children:[t.jsx("i",{className:"bi bi-check-circle-fill text-success mb-1"}),t.jsx("span",{children:"Hadir"})]})}),t.jsx("th",{className:"align-middle text-center fw-semibold border-0",style:{width:"10%"},children:t.jsxs("div",{className:"d-flex flex-column align-items-center",children:[t.jsx("i",{className:"bi bi-clock-history text-warning mb-1"}),t.jsx("span",{children:"Telat"})]})}),t.jsx("th",{className:"align-middle text-center fw-semibold border-0",style:{width:"10%"},children:t.jsxs("div",{className:"d-flex flex-column align-items-center",children:[t.jsx("i",{className:"bi bi-heart-pulse-fill text-primary mb-1"}),t.jsx("span",{children:"Sakit"})]})}),t.jsx("th",{className:"align-middle text-center fw-semibold border-0",style:{width:"10%"},children:t.jsxs("div",{className:"d-flex flex-column align-items-center",children:[t.jsx("i",{className:"bi bi-envelope-paper-fill text-info mb-1"}),t.jsx("span",{children:"Izin"})]})}),t.jsx("th",{className:"align-middle text-center fw-semibold border-0",style:{width:"10%"},children:t.jsxs("div",{className:"d-flex flex-column align-items-center",children:[t.jsx("i",{className:"bi bi-x-circle-fill text-danger mb-1"}),t.jsx("span",{children:"Alpa"})]})}),t.jsx("th",{className:"align-middle text-center fw-semibold border-0",style:{width:"10%"},children:t.jsxs("div",{className:"d-flex flex-column align-items-center",children:[t.jsx("i",{className:"bi bi-trash text-danger mb-1"}),t.jsx("span",{children:"Hapus"})]})})]})}),t.jsx("tbody",{className:"border-top-0",children:f.map(((e,a)=>{const s=null==v?void 0:v.find((a=>a.studentid===e.student));return t.jsxs("tr",{className:"attendance-change border-bottom",children:[t.jsx("td",{className:"text-center align-middle",children:t.jsx("span",{className:"fw-bold text-primary",children:(n-1)*h+a+1})}),t.jsx("td",{className:"align-middle",children:t.jsxs("div",{className:"flex-grow-1",children:[t.jsx("h6",{className:"mb-1 fw-semibold text-dark",children:e.student_name}),t.jsxs("div",{className:"d-flex flex-wrap gap-3 text-muted small",children:[t.jsxs("span",{className:"d-flex align-items-center",children:[t.jsx("i",{className:"bi bi-card-text me-1"}),e.nis]}),t.jsxs("span",{className:"d-flex align-items-center",children:[t.jsx("i",{className:"bi bi-mortarboard me-1"}),e.grade_name]}),t.jsxs("span",{className:"d-flex align-items-center",children:[t.jsx("i",{className:"bi bi-building me-1"}),e.class_name]})]})]})}),t.jsx("td",{className:"text-center align-middle",children:t.jsx("input",{className:"form-check-input border-success shadow-sm",type:"radio",name:`attendance-${e.student}`,style:{width:"1.5em",height:"1.5em"},checked:"Hadir"===(null==s?void 0:s.note),onChange:a=>{S({studentid:e.student,note:"Hadir",checked:a.target.checked})}})}),t.jsx("td",{className:"text-center align-middle",children:t.jsx("input",{className:"form-check-input border-warning shadow-sm",type:"radio",name:`attendance-${e.student}`,style:{width:"1.5em",height:"1.5em"},checked:"Hadir"===(null==s?void 0:s.note),onChange:a=>{S({studentid:e.student,note:"Telat",checked:a.target.checked})}})}),t.jsx("td",{className:"text-center align-middle",children:t.jsx("input",{className:"form-check-input border-primary shadow-sm",type:"radio",name:`attendance-${e.student}`,style:{width:"1.5em",height:"1.5em"},checked:"Sakit"===(null==s?void 0:s.note),onChange:a=>{S({studentid:e.student,note:"Sakit",checked:a.target.checked})}})}),t.jsx("td",{className:"text-center align-middle",children:t.jsx("input",{className:"form-check-input border-info shadow-sm",type:"radio",name:`attendance-${e.student}`,style:{width:"1.5em",height:"1.5em"},checked:"Izin"===(null==s?void 0:s.note),onChange:a=>{S({studentid:e.student,note:"Izin",checked:a.target.checked})}})}),t.jsx("td",{className:"text-center align-middle",children:t.jsx("input",{className:"form-check-input border-danger shadow-sm",type:"radio",name:`attendance-${e.student}`,style:{width:"1.5em",height:"1.5em"},checked:"Alpa"===(null==s?void 0:s.note),onChange:a=>{S({studentid:e.student,note:"Alpa",checked:a.target.checked})}})}),t.jsx("td",{className:"text-center align-middle",children:t.jsx("button",{className:"btn btn-sm btn-danger",children:t.jsx("i",{className:"bi bi-trash"})})})]},e.id)}))})]})})})]}):t.jsxs("div",{className:"text-center py-5 empty-state",children:[t.jsx("div",{className:"mb-4",children:t.jsx("i",{className:"bi bi-people display-1 text-muted opacity-75"})}),t.jsx("h4",{className:"fw-bold text-muted mb-3",children:"Data Siswa Tidak Tersedia"}),t.jsx("p",{className:"text-muted mb-0 fs-6",children:"Tidak ada data siswa yang ditemukan untuk kelas ini"})]}):t.jsxs("div",{className:"text-center py-5 empty-state",children:[t.jsx("div",{className:"mb-4",children:t.jsx("i",{className:"bi bi-clipboard2-check display-1 text-muted opacity-75"})}),t.jsx("h4",{className:"fw-bold text-muted mb-3",children:"Pilih Data Presensi"}),t.jsx("p",{className:"text-muted mb-0 fs-6",children:"Silakan pilih mata pelajaran dan kelas terlebih dahulu"})]})});var P},j=({classid:e,subjectid:a})=>{const[s,l]=m.useState((new Date).getMonth()+1),[i,n]=m.useState((new Date).getFullYear()),{data:r,isLoading:h}=d({classid:e,subjectid:a,month:s,year:i},{skip:!e||!a});return e&&a?h?t.jsx(c,{}):t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header bg-primary text-white",children:t.jsxs("h5",{className:"card-title mb-0",children:[t.jsx("i",{className:"bi bi-calendar-month me-2"}),"Rangkuman Presensi Bulanan"]})}),t.jsxs("div",{className:"card-body",children:[t.jsx("div",{className:"row mb-3",children:t.jsxs("div",{className:"col-md-6",children:[t.jsx("label",{className:"form-label fw-bold",children:"Bulan:"}),t.jsx("select",{className:"form-select",value:s,onChange:e=>l(parseInt(e.target.value)),children:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"].map(((e,a)=>t.jsx("option",{value:a+1,children:e},a+1)))})]})}),r&&r.length>0?t.jsx("div",{className:"table-responsive",children:t.jsxs("table",{className:"table table-hover table-striped",children:[t.jsx("thead",{className:"table-dark",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-center",style:{width:"5%"},children:"No"}),t.jsx("th",{style:{width:"10%"},children:"NIS"}),t.jsx("th",{style:{width:"35%"},children:"Nama Siswa"}),t.jsxs("th",{className:"text-center",style:{width:"12%"},children:[t.jsx("i",{className:"bi bi-check-circle text-success me-1"}),"Hadir"]}),t.jsxs("th",{className:"text-center",style:{width:"12%"},children:[t.jsx("i",{className:"bi bi-heart-pulse text-primary me-1"}),"Sakit"]}),t.jsxs("th",{className:"text-center",style:{width:"12%"},children:[t.jsx("i",{className:"bi bi-envelope-paper text-info me-1"}),"Izin"]}),t.jsxs("th",{className:"text-center",style:{width:"12%"},children:[t.jsx("i",{className:"bi bi-x-circle text-danger me-1"}),"Alpa"]}),t.jsxs("th",{className:"text-center",style:{width:"12%"},children:[t.jsx("i",{className:"bi bi-percent text-warning me-1"}),"Kehadiran"]})]})}),t.jsx("tbody",{children:r.map(((e,a)=>{const s=e.hadir+e.sakit+e.izin+e.alpa,l=s>0?(e.hadir/s*100).toFixed(1):0;return t.jsxs("tr",{className:"attendance-change",children:[t.jsx("td",{className:"text-center align-middle",children:a+1}),t.jsx("td",{className:"align-middle",children:e.nis}),t.jsx("td",{className:"align-middle fw-bold",children:e.student_name}),t.jsx("td",{className:"text-center align-middle",children:t.jsx("span",{className:"badge bg-success fs-6",children:e.hadir})}),t.jsx("td",{className:"text-center align-middle",children:t.jsx("span",{className:"badge bg-primary fs-6",children:e.sakit})}),t.jsx("td",{className:"text-center align-middle",children:t.jsx("span",{className:"badge bg-info fs-6",children:e.izin})}),t.jsx("td",{className:"text-center align-middle",children:t.jsx("span",{className:"badge bg-danger fs-6",children:e.alpa})}),t.jsx("td",{className:"text-center align-middle",children:t.jsxs("span",{className:"badge fs-6 "+(l>=90?"bg-success":l>=80?"bg-warning":"bg-danger"),children:[l,"%"]})})]},e.studentid)}))})]})}):t.jsxs("div",{className:"text-center py-5 empty-state",children:[t.jsx("div",{className:"mb-3",children:t.jsx("i",{className:"bi bi-calendar-x display-1 text-muted"})}),t.jsx("h5",{className:"fw-bold text-muted mb-2",children:"Data Tidak Tersedia"}),t.jsx("p",{className:"text-muted mb-0",children:"Tidak ada data presensi untuk periode yang dipilih"})]})]})]}):t.jsxs("div",{className:"text-center py-5 empty-state",children:[t.jsx("div",{className:"mb-3",children:t.jsx("i",{className:"bi bi-calendar-check display-1 text-muted"})}),t.jsx("h5",{className:"fw-bold text-muted mb-2",children:"Pilih Data Presensi"}),t.jsx("p",{className:"text-muted mb-0",children:"Silakan pilih mata pelajaran dan kelas terlebih dahulu"})]})},u=({classid:e,subjectid:l})=>{const[i,d]=m.useState(""),[n,r]=m.useState("all"),{data:h}=s({classid:e,subjectid:l},{skip:!e||!l}),{data:x,isLoading:o}=a({classid:e,subjectid:l,...i&&{date:i}},{skip:!e||!l}),b=e=>new Date(e).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),j=e=>{switch(e){case"Hadir":return t.jsx("span",{className:"badge bg-success",children:e});case"Sakit":return t.jsx("span",{className:"badge bg-primary",children:e});case"Izin":return t.jsx("span",{className:"badge bg-info",children:e});case"Alpa":return t.jsx("span",{className:"badge bg-danger",children:e});default:return t.jsx("span",{className:"badge bg-secondary",children:e||"Belum Diisi"})}};return e&&l?o?t.jsx(c,{}):t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header bg-info text-white",children:t.jsxs("h5",{className:"card-title mb-0",children:[t.jsx("i",{className:"bi bi-clock-history me-2"}),"Riwayat Presensi"]})}),t.jsxs("div",{className:"card-body",children:[t.jsxs("div",{className:"row mb-4",children:[t.jsxs("div",{className:"col-md-6",children:[t.jsxs("label",{className:"form-label fw-bold",children:[t.jsx("i",{className:"bi bi-calendar-range me-2"}),"Filter Tanggal:"]}),t.jsxs("select",{className:"form-select",value:n,onChange:e=>{r(e.target.value),"all"===e.target.value?d(""):"today"===e.target.value&&d((new Date).toISOString().split("T")[0])},children:[t.jsx("option",{value:"all",children:"Semua Tanggal"}),t.jsx("option",{value:"today",children:"Hari Ini"}),t.jsx("option",{value:"specific",children:"Tanggal Tertentu"})]})]}),t.jsxs("div",{className:"col-md-6",children:[t.jsxs("label",{className:"form-label fw-bold",children:[t.jsx("i",{className:"bi bi-calendar-date me-2"}),"Pilih Tanggal:"]}),t.jsxs("select",{className:"form-select",value:i,onChange:e=>d(e.target.value),disabled:"specific"!==n,children:[t.jsx("option",{value:"",children:"Pilih tanggal"}),null==h?void 0:h.map((e=>t.jsx("option",{value:e.date,children:b(e.date)},e.date)))]})]})]}),x&&x.length>0?t.jsx("div",{className:"table-responsive",children:t.jsxs("table",{className:"table table-hover table-striped",children:[t.jsx("thead",{className:"table-dark",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-center",style:{width:"5%"},children:"No"}),t.jsx("th",{style:{width:"15%"},children:"Tanggal"}),t.jsx("th",{style:{width:"10%"},children:"NIS"}),t.jsx("th",{style:{width:"25%"},children:"Nama Siswa"}),t.jsx("th",{className:"text-center",style:{width:"15%"},children:"Status"}),t.jsx("th",{className:"text-center",style:{width:"10%"},children:"Aksi"})]})}),t.jsx("tbody",{children:x.map(((e,a)=>t.jsxs("tr",{className:"attendance-change",children:[t.jsx("td",{className:"text-center align-middle",children:a+1}),t.jsxs("td",{className:"align-middle",children:[t.jsx("div",{className:"fw-bold",children:b(e.date)}),t.jsx("small",{className:"text-muted",children:new Date(e.date).toLocaleDateString("id-ID")})]}),t.jsx("td",{className:"align-middle",children:e.nis}),t.jsx("td",{className:"align-middle fw-bold",children:e.student_name}),t.jsx("td",{className:"text-center align-middle",children:j(e.note)}),t.jsx("td",{className:"text-center align-middle",children:t.jsx("button",{className:"btn btn-sm btn-outline-primary",title:"Lihat Detail",disabled:!0,children:t.jsx("i",{className:"bi bi-eye"})})})]},e.id)))})]})}):t.jsxs("div",{className:"text-center py-5 empty-state",children:[t.jsx("div",{className:"mb-3",children:t.jsx("i",{className:"bi bi-calendar-x display-1 text-muted"})}),t.jsx("h5",{className:"fw-bold text-muted mb-2",children:"Data Tidak Tersedia"}),t.jsx("p",{className:"text-muted mb-0",children:i?`Tidak ada data presensi untuk tanggal ${b(i)}`:"Tidak ada data presensi yang tersedia"})]})]})]}):t.jsxs("div",{className:"text-center py-5 empty-state",children:[t.jsx("div",{className:"mb-3",children:t.jsx("i",{className:"bi bi-clock-history display-1 text-muted"})}),t.jsx("h5",{className:"fw-bold text-muted mb-2",children:"Pilih Data Presensi"}),t.jsx("p",{className:"text-muted mb-0",children:"Silakan pilih mata pelajaran dan kelas terlebih dahulu"})]})},N=()=>{var e;const{user:a}=n((e=>e.auth)),{data:s}=r({page:"",limit:"",search:""}),[l,i]=m.useState(""),[d,c]=m.useState(""),[o,N]=m.useState("daily"),p=null==(e=null==a?void 0:a.subjects)?void 0:e.map((e=>({value:e.id,label:e.name}))),g=null==s?void 0:s.map((e=>({value:e.id,label:e.name})));return t.jsxs(h,{title:"Presensi Siswa",levels:["teacher"],children:[t.jsxs("div",{className:"card mb-4",children:[t.jsx("div",{className:"card-header bg-primary text-white",children:t.jsxs("h5",{className:"card-title mb-0",children:[t.jsx("i",{className:"bi bi-funnel me-2"}),"Filter Data Presensi"]})}),t.jsx("div",{className:"card-body",children:t.jsxs("div",{className:"row g-3",children:[t.jsxs("div",{className:"col-12 col-lg-6",children:[t.jsxs("label",{className:"form-label fw-bold",children:[t.jsx("i",{className:"bi bi-book me-2"}),"Mata Pelajaran:"]}),t.jsx(x,{options:p,isSearchable:!0,placeholder:"Pilih Mata Pelajaran",onChange:e=>c(e.value),className:"react-select-container",classNamePrefix:"react-select",menuPortalTarget:document.body,menuPosition:"fixed",styles:{menuPortal:e=>({...e,zIndex:1})}})]}),t.jsxs("div",{className:"col-12 col-lg-6",children:[t.jsxs("label",{className:"form-label fw-bold",children:[t.jsx("i",{className:"bi bi-people me-2"}),"Kelas:"]}),t.jsx(x,{options:g,isSearchable:!0,placeholder:"Pilih Kelas",onChange:e=>i(e.value),className:"react-select-container",classNamePrefix:"react-select",menuPortalTarget:document.body,menuPosition:"fixed",styles:{menuPortal:e=>({...e,zIndex:1})}})]})]})})]}),l&&d&&t.jsxs("div",{className:"card mb-4",children:[t.jsx("div",{className:"card-header",children:t.jsxs("ul",{className:"nav nav-tabs card-header-tabs",role:"tablist",children:[t.jsx("li",{className:"nav-item",role:"presentation",children:t.jsxs("button",{className:"nav-link "+("daily"===o?"active":""),type:"button",role:"tab",onClick:()=>N("daily"),children:[t.jsx("i",{className:"bi bi-calendar-day me-2"}),"Presensi Harian"]})}),t.jsx("li",{className:"nav-item",role:"presentation",children:t.jsxs("button",{className:"nav-link "+("history"===o?"active":""),type:"button",role:"tab",onClick:()=>N("history"),children:[t.jsx("i",{className:"bi bi-clock-history me-2"}),"Riwayat Presensi"]})}),t.jsx("li",{className:"nav-item",role:"presentation",children:t.jsxs("button",{className:"nav-link "+("summary"===o?"active":""),type:"button",role:"tab",onClick:()=>N("summary"),children:[t.jsx("i",{className:"bi bi-calendar-month me-2"}),"Rangkuman Bulanan"]})})]})}),t.jsx("div",{className:"card-body",children:t.jsxs("div",{className:"tab-content",children:[t.jsx("div",{className:"tab-pane fade "+("daily"===o?"show active":""),children:t.jsx(b,{classid:l,subjectid:d})}),t.jsx("div",{className:"tab-pane fade "+("history"===o?"show active":""),children:t.jsx(u,{classid:l,subjectid:d})}),t.jsx("div",{className:"tab-pane fade "+("summary"===o?"show active":""),children:t.jsx(j,{classid:l,subjectid:d})})]})})]}),(!l||!d)&&t.jsxs("div",{className:"text-center py-5",children:[t.jsx("div",{className:"mb-3",children:t.jsx("i",{className:"bi bi-clipboard2-check display-1 text-muted"})}),t.jsx("h5",{className:"fw-bold text-muted mb-2",children:"Pilih Data Presensi"}),t.jsx("p",{className:"text-muted mb-0",children:"Silakan pilih mata pelajaran dan kelas terlebih dahulu untuk melihat data presensi"})]})]})};export{N as default};
//# sourceMappingURL=TeacherPresensi-D_CDPyLl.js.map
