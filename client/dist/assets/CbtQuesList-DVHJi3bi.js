import{a8 as e,a9 as a,j as s,d as t,aa as l,ab as n}from"./index-Deb7CCnC.js";import{L as r}from"./Layout-BbtcclI6.js";import{u as i,b as d,e as c}from"./vendor-CAuU4qY4.js";import{T as o}from"./Table-Dm0a0r2C.js";import{r as m,u as b}from"./xlsx-B4fPQ8kA.js";const x=e=>({__html:e}),h=({subject:l,name:n,bankid:r})=>{const c=i(),[m,b]=d.useState(1),[h,j]=d.useState(10),[u,p]=d.useState(""),{data:g={},isLoading:N}=e({page:m,limit:h,search:u,bankid:r}),{totalData:f,totalPages:y,questions:k=[]}=g,[v,{isLoading:S}]=a();return s.jsx(o,{page:m,setPage:b,setLimit:j,setSearch:p,totalData:f,totalPages:y,isLoading:N,children:s.jsxs("table",{className:"table table-bordered table-striped table-hover mb-0",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-center",children:"No"}),s.jsx("th",{className:"text-center",children:"Jenis"}),s.jsx("th",{className:"text-center",children:"Pertanyaan"}),s.jsx("th",{className:"text-center",children:"A"}),s.jsx("th",{className:"text-center",children:"B"}),s.jsx("th",{className:"text-center",children:"C"}),s.jsx("th",{className:"text-center",children:"D"}),s.jsx("th",{className:"text-center",children:"E"}),s.jsx("th",{className:"text-center",children:"Jawaban"}),s.jsx("th",{className:"text-center",children:"Poin"}),s.jsx("th",{className:"text-center",children:"Aksi"})]})}),s.jsx("tbody",{children:(null==k?void 0:k.length)>0?null==k?void 0:k.map(((e,a)=>s.jsxs("tr",{children:[s.jsx("td",{className:"text-center",children:(m-1)*h+a+1}),s.jsx("td",{className:"text-center",children:1==e.qtype?"PG":"Essay"}),s.jsx("td",{children:s.jsx("p",{dangerouslySetInnerHTML:x(e.question)})}),s.jsx("td",{children:s.jsx("p",{dangerouslySetInnerHTML:x(e.a)})}),s.jsx("td",{children:s.jsx("p",{dangerouslySetInnerHTML:x(e.b)})}),s.jsx("td",{children:s.jsx("p",{dangerouslySetInnerHTML:x(e.c)})}),s.jsx("td",{children:s.jsx("p",{dangerouslySetInnerHTML:x(e.d)})}),s.jsx("td",{children:s.jsx("p",{dangerouslySetInnerHTML:x(e.e)})}),s.jsx("td",{className:"text-center",children:e.qkey}),s.jsx("td",{className:"text-center",children:e.poin}),s.jsx("td",{className:"text-center",children:s.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[s.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>(e=>{const a=n.replace(/[\s/]/g,"-"),s=l.replace(/[\s/]/g,"-");c(`/admin-cbt-bank/${s}/${a}/${r}/${e}/edit-soal`)})(e.id),children:s.jsx("i",{className:"bi bi-pencil"})}),s.jsx("button",{className:"btn btn-sm btn-danger",disabled:S,onClick:()=>{return a=e.id,void t.promise(v(a).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message});var a},children:s.jsx("i",{className:"bi bi-trash"})})]})})]},e.id))):s.jsx("tr",{children:s.jsx("td",{colSpan:11,children:"Data belum tersedia"})})})]})})},j=({bankid:e})=>{const[a,n]=d.useState(null),r=d.useRef(null),[i,{isLoading:c,isError:o,isSuccess:x,reset:h}]=l();return d.useEffect((()=>{x&&(h(),r.current.value=null),o&&(h(),r.current.value=null)}),[x,o]),s.jsx("div",{className:"modal fade",id:"upload","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true",children:s.jsx("div",{className:"modal-dialog",children:s.jsxs("div",{className:"modal-content",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h5",{className:"modal-title",id:"staticBackdropLabel",children:"Upload Soal"}),s.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),s.jsx("div",{className:"modal-body",children:s.jsx("input",{type:"file",name:"file",id:"file",className:"form-control",ref:r,onChange:e=>n(e.target.files[0])})}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{type:"button",className:"btn btn-sm btn-secondary","data-bs-dismiss":"modal",onClick:()=>{r.current.value=null,n(null)},children:"Batal"}),s.jsx("button",{type:"button",className:"btn btn-sm btn-primary",disabled:c,onClick:s=>{if(s.preventDefault(),a){const s=new FileReader;s.onload=a=>{const s=new Uint8Array(a.target.result),l=m(s,{type:"array"}),n=l.SheetNames[0],r=l.Sheets[n],d=b.sheet_to_json(r,{header:1,range:1}).map((e=>{const[a,s,t,l,n,r,i,d,c]=e;return 2==a?[a,s,null,null,null,null,null,d,c]:[a,s,t,l,n,r,i,d,c]})).filter((e=>2===e[0]||e.every((e=>null!=e)))),c=Array.isArray(d)?d:[d];t.promise(i({body:c,bankid:e}).unwrap().then((e=>e.message)),{loading:"Menyimpan data...",success:e=>e,error:e=>e.data.message})},s.readAsArrayBuffer(a)}},children:"Upload"})]})]})})})},u=()=>{const e=i(),a=c(),{subject:l,name:d,bankid:o}=a,[m,{isLoading:b}]=n();return s.jsxs(r,{title:"Daftar Soal ",levels:["admin","teacher"],children:[s.jsx("div",{className:"container-fluid bg-white p-2 rounded shadow border mb-2",children:s.jsxs("div",{className:"row g-2",children:[s.jsx("div",{className:"col-lg-6 col-12 d-flex align-items-center",children:s.jsxs("div",{className:"d-flex gap-2",children:[s.jsxs("p",{className:"m-0",children:["Mata Pelajaran: ",s.jsx("strong",{children:l.replace(/-/g," ")})]}),s.jsxs("p",{className:"m-0",children:["Bank Soal: ",s.jsx("strong",{children:d.replace(/-/g," ")})]})]})}),s.jsx("div",{className:"col-lg-6 col-12",children:s.jsxs("div",{className:"d-flex flex-wrap gap-2 justify-content-end",children:[s.jsx("button",{className:"btn btn-sm btn-secondary","data-toggle":"tooltip","data-placement":"bottom",title:"Template",onClick:()=>{window.open("/temp/template_soal.xlsx","_blank")},children:s.jsx("i",{className:"bi bi-filetype-xlsx"})}),s.jsx("button",{className:"btn btn-sm btn-primary","data-toggle":"tooltip","data-placement":"bottom",title:"Upload","data-bs-toggle":"modal","data-bs-target":"#upload",children:s.jsx("i",{className:"bi bi-file-earmark-arrow-up"})}),s.jsx("button",{"data-toggle":"tooltip","data-placement":"bottom",title:"Tambah Soal",className:"btn btn-sm btn-success",onClick:()=>{const a=d.replace(/[\s/]/g,"-"),s=l.replace(/[\s/]/g,"-");e(`/admin-cbt-bank/${s}/${a}/${o}/tambah-soal`)},children:s.jsx("i",{className:"bi bi-file-earmark-plus"})}),s.jsx("button",{className:"btn btn-sm btn-danger","data-toggle":"tooltip","data-placement":"bottom",title:"Hapus Soal",disabled:b,onClick:()=>{window.confirm("Apakah Anda yakin akan menghapus bank soal ini?")&&t.promise(m(o).unwrap().then((e=>e.message)),{loading:"Memproses...",success:e=>e,error:e=>e.data.message})},children:s.jsx("i",{className:"bi bi-folder-x"})})]})})]})}),s.jsx(h,{subject:l,name:d,bankid:o}),s.jsx(j,{bankid:o})]})};export{u as default};
//# sourceMappingURL=CbtQuesList-DVHJi3bi.js.map
